!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@deriv/shared"),require("@deriv/translations"),require("mobx")):"function"==typeof define&&define.amd?define(["@deriv/shared","@deriv/translations","mobx"],e):"object"==typeof exports?exports["@deriv/cfd"]=e(require("@deriv/shared"),require("@deriv/translations"),require("mobx")):t["@deriv/cfd"]=e(t["@deriv/shared"],t["@deriv/translations"],t.mobx)}(self,(function(t,e,n){return(()=>{var r={"./src/Stores/Modules/CFD/Helpers/cfd-config.ts":(t,e,n)=>{"use strict";n.d(e,{Df:()=>o,D_:()=>i});var r=n("@deriv/translations"),o=function(){var t={account_type:"",leverage:500,short_title:(0,r.localize)("Derived")},e={account_type:"financial",leverage:1e3,short_title:(0,r.localize)("Financial")};return{demo:{synthetic:{dxtrade_account_type:t.account_type,leverage:t.leverage,title:(0,r.localize)("Demo Derived"),short_title:t.short_title},financial:{dxtrade_account_type:e.account_type,leverage:e.leverage,title:(0,r.localize)("Demo Financial"),short_title:e.short_title}},real:{synthetic:{dxtrade_account_type:t.account_type,leverage:t.leverage,title:(0,r.localize)("Derived"),short_title:t.short_title},financial:{dxtrade_account_type:e.account_type,leverage:e.leverage,title:(0,r.localize)("Financial"),short_title:e.short_title}}}},i=function(t){var e={account_type:"",leverage:500,short_title:(0,r.localize)("CFDs")},n={account_type:"",leverage:500,short_title:(0,r.localize)("Derived")},o={account_type:"financial",leverage:1e3,short_title:t?(0,r.localize)("CFDs"):(0,r.localize)("Financial")},i={account_type:"financial_stp",leverage:100,short_title:(0,r.localize)("Financial STP")};return{demo:{all:{mt5_account_type:e.account_type,leverage:e.leverage,title:(0,r.localize)("Demo"),short_title:e.short_title},synthetic:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,r.localize)("Demo Derived"),short_title:n.short_title},financial:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("Demo CFDs"):(0,r.localize)("Demo Financial"),short_title:o.short_title},synthetic_svg:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,r.localize)("Demo Derived SVG"),short_title:n.short_title},financial_svg:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("Demo CFDs"):(0,r.localize)("Demo Financial SVG"),short_title:o.short_title},financial_stp:{mt5_account_type:i.account_type,leverage:i.leverage,title:(0,r.localize)("Demo Financial STP"),short_title:i.short_title}},real:{all:{mt5_account_type:e.account_type,leverage:e.leverage,title:(0,r.localize)("Real"),short_title:e.short_title},dxtrade:{mt5_account_type:e.account_type,leverage:e.leverage,title:(0,r.localize)("Real"),short_title:e.short_title},synthetic:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,r.localize)("Derived"),short_title:n.short_title},synthetic_svg:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,r.localize)("Derived SVG"),short_title:n.short_title},synthetic_bvi:{mt5_account_type:n.account_type,leverage:n.leverage,title:(0,r.localize)("Derived BVI"),short_title:n.short_title},financial:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("CFDs"):(0,r.localize)("Financial"),short_title:o.short_title},financial_svg:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("CFDs"):(0,r.localize)("Financial SVG"),short_title:o.short_title},financial_bvi:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("CFDs"):(0,r.localize)("Financial BVI"),short_title:o.short_title},financial_fx:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("CFDs"):(0,r.localize)("Financial Labuan"),short_title:o.short_title},financial_v:{mt5_account_type:o.account_type,leverage:o.leverage,title:t?(0,r.localize)("CFDs"):(0,r.localize)("Financial Vanuatu"),short_title:o.short_title},financial_stp:{mt5_account_type:i.account_type,leverage:i.leverage,title:(0,r.localize)("Financial STP"),short_title:i.short_title}}}}},"./src/_common/utility.js":t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var r,o=n((function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.promise=new Promise((function(t,n){e.reject=n,e.resolve=t}))}));t.exports={template:function(t,e){var n=e;return e&&!Array.isArray(e)&&(n=[e]),t.replace(/\[_(\d+)]/g,(function(t,e){return n[+e-1]}))},createElement:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement(t);return Object.keys(e).forEach((function(t){var r=e[t];"text"===t?n.textContent=r:"html"===t?n.html(r):n.setAttribute(t,r)})),n},getStaticHash:function(){return r=r||(document.querySelector('script[src*="main"]').getAttribute("src")||"").split(".")[1]},PromiseClass:o}},"@deriv/shared":e=>{"use strict";e.exports=t},"@deriv/translations":t=>{"use strict";t.exports=e},mobx:t=>{"use strict";t.exports=n}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return r[t](n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var s={};return(()=>{"use strict";i.d(s,{default:()=>M});var t=i("mobx"),e=i("@deriv/shared"),n=i("./src/_common/utility.js");function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errors={}}var e,n,o;return e=t,(n=[{key:"add",value:function(t,e){this.has(t)||(this.errors[t]=[]),-1===this.errors[t].indexOf(e)&&this.errors[t].push(e)}},{key:"all",value:function(){return this.errors}},{key:"first",value:function(t){return this.has(t)?this.errors[t][0]:null}},{key:"get",value:function(t){return this.has(t)?this.errors[t]:[]}},{key:"has",value:function(t){return Object.prototype.hasOwnProperty.call(this.errors,t)}}])&&r(e.prototype,n),o&&r(e,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;a(this,t),this.input=e,this.rules=n,this.store=r,this.errors=new o,this.error_count=0}var r,i,s;return r=t,s=[{key:"getRuleObject",value:function(t){var n="string"==typeof t,r={name:n?t:t[0],options:n?{}:t[1]||{}};return r.validator="custom"===r.name?t[1].func:(0,e.getPreBuildDVRs)()[r.name].func,r}}],(i=[{key:"addFailure",value:function(t,r,o){var i=o||r.options.message||(0,e.getPreBuildDVRs)()[r.name].message();"length"===r.name?i=(0,n.template)(i,[r.options.min===r.options.max?r.options.min:"".concat(r.options.min,"-").concat(r.options.max)]):"min"===r.name?i=(0,n.template)(i,[r.options.min]):"not_equal"===r.name&&(i=(0,n.template)(i,[r.options.name1,r.options.name2])),this.errors.add(t,i),this.error_count++}},{key:"check",value:function(){var e=this;return Object.keys(this.input).forEach((function(n){Object.prototype.hasOwnProperty.call(e.rules,n)&&e.rules[n].forEach((function(r){var o=t.getRuleObject(r);if((o.validator||"function"==typeof o.validator)&&(!o.options.condition||o.options.condition(e.store))&&(""!==e.input[n]||"req"===o.name)){var i,s;if("number"===o.name){var a=o.validator(e.input[n],o.options,e.store,e.input);i=a.is_ok,s=a.message}else i=o.validator(e.input[n],o.options,e.store,e.input);i||e.addFailure(n,o,s)}}))})),!this.error_count}},{key:"isPassed",value:function(){return this.check()}}])&&c(r.prototype,i),s&&c(r,s),Object.defineProperty(r,"prototype",{writable:!1}),t}();const l=u;function _(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){_(i,r,o,s,a,"next",t)}function a(t){_(i,r,o,s,a,"throw",t)}s(void 0)}))}}function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function n(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,n),this.validation_errors={},this.validation_rules={},this.preSwitchAccountDisposer=null,this.pre_switch_account_listener=null,this.switchAccountDisposer=null,this.switch_account_listener=null,this.logoutDisposer=null,this.logout_listener=null,this.clientInitDisposer=null,this.client_init_listener=null,this.networkStatusChangeDisposer=null,this.network_status_change_listener=null,this.themeChangeDisposer=null,this.theme_change_listener=null,this.realAccountSignupEndedDisposer=null,this.real_account_signup_ended_listener=null,this.partial_fetch_time=0,(0,t.makeObservable)(this,{validation_errors:t.observable,validation_rules:t.observable,partial_fetch_time:t.observable,retrieveFromStorage:t.action,setValidationErrorMessages:t.action,setValidationRules:t.action,addRule:t.action,validateProperty:t.action,validateAllProperties:t.action,onSwitchAccount:t.action.bound,onPreSwitchAccount:t.action.bound,onLogout:t.action.bound,onClientInit:t.action.bound,onNetworkStatusChange:t.action.bound,onThemeChange:t.action.bound,onRealAccountSignupEnd:t.action.bound,disposePreSwitchAccount:t.action.bound,disposeSwitchAccount:t.action.bound,disposeLogout:t.action.bound,disposeClientInit:t.action.bound,disposeNetworkStatusChange:t.action.bound,disposeThemeChange:t.action.bound,disposeRealAccountSignupEnd:t.action.bound,onUnmount:t.action.bound,assertHasValidCache:t.action.bound});var o=r.root_store,i=r.local_storage_properties,s=r.session_storage_properties,a=r.validation_rules,c=r.store_name;Object.defineProperty(this,"root_store",{enumerable:!1,writable:!0}),Object.defineProperty(this,"local_storage_properties",{enumerable:!1,writable:!0}),Object.defineProperty(this,"session_storage_properties",{enumerable:!1,writable:!0});var u=i&&i.length||s&&s.length;if(u){if(!c)throw new Error("store_name is required for local/session storage");Object.defineProperty(this,"store_name",{value:c,enumerable:!1,writable:!1})}this.root_store=o,this.local_storage_properties=i||[],this.session_storage_properties=s||[],setTimeout((function(){e.setValidationRules(a),e.setupReactionForLocalStorage(),e.setupReactionForSessionStorage(),e.retrieveFromStorage()}),0)}var r,o,i;return r=n,o=[{key:"getSnapshot",value:function(n){var r=(0,t.toJS)(this);return(0,e.isEmptyObject)(this.root_store)||(r.root_store=this.root_store),n&&n.length&&(r=n.reduce((function(t,e){return Object.assign(t,f({},e,r[e]))}),{})),r}},{key:"setupReactionForLocalStorage",value:function(){var e=this;this.local_storage_properties.length&&(0,t.reaction)((function(){return e.local_storage_properties.map((function(t){return e[t]}))}),(function(){return e.saveToStorage(e.local_storage_properties,n.STORAGES.LOCAL_STORAGE)}))}},{key:"setupReactionForSessionStorage",value:function(){var e=this;this.session_storage_properties.length&&(0,t.reaction)((function(){return e.session_storage_properties.map((function(t){return e[t]}))}),(function(){return e.saveToStorage(e.session_storage_properties,n.STORAGES.SESSION_STORAGE)}))}},{key:"saveToStorage",value:function(t,e){var r=JSON.stringify(this.getSnapshot(t),(function(t,e){if(null!==e)return e}));e===n.STORAGES.LOCAL_STORAGE?localStorage.setItem(this.store_name,r):e===n.STORAGES.SESSION_STORAGE&&sessionStorage.setItem(this.store_name,r)}},{key:"retrieveFromStorage",value:function(){var t=this,e=JSON.parse(localStorage.getItem(this.store_name,{})),n=JSON.parse(sessionStorage.getItem(this.store_name,{})),r=h(h({},e),n);Object.keys(r).forEach((function(e){return t[e]=r[e]}))}},{key:"setValidationErrorMessages",value:function(t,e){var n=this;this.validation_errors[t]&&!n.validation_errors[t].filter((function(t){return!e.includes(t)})).concat(e.filter((function(e){return!n.validation_errors[t].includes(e)}))).length||(this.validation_errors[t]=e)}},{key:"setValidationRules",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(e).forEach((function(n){t.addRule(n,e[n])}))}},{key:"addRule",value:function(e,n){var r=this;this.validation_rules[e]=n,(0,t.intercept)(this,e,(function(t){return r.validateProperty(e,t.newValue),t}))}},{key:"validateProperty",value:function(t,e){var n=this,r=this.validation_rules[t].trigger,o=f({},t,void 0!==e?e:this[t]),i=f({},t,this.validation_rules[t].rules||[]);r&&Object.hasOwnProperty.call(this,r)&&(o[r]=this[r],i[r]=this.validation_rules[r].rules||[]);var s=new l(o,i,this);s.isPassed(),Object.keys(o).forEach((function(t){n.setValidationErrorMessages(t,s.errors.get(t))}))}},{key:"validateAllProperties",value:function(){var t=this,e=Object.keys(this.validation_rules),n=Object.keys(this.validation_errors);e.forEach((function(e){t.validateProperty(e,t[e])})),n.forEach((function(n){e.includes(n)||delete t.validation_errors[n]}))}},{key:"onSwitchAccount",value:function(n){var r=this;n&&(this.switch_account_listener=n,this.switchAccountDisposer=(0,t.when)((function(){return r.root_store.client.switch_broadcast}),(function(){try{var t=r.switch_account_listener();if(!t||!t.then||"function"!=typeof t.then)throw new Error("Switching account listeners are required to return a promise.");t.then((function(){r.root_store.client.switchEndSignal(),r.onSwitchAccount(r.switch_account_listener)}))}catch(t){(0,e.isProduction)()||console.error(t)}})))}},{key:"onPreSwitchAccount",value:function(n){var r=this;n&&(this.pre_switch_account_listener=n,this.preSwitchAccountDisposer=(0,t.when)((function(){return r.root_store.client.pre_switch_broadcast}),(function(){try{var t=r.pre_switch_account_listener();if(!t||!t.then||"function"!=typeof t.then)throw new Error("Pre-switch account listeners are required to return a promise.");t.then((function(){r.root_store.client.setPreSwitchAccount(!1),r.onPreSwitchAccount(r.pre_switch_account_listener)}))}catch(t){(0,e.isProduction)()||console.error(t)}})))}},{key:"onLogout",value:function(n){var r=this;this.logoutDisposer=(0,t.when)((function(){return r.root_store.client.has_logged_out}),d(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(n=r.logout_listener())||!n.then||"function"!=typeof n.then){t.next=6;break}n.then((function(){r.root_store.client.setLogout(!1),r.onLogout(r.logout_listener)})),t.next=7;break;case 6:throw new Error("Logout listeners are required to return a promise.");case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,e.isProduction)()||console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),this.logout_listener=n}},{key:"onClientInit",value:function(n){var r=this;this.clientInitDisposer=(0,t.when)((function(){return r.root_store.client.initialized_broadcast}),d(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(n=r.client_init_listener())||!n.then||"function"!=typeof n.then){t.next=6;break}n.then((function(){r.root_store.client.setInitialized(!1),r.onClientInit(r.client_init_listener)})),t.next=7;break;case 6:throw new Error("Client init listeners are required to return a promise.");case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),(0,e.isProduction)()||console.error(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))),this.client_init_listener=n}},{key:"onNetworkStatusChange",value:function(n){var r=this;this.networkStatusChangeDisposer=(0,t.reaction)((function(){return r.root_store.common.is_network_online}),(function(t){try{r.network_status_change_listener(t)}catch(t){(0,e.isProduction)()||console.error(t)}})),this.network_status_change_listener=n}},{key:"onThemeChange",value:function(n){var r=this;this.themeChangeDisposer=(0,t.reaction)((function(){return r.root_store.ui.is_dark_mode_on}),(function(t){try{r.theme_change_listener(t)}catch(t){(0,e.isProduction)()||console.error(t)}})),this.theme_change_listener=n}},{key:"onRealAccountSignupEnd",value:function(n){var r=this;this.realAccountSignupEndedDisposer=(0,t.when)((function(){return r.root_store.ui.has_real_account_signup_ended}),(function(){try{var t=r.real_account_signup_ended_listener();if(!t||!t.then||"function"!=typeof t.then)throw new Error("Real account signup listeners are required to return a promise.");t.then((function(){r.root_store.ui.setRealAccountSignupEnd(!1),r.onRealAccountSignupEnd(r.real_account_signup_ended_listener)}))}catch(t){(0,e.isProduction)()||console.error(t)}})),this.real_account_signup_ended_listener=n}},{key:"disposePreSwitchAccount",value:function(){"function"==typeof this.preSwitchAccountDisposer&&this.preSwitchAccountDisposer(),this.pre_switch_account_listener=null}},{key:"disposeSwitchAccount",value:function(){"function"==typeof this.switchAccountDisposer&&this.switchAccountDisposer(),this.switch_account_listener=null}},{key:"disposeLogout",value:function(){"function"==typeof this.logoutDisposer&&this.logoutDisposer(),this.logout_listener=null}},{key:"disposeClientInit",value:function(){"function"==typeof this.clientInitDisposer&&this.clientInitDisposer(),this.client_init_listener=null}},{key:"disposeNetworkStatusChange",value:function(){"function"==typeof this.networkStatusChangeDisposer&&this.networkStatusChangeDisposer(),this.network_status_change_listener=null}},{key:"disposeThemeChange",value:function(){"function"==typeof this.themeChangeDisposer&&this.themeChangeDisposer(),this.theme_change_listener=null}},{key:"disposeRealAccountSignupEnd",value:function(){"function"==typeof this.realAccountSignupEndedDisposer&&this.realAccountSignupEndedDisposer(),this.real_account_signup_ended_listener=null}},{key:"onUnmount",value:function(){this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout(),this.disposeClientInit(),this.disposeNetworkStatusChange(),this.disposeThemeChange(),this.disposeRealAccountSignupEnd()}},{key:"assertHasValidCache",value:function(t){if(this.root_store.client.loginid!==t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];n.forEach((function(t){return t()})),this.partial_fetch_time=!1}}}],o&&g(r.prototype,o),i&&g(r,i),Object.defineProperty(r,"prototype",{writable:!1}),n}();y.STORAGES=Object.freeze({LOCAL_STORAGE:Symbol("LOCAL_STORAGE"),SESSION_STORAGE:Symbol("SESSION_STORAGE")});var m=i("./src/Stores/Modules/CFD/Helpers/cfd-config.ts");function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function S(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(r,o)}function w(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){S(i,r,o,s,a,"next",t)}function a(t){S(i,r,o,s,a,"throw",t)}s(void 0)}))}}function k(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw o}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e){return C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},C(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E(t);if(e){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}function T(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return R(t)}function R(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(t){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},E(t)}var M=function(n){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(h,n);var r,o,i,s,a,c,u,l,_,d,p=x(h);function h(e){var n,r=e.root_store;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=p.call(this,{root_store:r})).is_compare_accounts_visible=!1,n.is_cfd_personal_details_modal_visible=!1,n.is_jurisdiction_modal_visible=!1,n.is_mt5_trade_modal_visible=!1,n.jurisdiction_selected_shortcode="",n.account_type={category:void 0,type:void 0},n.mt5_trade_account={},n.new_account_response={},n.map_type={},n.has_cfd_error=!1,n.error_message="",n.is_cfd_success_dialog_enabled=!1,n.is_mt5_financial_stp_modal_open=!1,n.is_cfd_password_modal_enabled=!1,n.is_cfd_reset_password_modal_enabled=!1,n.current_account=void 0,n.error_type=void 0,n.is_cfd_verification_modal_visible=!1,n.dxtrade_tokens={demo:"",real:""},n.real_synthetic_accounts_existing_data=[],n.real_financial_accounts_existing_data=[],(0,t.makeObservable)(R(n),{is_compare_accounts_visible:t.observable,is_cfd_personal_details_modal_visible:t.observable,is_jurisdiction_modal_visible:t.observable,is_mt5_trade_modal_visible:t.observable,jurisdiction_selected_shortcode:t.observable,account_type:t.observable,mt5_trade_account:t.observable,new_account_response:t.observable,map_type:t.observable,has_cfd_error:t.observable,error_message:t.observable,is_cfd_success_dialog_enabled:t.observable,is_mt5_financial_stp_modal_open:t.observable,is_cfd_password_modal_enabled:t.observable,is_cfd_reset_password_modal_enabled:t.observable,current_account:t.observable,is_cfd_verification_modal_visible:t.observable,error_type:t.observable,dxtrade_tokens:t.observable,account_title:t.computed,current_list:t.computed,has_created_account_for_selected_jurisdiction:t.computed,has_submitted_cfd_personal_details:t.computed,onMount:t.action.bound,onUnmount:t.override,checkShouldOpenAccount:t.action.bound,realAccountSignupEndListener:t.action.bound,resetFormErrors:t.action.bound,clearCFDError:t.action.bound,createCFDAccount:t.action.bound,disableCFDPasswordModal:t.action.bound,enableCFDPasswordModal:t.action.bound,getName:t.action.bound,openMT5Account:t.action.bound,openCFDAccount:t.action.bound,beginRealSignupForMt5:t.action.bound,enableMt5FinancialStpModal:t.action.bound,setAccountType:t.action.bound,setCurrentAccount:t.action.bound,setMT5TradeAccount:t.action.bound,setError:t.action.bound,setCFDNewAccount:t.action.bound,setCFDSuccessDialog:t.action.bound,storeProofOfAddress:t.action.bound,getAccountStatus:t.action.bound,creatMT5Password:t.action.bound,submitMt5Password:t.action.bound,createCFDPassword:t.action.bound,submitCFDPassword:t.action.bound,toggleCompareAccountsModal:t.action.bound,getRealSyntheticAccountsExistingData:t.action.bound,getRealFinancialAccountsExistingData:t.action.bound,toggleJurisdictionModal:t.action.bound,toggleMT5TradeModal:t.action.bound,disableMt5FinancialStpModal:t.action.bound,topUpVirtual:t.action.bound,sendVerifyEmail:t.action.bound,setJurisdictionSelectedShortcode:t.action.bound,toggleCFDVerificationModal:t.action.bound,setCFDPasswordResetModal:t.action.bound,setDxtradeToken:t.action.bound,loadDxtradeTokens:t.action.bound}),(0,t.reaction)((function(){return[n.root_store.client.dxtrade_accounts_list]}),(function(){n.root_store.client.dxtrade_accounts_list.length>0&&n.loadDxtradeTokens()})),n}return r=h,o=[{key:"account_title",get:function(){return this.account_type.category?(0,m.D_)(this.root_store.client.is_eu)[this.account_type.category][this.account_type.type].title:""}},{key:"has_submitted_cfd_personal_details",get:function(){var t=this.root_store.client.account_settings,e=t.citizen,n=t.place_of_birth,r=t.tax_residence,o=t.tax_identification_number,i=t.account_opening_reason;return!!(e&&n&&r&&o&&i)}},{key:"current_list",get:function(){var t={};return this.root_store.client.mt5_login_list.forEach((function(n){t[(0,e.getAccountListKey)(n,e.CFD_PLATFORMS.MT5,n.landing_company_short)]=O({},n)})),this.root_store.client.dxtrade_accounts_list.forEach((function(n){t[(0,e.getAccountListKey)(n,e.CFD_PLATFORMS.DXTRADE)]=O({},n)})),t}},{key:"mt5_companies",get:function(){return(0,m.D_)(this.root_store.client.is_eu)}},{key:"dxtrade_companies",get:function(){return(0,m.Df)()}},{key:"has_created_account_for_selected_jurisdiction",get:function(){var t,e,n=this;return"synthetic"===this.account_type.type?null===(t=this.real_synthetic_accounts_existing_data)||void 0===t?void 0:t.some((function(t){return t.landing_company_short===n.jurisdiction_selected_shortcode})):null===(e=this.real_financial_accounts_existing_data)||void 0===e?void 0:e.some((function(t){return t.landing_company_short===n.jurisdiction_selected_shortcode}))}},{key:"onMount",value:function(){this.checkShouldOpenAccount(),this.onRealAccountSignupEnd(this.realAccountSignupEndListener),this.root_store.ui.is_cfd_page=!0}},{key:"onUnmount",value:function(){this.disposeRealAccountSignupEnd(),this.root_store.ui.is_cfd_page=!1}},{key:"checkShouldOpenAccount",value:function(){var t=sessionStorage.getItem("open_cfd_account_type");if(t){var e=k(t.split("."),4),n=e[0],r=e[1],o=e[2],i=e[3];this.createCFDAccount({category:n,platform:r,type:o,set_password:i}),sessionStorage.removeItem("open_cfd_account_type")}}},{key:"realAccountSignupEndListener",value:function(){var t=JSON.parse(sessionStorage.getItem("post_real_account_signup"));return t&&t.category&&t.type&&(sessionStorage.removeItem("post_real_account_signup"),this.enableCFDPasswordModal()),Promise.resolve()}},{key:"resetFormErrors",value:function(){this.error_message="",this.error_type=void 0,this.has_cfd_error=!1}},{key:"clearCFDError",value:function(){this.resetFormErrors(),this.is_cfd_password_modal_enabled=!1}},{key:"createCFDAccount",value:function(t){var n=t.category,r=t.platform,o=t.type,i=t.set_password;this.clearCFDError(),this.setAccountType({category:n,type:o}),r===e.CFD_PLATFORMS.DXTRADE?"real"===n?this.realCFDSignup(i):this.demoCFDSignup():r===e.CFD_PLATFORMS.MT5&&("real"===n?this.toggleJurisdictionModal():(this.root_store.client.is_eu?this.setJurisdictionSelectedShortcode("maltainvest"):this.setJurisdictionSelectedShortcode("svg"),this.demoCFDSignup()))}},{key:"demoCFDSignup",value:function(){this.enableCFDPasswordModal()}},{key:"disableCFDPasswordModal",value:function(){this.is_cfd_password_modal_enabled=!1}},{key:"enableCFDPasswordModal",value:function(){this.is_cfd_password_modal_enabled=!0}},{key:"getName",value:function(){var t=(this.root_store.client.account_settings&&this.root_store.client.account_settings).first_name,e=this.mt5_companies[this.account_type.category][this.account_type.type].title;return t?[t,e].join(" "):e}},{key:"openMT5Account",value:function(t){var n=this.getName(),r=this.mt5_companies[this.account_type.category][this.account_type.type].leverage,o=(0,e.getAccountTypeFields)(this.account_type),i=this.root_store.client.account_settings,s=i.address_line_1,a=i.address_line_2,c=i.address_postcode,u=i.address_city,l=i.address_state,_=i.country_code,d=i.phone;return e.WS.mt5NewAccount(O(O(O({mainPassword:t.password,email:this.root_store.client.email_address,leverage:r,name:n,address:s||a,city:u,country:_,phone:d,state:l,zipCode:c},t.server?{server:t.server}:{}),this.jurisdiction_selected_shortcode?{company:this.jurisdiction_selected_shortcode}:{}),"labuan"!==this.jurisdiction_selected_shortcode?o:{account_type:"financial",mt5_account_type:"financial_stp"}))}},{key:"openCFDAccount",value:function(t){return e.WS.tradingPlatformNewAccount({password:t.password,platform:t.platform,account_type:this.account_type.category,market_type:"dxtrade"===this.account_type.type?"all":this.account_type.type})}},{key:"beginRealSignupForMt5",value:function(){sessionStorage.setItem("post_real_account_signup",JSON.stringify(this.account_type)),this.root_store.ui.openRealAccountSignup()}},{key:"realCFDSignup",value:function(t){switch(this.account_type.type){case"financial":case"synthetic":case"dxtrade":case"all":this.enableCFDPasswordModal();break;case"financial_stp":this.root_store.client.fetchResidenceList(),this.root_store.client.fetchStatesList(),this.root_store.client.fetchAccountSettings(),t?this.enableCFDPasswordModal():this.enableMt5FinancialStpModal();break;default:throw new Error("Cannot determine mt5 account signup.")}}},{key:"enableMt5FinancialStpModal",value:function(){this.is_mt5_financial_stp_modal_open=!0}},{key:"setAccountType",value:function(t){this.account_type=t}},{key:"setCurrentAccount",value:function(t,e){this.current_account=O(O({},e),t)}},{key:"setMT5TradeAccount",value:function(t){this.mt5_trade_account=t}},{key:"setError",value:function(t,e){var n;this.has_cfd_error=t,this.error_message=e?e.message:"",this.error_type=null!==(n=null==e?void 0:e.code)&&void 0!==n?n:void 0}},{key:"setCFDNewAccount",value:function(t){this.new_account_response=t}},{key:"setCFDSuccessDialog",value:function(t){this.is_cfd_success_dialog_enabled=!!t}},{key:"storeProofOfAddress",value:function(t,n,r){var o=this,i=r.setStatus;return new Promise((function(r,s){i({msg:""}),o.setState({is_btn_loading:!0}),e.WS.setSettings(n).then((function(n){n.error?(i({msg:n.error.message}),s(n)):(o.root_store.fetchAccountSettings(),t.current.upload().then((function(t){t.warning?(i({msg:t.message}),s(t)):e.WS.authorized.storage.getAccountStatus().then((function(t){var e=t.error,n=t.get_account_status;e&&s(e);var o=n.authentication.identity,i=!(o&&"none"===o.status);r({identity:o,has_poi:i})}))})))}))}))}},{key:"getAccountStatus",value:(d=w(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n===e.CFD_PLATFORMS.MT5&&this.root_store.client.is_mt5_password_not_set||n===e.CFD_PLATFORMS.DXTRADE&&this.root_store.client.is_dxtrade_password_not_set)){t.next=4;break}return t.next=4,e.WS.getAccountStatus();case 4:case"end":return t.stop()}}),t,this)}))),function(t){return d.apply(this,arguments)})},{key:"creatMT5Password",value:(_=w(regeneratorRuntime.mark((function t(n,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.WS.tradingPlatformPasswordChange({new_password:n.password,platform:e.CFD_PLATFORMS.MT5});case 2:if(!(o=t.sent).error){t.next=9;break}return this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1}),t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return _.apply(this,arguments)})},{key:"submitMt5Password",value:(l=w(regeneratorRuntime.mark((function t(n,r){var o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.root_store.client.is_mt5_password_not_set){t.next=6;break}return t.next=3,this.creatMT5Password(n,r);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return");case 6:return this.resetFormErrors(),t.next=9,this.openMT5Account(n);case 9:if((o=t.sent).error){t.next=30;break}return r.setStatus({success:!0}),r.setSubmitting(!1),this.setError(!1),this.setCFDSuccessDialog(!0),t.next=17,this.getAccountStatus(e.CFD_PLATFORMS.MT5);case 17:return t.next=19,e.WS.authorized.mt5LoginList();case 19:return i=t.sent,this.root_store.client.responseMt5LoginList(i),e.WS.transferBetweenAccounts(),t.t0=this.root_store.client,t.next=25,e.WS.tradingServers(e.CFD_PLATFORMS.MT5);case 25:t.t1=t.sent,t.t0.responseMT5TradingServers.call(t.t0,t.t1),this.setCFDNewAccount(o.mt5_new_account),t.next=36;break;case 30:return t.next=32,this.getAccountStatus(e.CFD_PLATFORMS.MT5);case 32:this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1});case 36:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"createCFDPassword",value:(u=w(regeneratorRuntime.mark((function t(n,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.WS.tradingPlatformPasswordChange({new_password:n.password,platform:e.CFD_PLATFORMS.DXTRADE});case 2:if(!(o=t.sent).error){t.next=9;break}return this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1}),t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"submitCFDPassword",value:(c=w(regeneratorRuntime.mark((function t(n,r){var o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.root_store.client.is_dxtrade_password_not_set){t.next=6;break}return t.next=3,this.createCFDPassword(n,r);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,this.openCFDAccount(n);case 8:if((o=t.sent).error){t.next=24;break}return r.setStatus({success:!0}),r.setSubmitting(!1),this.setError(!1),this.setCFDSuccessDialog(!0),t.next=16,this.getAccountStatus(e.CFD_PLATFORMS.DXTRADE);case 16:return t.next=18,e.WS.tradingPlatformAccountsList(n.platform);case 18:i=t.sent,this.root_store.client.responseTradingPlatformAccountsList(i),e.WS.transferBetweenAccounts(),this.setCFDNewAccount(o.trading_platform_new_account),t.next=30;break;case 24:return t.next=26,this.getAccountStatus(e.CFD_PLATFORMS.DXTRADE);case 26:this.setError(!0,o.error),r.resetForm({}),r.setSubmitting(!1),r.setStatus({success:!1});case 30:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"toggleCompareAccountsModal",value:function(){this.is_compare_accounts_visible=!this.is_compare_accounts_visible}},{key:"getRealSyntheticAccountsExistingData",value:function(t){this.real_synthetic_accounts_existing_data=t}},{key:"getRealFinancialAccountsExistingData",value:function(t){this.real_financial_accounts_existing_data=t}},{key:"toggleJurisdictionModal",value:function(){this.is_jurisdiction_modal_visible=!this.is_jurisdiction_modal_visible}},{key:"toggleMT5TradeModal",value:function(){this.is_mt5_trade_modal_visible=!this.is_mt5_trade_modal_visible}},{key:"disableMt5FinancialStpModal",value:function(){this.is_mt5_financial_stp_modal_open=!1}},{key:"topUpVirtual",value:(a=w(regeneratorRuntime.mark((function n(r){var o,i,s,a,c=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.root_store.ui.setTopUpInProgress(!0),n.t0=r,n.next=n.t0===e.CFD_PLATFORMS.DXTRADE?4:n.t0===e.CFD_PLATFORMS.MT5?8:12;break;case 4:return n.next=6,e.WS.authorized.send({trading_platform_deposit:1,platform:e.CFD_PLATFORMS.DXTRADE,to_account:this.current_account.account_id});case 6:return o=n.sent,n.abrupt("break",14);case 8:return n.next=10,e.WS.authorized.mt5Deposit({to_mt5:this.current_account.login});case 10:return o=n.sent,n.abrupt("break",14);case 12:return o.error="Invalid platform",n.abrupt("break",14);case 14:if(o.error){n.next=31;break}n.t1=r,n.next=n.t1===e.CFD_PLATFORMS.DXTRADE?18:n.t1===e.CFD_PLATFORMS.MT5?22:26;break;case 18:return n.next=20,e.WS.authorized.tradingPlatformAccountsList(e.CFD_PLATFORMS.DXTRADE).then(this.root_store.client.responseTradingPlatformAccountsList);case 20:return i=null===(s=this.root_store.client.dxtrade_accounts_list.find((function(t){return t.account_id===c.current_account.account_id})))||void 0===s?void 0:s.balance,n.abrupt("break",27);case 22:return n.next=24,e.WS.authorized.mt5LoginList().then(this.root_store.client.responseMt5LoginList);case 24:return i=null===(a=this.root_store.client.mt5_login_list.find((function(t){return t.login===c.current_account.login})))||void 0===a?void 0:a.balance,n.abrupt("break",27);case 26:return n.abrupt("break",27);case 27:(0,t.runInAction)((function(){c.root_store.ui.is_top_up_virtual_open=!1,c.current_account.balance=i})),setTimeout((function(){(0,t.runInAction)((function(){c.root_store.ui.is_top_up_virtual_success=!0}))}),250),n.next=32;break;case 31:console.error(o);case 32:this.root_store.ui.setTopUpInProgress(!1);case 33:case"end":return n.stop()}}),n,this)}))),function(t){return a.apply(this,arguments)})},{key:"sendVerifyEmail",value:function(){return e.WS.verifyEmail(this.root_store.client.email,"trading_platform_investor_password_reset")}},{key:"setCFDPasswordResetModal",value:function(t){this.is_cfd_reset_password_modal_enabled=!!t}},{key:"setDxtradeToken",value:function(t,e){if(!t.error){var n=t.service_token.dxtrade;this.dxtrade_tokens[e]=n.token}}},{key:"loadDxtradeTokens",value:function(){var t=this;["demo","real"].forEach((function(n){var r=t.root_store.client.dxtrade_accounts_list.some((function(t){return t.account_type===n}));!t.dxtrade_tokens[n]&&r&&e.WS.getServiceToken(e.CFD_PLATFORMS.DXTRADE,n).then((function(e){return t.setDxtradeToken(e,n)}))}))}},{key:"setJurisdictionSelectedShortcode",value:function(t){this.jurisdiction_selected_shortcode=t}},{key:"toggleCFDVerificationModal",value:function(){this.is_cfd_verification_modal_visible=!this.is_cfd_verification_modal_visible}}],i=[{key:"changePassword",value:(s=w(regeneratorRuntime.mark((function t(n){var r,o,i,s,a,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n.login,s=n.old_password,a=n.new_password,"investor"!==n.password_type){t.next=7;break}return t.next=4,e.WS.authorized.tradingPlatformInvestorPasswordChange({account_id:i,old_password:s,new_password:a,platform:e.CFD_PLATFORMS.MT5});case 4:c=t.sent,t.next=10;break;case 7:return t.next=9,e.WS.authorized.tradingPlatformPasswordChange({account_id:i,old_password:s,new_password:a,platform:e.CFD_PLATFORMS.MT5});case 9:c=t.sent;case 10:return t.abrupt("return",null===(r=c)||void 0===r||null===(o=r.error)||void 0===o?void 0:o.message);case 11:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})}],o&&F(r.prototype,o),i&&F(r,i),Object.defineProperty(r,"prototype",{writable:!1}),h}(y)})(),s=s.default})()}));