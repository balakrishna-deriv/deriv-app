"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk"] = self["webpackChunk"] || []).push([["main~Stores_b"],{

/***/ "./Stores/base-store.js":
/*!******************************!*\
  !*** ./Stores/base-store.js ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ BaseStore)\n/* harmony export */ });\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mobx */ \"../../../node_modules/mobx/lib/mobx.module.js\");\n/* harmony import */ var _deriv_shared__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @deriv/shared */ \"../../shared/src/index.js\");\n/* harmony import */ var Utils_Validator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! Utils/Validator */ \"./Utils/Validator/index.js\");\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _class, _descriptor, _descriptor2, _descriptor3, _class2, _temp;\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\nfunction _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }\n\n\n\n\n/**\n * BaseStore class is the base class for all defined stores in the application. It handles some stuff such as:\n *  1. Creating snapshot object from the store.\n *  2. Saving the store's snapshot in local/session storage and keeping them in sync.\n */\n\nvar BaseStore = (_dec = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec2 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec3 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec4 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec5 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec6 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec7 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec8 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec9 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec10 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec11 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec12 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec13 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec14 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec15 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec16 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, (_class = (_temp = _class2 = /*#__PURE__*/function () {\n  /**\n   * An enum object to define LOCAL_STORAGE and SESSION_STORAGE\n   */\n\n  /**\n   * Constructor of the base class that gets properties' name of child which should be saved in storages\n   *\n   * @param {Object} options - An object that contains the following properties:\n   *     @property {Object}   root_store - An object that contains the root store of the app.\n   *     @property {String[]} local_storage_properties - A list of properties' names that should be kept in localStorage.\n   *     @property {String[]} session_storage_properties - A list of properties' names that should be kept in sessionStorage.\n   *     @property {Object}   validation_rules - An object that contains the validation rules for each property of the store.\n   *     @property {String}   store_name - Explicit store name for browser application storage (to bypass minification)\n   */\n  function BaseStore() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, BaseStore);\n\n    _initializerDefineProperty(this, \"validation_errors\", _descriptor, this);\n\n    _initializerDefineProperty(this, \"validation_rules\", _descriptor2, this);\n\n    this.preSwitchAccountDisposer = null;\n    this.pre_switch_account_listener = null;\n    this.switchAccountDisposer = null;\n    this.switch_account_listener = null;\n    this.logoutDisposer = null;\n    this.logout_listener = null;\n    this.clientInitDisposer = null;\n    this.client_init_listener = null;\n    this.networkStatusChangeDisposer = null;\n    this.network_status_change_listener = null;\n    this.themeChangeDisposer = null;\n    this.theme_change_listener = null;\n    this.realAccountSignupEndedDisposer = null;\n    this.real_account_signup_ended_listener = null;\n\n    _initializerDefineProperty(this, \"partial_fetch_time\", _descriptor3, this);\n\n    var root_store = options.root_store,\n        local_storage_properties = options.local_storage_properties,\n        session_storage_properties = options.session_storage_properties,\n        validation_rules = options.validation_rules,\n        store_name = options.store_name;\n    Object.defineProperty(this, 'root_store', {\n      enumerable: false,\n      writable: true\n    });\n    Object.defineProperty(this, 'local_storage_properties', {\n      enumerable: false,\n      writable: true\n    });\n    Object.defineProperty(this, 'session_storage_properties', {\n      enumerable: false,\n      writable: true\n    });\n    var has_local_or_session_storage = local_storage_properties && local_storage_properties.length || session_storage_properties && session_storage_properties.length;\n\n    if (has_local_or_session_storage) {\n      if (!store_name) {\n        throw new Error('store_name is required for local/session storage');\n      }\n\n      Object.defineProperty(this, 'store_name', {\n        value: store_name,\n        enumerable: false,\n        writable: false\n      });\n    }\n\n    this.root_store = root_store;\n    this.local_storage_properties = local_storage_properties || [];\n    this.session_storage_properties = session_storage_properties || [];\n    this.setValidationRules(validation_rules);\n    this.setupReactionForLocalStorage();\n    this.setupReactionForSessionStorage();\n    this.retrieveFromStorage();\n  }\n  /**\n   * Returns an snapshot of the current store\n   *\n   * @param {String[]} properties - A list of properties' names that should be in the snapshot.\n   *\n   * @return {Object} Returns a cloned object of the store.\n   */\n\n\n  _createClass(BaseStore, [{\n    key: \"getSnapshot\",\n    value: function getSnapshot(properties) {\n      var snapshot = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.toJS)(this);\n\n      if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isEmptyObject)(this.root_store)) {\n        snapshot.root_store = this.root_store;\n      }\n\n      if (properties && properties.length) {\n        snapshot = properties.reduce(function (result, p) {\n          return Object.assign(result, _defineProperty({}, p, snapshot[p]));\n        }, {});\n      }\n\n      return snapshot;\n    }\n    /**\n     * Sets up a reaction on properties which are mentioned in `local_storage_properties`\n     *  and invokes `saveToStorage` when there are any changes on them.\n     *\n     */\n\n  }, {\n    key: \"setupReactionForLocalStorage\",\n    value: function setupReactionForLocalStorage() {\n      var _this = this;\n\n      if (this.local_storage_properties.length) {\n        (0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)(function () {\n          return _this.local_storage_properties.map(function (i) {\n            return _this[i];\n          });\n        }, function () {\n          return _this.saveToStorage(_this.local_storage_properties, BaseStore.STORAGES.LOCAL_STORAGE);\n        });\n      }\n    }\n    /**\n     * Sets up a reaction on properties which are mentioned in `session_storage_properties`\n     *  and invokes `saveToStorage` when there are any changes on them.\n     *\n     */\n\n  }, {\n    key: \"setupReactionForSessionStorage\",\n    value: function setupReactionForSessionStorage() {\n      var _this2 = this;\n\n      if (this.session_storage_properties.length) {\n        (0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)(function () {\n          return _this2.session_storage_properties.map(function (i) {\n            return _this2[i];\n          });\n        }, function () {\n          return _this2.saveToStorage(_this2.session_storage_properties, BaseStore.STORAGES.SESSION_STORAGE);\n        });\n      }\n    }\n    /**\n     * Removes properties that are not passed from the snapshot of the store and saves it to the passed storage\n     *\n     * @param {String[]} properties - A list of the store's properties' names which should be saved in the storage.\n     * @param {Symbol}   storage    - A symbol object that defines the storage which the snapshot should be stored in it.\n     *\n     */\n\n  }, {\n    key: \"saveToStorage\",\n    value: function saveToStorage(properties, storage) {\n      var snapshot = JSON.stringify(this.getSnapshot(properties), function (key, value) {\n        if (value !== null) return value;\n        return undefined;\n      });\n\n      if (storage === BaseStore.STORAGES.LOCAL_STORAGE) {\n        localStorage.setItem(this.store_name, snapshot);\n      } else if (storage === BaseStore.STORAGES.SESSION_STORAGE) {\n        sessionStorage.setItem(this.store_name, snapshot);\n      }\n    }\n    /**\n     * Retrieves saved snapshot of the store and assigns to the current instance.\n     *\n     */\n\n  }, {\n    key: \"retrieveFromStorage\",\n    value: function retrieveFromStorage() {\n      var _this3 = this;\n\n      var local_storage_snapshot = JSON.parse(localStorage.getItem(this.store_name, {}));\n      var session_storage_snapshot = JSON.parse(sessionStorage.getItem(this.store_name, {}));\n\n      var snapshot = _objectSpread(_objectSpread({}, local_storage_snapshot), session_storage_snapshot);\n\n      Object.keys(snapshot).forEach(function (k) {\n        return _this3[k] = snapshot[k];\n      });\n    }\n    /**\n     * Sets validation error messages for an observable property of the store\n     *\n     * @param {String} propertyName - The observable property's name\n     * @param [{String}] messages - An array of strings that contains validation error messages for the particular property.\n     *\n     */\n\n  }, {\n    key: \"setValidationErrorMessages\",\n    value: function setValidationErrorMessages(propertyName, messages) {\n      var _this4 = this;\n\n      var is_different = function is_different() {\n        return !!_this4.validation_errors[propertyName].filter(function (x) {\n          return !messages.includes(x);\n        }).concat(messages.filter(function (x) {\n          return !_this4.validation_errors[propertyName].includes(x);\n        })).length;\n      };\n\n      if (!this.validation_errors[propertyName] || is_different()) {\n        this.validation_errors[propertyName] = messages;\n      }\n    }\n    /**\n     * Sets validation rules\n     *\n     * @param {object} rules\n     *\n     */\n\n  }, {\n    key: \"setValidationRules\",\n    value: function setValidationRules() {\n      var _this5 = this;\n\n      var rules = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      Object.keys(rules).forEach(function (key) {\n        _this5.addRule(key, rules[key]);\n      });\n    }\n    /**\n     * Adds rules to the particular property\n     *\n     * @param {String} property\n     * @param {String} rules\n     *\n     */\n\n  }, {\n    key: \"addRule\",\n    value: function addRule(property, rules) {\n      var _this6 = this;\n\n      this.validation_rules[property] = rules;\n      (0,mobx__WEBPACK_IMPORTED_MODULE_0__.intercept)(this, property, function (change) {\n        _this6.validateProperty(property, change.newValue);\n\n        return change;\n      });\n    }\n    /**\n     * Validates a particular property of the store\n     *\n     * @param {String} property - The name of the property in the store\n     * @param {object} value    - The value of the property, it can be undefined.\n     *\n     */\n\n  }, {\n    key: \"validateProperty\",\n    value: function validateProperty(property, value) {\n      var _this7 = this;\n\n      var trigger = this.validation_rules[property].trigger;\n\n      var inputs = _defineProperty({}, property, value !== undefined ? value : this[property]);\n\n      var validation_rules = _defineProperty({}, property, this.validation_rules[property].rules || []);\n\n      if (!!trigger && Object.hasOwnProperty.call(this, trigger)) {\n        inputs[trigger] = this[trigger];\n        validation_rules[trigger] = this.validation_rules[trigger].rules || [];\n      }\n\n      var validator = new Utils_Validator__WEBPACK_IMPORTED_MODULE_2__.default(inputs, validation_rules, this);\n      validator.isPassed();\n      Object.keys(inputs).forEach(function (key) {\n        _this7.setValidationErrorMessages(key, validator.errors.get(key));\n      });\n    }\n    /**\n     * Validates all properties which validation rule has been set for.\n     *\n     */\n\n  }, {\n    key: \"validateAllProperties\",\n    value: function validateAllProperties() {\n      var _this8 = this;\n\n      var validation_rules = Object.keys(this.validation_rules);\n      var validation_errors = Object.keys(this.validation_errors);\n      validation_rules.forEach(function (p) {\n        _this8.validateProperty(p, _this8[p]);\n      }); // Remove keys that are present in error, but not in rules:\n\n      validation_errors.forEach(function (error) {\n        if (!validation_rules.includes(error)) {\n          delete _this8.validation_errors[error];\n        }\n      });\n    }\n  }, {\n    key: \"onSwitchAccount\",\n    value: function onSwitchAccount(listener) {\n      var _this9 = this;\n\n      if (listener) {\n        this.switch_account_listener = listener;\n        this.switchAccountDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.when)(function () {\n          return _this9.root_store.client.switch_broadcast;\n        }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n          var result;\n          return regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.prev = 0;\n                  result = _this9.switch_account_listener();\n\n                  if (!(result && result.then && typeof result.then === 'function')) {\n                    _context.next = 6;\n                    break;\n                  }\n\n                  result.then(function () {\n                    _this9.root_store.client.switchEndSignal();\n\n                    _this9.onSwitchAccount(_this9.switch_account_listener);\n                  });\n                  _context.next = 7;\n                  break;\n\n                case 6:\n                  throw new Error('Switching account listeners are required to return a promise.');\n\n                case 7:\n                  _context.next = 12;\n                  break;\n\n                case 9:\n                  _context.prev = 9;\n                  _context.t0 = _context[\"catch\"](0);\n\n                  // there is no listener currently active. so we can just ignore the error raised from treating\n                  // a null object as a function. Although, in development mode, we throw a console error.\n                  if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n                    console.error(_context.t0); // eslint-disable-line\n                  }\n\n                case 12:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[0, 9]]);\n        })));\n      }\n    }\n  }, {\n    key: \"onPreSwitchAccount\",\n    value: function onPreSwitchAccount(listener) {\n      var _this10 = this;\n\n      if (listener) {\n        this.pre_switch_account_listener = listener;\n        this.preSwitchAccountDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.when)(function () {\n          return _this10.root_store.client.pre_switch_broadcast;\n        }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n          var result;\n          return regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.prev = 0;\n                  result = _this10.pre_switch_account_listener();\n\n                  if (!(result && result.then && typeof result.then === 'function')) {\n                    _context2.next = 6;\n                    break;\n                  }\n\n                  result.then(function () {\n                    _this10.root_store.client.setPreSwitchAccount(false);\n\n                    _this10.onPreSwitchAccount(_this10.pre_switch_account_listener);\n                  });\n                  _context2.next = 7;\n                  break;\n\n                case 6:\n                  throw new Error('Pre-switch account listeners are required to return a promise.');\n\n                case 7:\n                  _context2.next = 12;\n                  break;\n\n                case 9:\n                  _context2.prev = 9;\n                  _context2.t0 = _context2[\"catch\"](0);\n\n                  // there is no listener currently active. so we can just ignore the error raised from treating\n                  // a null object as a function. Although, in development mode, we throw a console error.\n                  if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n                    console.error(_context2.t0); // eslint-disable-line\n                  }\n\n                case 12:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, null, [[0, 9]]);\n        })));\n      }\n    }\n  }, {\n    key: \"onLogout\",\n    value: function onLogout(listener) {\n      var _this11 = this;\n\n      this.logoutDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.when)(function () {\n        return _this11.root_store.client.has_logged_out;\n      }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var result;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                result = _this11.logout_listener();\n\n                if (!(result && result.then && typeof result.then === 'function')) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                result.then(function () {\n                  _this11.root_store.client.setLogout(false);\n\n                  _this11.onLogout(_this11.logout_listener);\n                });\n                _context3.next = 7;\n                break;\n\n              case 6:\n                throw new Error('Logout listeners are required to return a promise.');\n\n              case 7:\n                _context3.next = 12;\n                break;\n\n              case 9:\n                _context3.prev = 9;\n                _context3.t0 = _context3[\"catch\"](0);\n\n                // there is no listener currently active. so we can just ignore the error raised from treating\n                // a null object as a function. Although, in development mode, we throw a console error.\n                if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n                  console.error(_context3.t0); // eslint-disable-line\n                }\n\n              case 12:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[0, 9]]);\n      })));\n      this.logout_listener = listener;\n    }\n  }, {\n    key: \"onClientInit\",\n    value: function onClientInit(listener) {\n      var _this12 = this;\n\n      this.clientInitDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.when)(function () {\n        return _this12.root_store.client.initialized_broadcast;\n      }, /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var result;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.prev = 0;\n                result = _this12.client_init_listener();\n\n                if (!(result && result.then && typeof result.then === 'function')) {\n                  _context4.next = 6;\n                  break;\n                }\n\n                result.then(function () {\n                  _this12.root_store.client.setInitialized(false);\n\n                  _this12.onClientInit(_this12.client_init_listener);\n                });\n                _context4.next = 7;\n                break;\n\n              case 6:\n                throw new Error('Client init listeners are required to return a promise.');\n\n              case 7:\n                _context4.next = 12;\n                break;\n\n              case 9:\n                _context4.prev = 9;\n                _context4.t0 = _context4[\"catch\"](0);\n\n                // there is no listener currently active. so we can just ignore the error raised from treating\n                // a null object as a function. Although, in development mode, we throw a console error.\n                if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n                  console.error(_context4.t0); // eslint-disable-line\n                }\n\n              case 12:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[0, 9]]);\n      })));\n      this.client_init_listener = listener;\n    }\n  }, {\n    key: \"onNetworkStatusChange\",\n    value: function onNetworkStatusChange(listener) {\n      var _this13 = this;\n\n      this.networkStatusChangeDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)(function () {\n        return _this13.root_store.common.is_network_online;\n      }, function (is_online) {\n        try {\n          _this13.network_status_change_listener(is_online);\n        } catch (error) {\n          // there is no listener currently active. so we can just ignore the error raised from treating\n          // a null object as a function. Although, in development mode, we throw a console error.\n          if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            console.error(error); // eslint-disable-line\n          }\n        }\n      });\n      this.network_status_change_listener = listener;\n    }\n  }, {\n    key: \"onThemeChange\",\n    value: function onThemeChange(listener) {\n      var _this14 = this;\n\n      this.themeChangeDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)(function () {\n        return _this14.root_store.ui.is_dark_mode_on;\n      }, function (is_dark_mode_on) {\n        try {\n          _this14.theme_change_listener(is_dark_mode_on);\n        } catch (error) {\n          // there is no listener currently active. so we can just ignore the error raised from treating\n          // a null object as a function. Although, in development mode, we throw a console error.\n          if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            console.error(error); // eslint-disable-line\n          }\n        }\n      });\n      this.theme_change_listener = listener;\n    }\n  }, {\n    key: \"onRealAccountSignupEnd\",\n    value: function onRealAccountSignupEnd(listener) {\n      var _this15 = this;\n\n      this.realAccountSignupEndedDisposer = (0,mobx__WEBPACK_IMPORTED_MODULE_0__.when)(function () {\n        return _this15.root_store.ui.has_real_account_signup_ended;\n      }, function () {\n        try {\n          var result = _this15.real_account_signup_ended_listener();\n\n          if (result && result.then && typeof result.then === 'function') {\n            result.then(function () {\n              _this15.root_store.ui.setRealAccountSignupEnd(false);\n\n              _this15.onRealAccountSignupEnd(_this15.real_account_signup_ended_listener);\n            });\n          } else {\n            throw new Error('Real account signup listeners are required to return a promise.');\n          }\n        } catch (error) {\n          // there is no listener currently active. so we can just ignore the error raised from treating\n          // a null object as a function. Although, in development mode, we throw a console error.\n          if (!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isProduction)()) {\n            console.error(error); // eslint-disable-line\n          }\n        }\n      });\n      this.real_account_signup_ended_listener = listener;\n    }\n  }, {\n    key: \"disposePreSwitchAccount\",\n    value: function disposePreSwitchAccount() {\n      if (typeof this.preSwitchAccountDisposer === 'function') {\n        this.preSwitchAccountDisposer();\n      }\n\n      this.pre_switch_account_listener = null;\n    }\n  }, {\n    key: \"disposeSwitchAccount\",\n    value: function disposeSwitchAccount() {\n      if (typeof this.switchAccountDisposer === 'function') {\n        this.switchAccountDisposer();\n      }\n\n      this.switch_account_listener = null;\n    }\n  }, {\n    key: \"disposeLogout\",\n    value: function disposeLogout() {\n      if (typeof this.logoutDisposer === 'function') {\n        this.logoutDisposer();\n      }\n\n      this.logout_listener = null;\n    }\n  }, {\n    key: \"disposeClientInit\",\n    value: function disposeClientInit() {\n      if (typeof this.clientInitDisposer === 'function') {\n        this.clientInitDisposer();\n      }\n\n      this.client_init_listener = null;\n    }\n  }, {\n    key: \"disposeNetworkStatusChange\",\n    value: function disposeNetworkStatusChange() {\n      if (typeof this.networkStatusChangeDisposer === 'function') {\n        this.networkStatusChangeDisposer();\n      }\n\n      this.network_status_change_listener = null;\n    }\n  }, {\n    key: \"disposeThemeChange\",\n    value: function disposeThemeChange() {\n      if (typeof this.themeChangeDisposer === 'function') {\n        this.themeChangeDisposer();\n      }\n\n      this.theme_change_listener = null;\n    }\n  }, {\n    key: \"disposeRealAccountSignupEnd\",\n    value: function disposeRealAccountSignupEnd() {\n      if (typeof this.realAccountSignupEndedDisposer === 'function') {\n        this.realAccountSignupEndedDisposer();\n      }\n\n      this.real_account_signup_ended_listener = null;\n    }\n  }, {\n    key: \"onUnmount\",\n    value: function onUnmount() {\n      this.disposePreSwitchAccount();\n      this.disposeSwitchAccount();\n      this.disposeLogout();\n      this.disposeClientInit();\n      this.disposeNetworkStatusChange();\n      this.disposeThemeChange();\n      this.disposeRealAccountSignupEnd();\n    }\n  }, {\n    key: \"assertHasValidCache\",\n    value: function assertHasValidCache(loginid) {\n      // account was changed when this was unmounted.\n      if (this.root_store.client.loginid !== loginid) {\n        for (var _len = arguments.length, reactions = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          reactions[_key - 1] = arguments[_key];\n        }\n\n        reactions.forEach(function (act) {\n          return act();\n        });\n        this.partial_fetch_time = false;\n      }\n    }\n  }]);\n\n  return BaseStore;\n}(), _class2.STORAGES = Object.freeze({\n  LOCAL_STORAGE: Symbol('LOCAL_STORAGE'),\n  SESSION_STORAGE: Symbol('SESSION_STORAGE')\n}), _temp), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"validation_errors\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"validation_rules\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"partial_fetch_time\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return 0;\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"retrieveFromStorage\", [mobx__WEBPACK_IMPORTED_MODULE_0__.action], Object.getOwnPropertyDescriptor(_class.prototype, \"retrieveFromStorage\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setValidationErrorMessages\", [mobx__WEBPACK_IMPORTED_MODULE_0__.action], Object.getOwnPropertyDescriptor(_class.prototype, \"setValidationErrorMessages\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setValidationRules\", [mobx__WEBPACK_IMPORTED_MODULE_0__.action], Object.getOwnPropertyDescriptor(_class.prototype, \"setValidationRules\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"addRule\", [mobx__WEBPACK_IMPORTED_MODULE_0__.action], Object.getOwnPropertyDescriptor(_class.prototype, \"addRule\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"validateProperty\", [mobx__WEBPACK_IMPORTED_MODULE_0__.action], Object.getOwnPropertyDescriptor(_class.prototype, \"validateProperty\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"validateAllProperties\", [mobx__WEBPACK_IMPORTED_MODULE_0__.action], Object.getOwnPropertyDescriptor(_class.prototype, \"validateAllProperties\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onSwitchAccount\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"onSwitchAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onPreSwitchAccount\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"onPreSwitchAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onLogout\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"onLogout\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onClientInit\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"onClientInit\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onNetworkStatusChange\", [_dec5], Object.getOwnPropertyDescriptor(_class.prototype, \"onNetworkStatusChange\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onThemeChange\", [_dec6], Object.getOwnPropertyDescriptor(_class.prototype, \"onThemeChange\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onRealAccountSignupEnd\", [_dec7], Object.getOwnPropertyDescriptor(_class.prototype, \"onRealAccountSignupEnd\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposePreSwitchAccount\", [_dec8], Object.getOwnPropertyDescriptor(_class.prototype, \"disposePreSwitchAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposeSwitchAccount\", [_dec9], Object.getOwnPropertyDescriptor(_class.prototype, \"disposeSwitchAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposeLogout\", [_dec10], Object.getOwnPropertyDescriptor(_class.prototype, \"disposeLogout\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposeClientInit\", [_dec11], Object.getOwnPropertyDescriptor(_class.prototype, \"disposeClientInit\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposeNetworkStatusChange\", [_dec12], Object.getOwnPropertyDescriptor(_class.prototype, \"disposeNetworkStatusChange\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposeThemeChange\", [_dec13], Object.getOwnPropertyDescriptor(_class.prototype, \"disposeThemeChange\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"disposeRealAccountSignupEnd\", [_dec14], Object.getOwnPropertyDescriptor(_class.prototype, \"disposeRealAccountSignupEnd\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onUnmount\", [_dec15], Object.getOwnPropertyDescriptor(_class.prototype, \"onUnmount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"assertHasValidCache\", [_dec16], Object.getOwnPropertyDescriptor(_class.prototype, \"assertHasValidCache\"), _class.prototype)), _class));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9TdG9yZXMvYmFzZS1zdG9yZS5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFtQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7O0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFGQTtBQUtBOztBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTs7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFIQTs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNBO0FBQ0E7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7O0FBRkE7QUFBQTtBQUFBO0FBQUE7O0FBSUE7QUFDQTs7QUFDQTtBQUNBO0FBUEE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFoQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFvQkE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7O0FBRkE7QUFBQTtBQUFBO0FBQUE7O0FBSUE7QUFDQTs7QUFDQTtBQUNBO0FBUEE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFoQkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFvQkE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTs7QUFGQTtBQUFBO0FBQUE7QUFBQTs7QUFJQTtBQUNBOztBQUNBO0FBQ0E7QUFQQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWhCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQW9CQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBOztBQUZBO0FBQUE7QUFBQTtBQUFBOztBQUlBO0FBQ0E7O0FBQ0E7QUFDQTtBQVBBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBaEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBb0JBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFGQTtBQUVBOztBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7OztBQTFnQkE7QUFDQTtBQUNBO0FBRkE7Ozs7O0FBTUE7O0FBRUE7Ozs7O0FBQ0E7O0FBdUJBOzs7OztBQUFBOztBQWdJQSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL1N0b3Jlcy9iYXNlLXN0b3JlLmpzP2M0YTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYWN0aW9uLCBpbnRlcmNlcHQsIG9ic2VydmFibGUsIHJlYWN0aW9uLCB0b0pTLCB3aGVuIH0gZnJvbSAnbW9ieCc7XG5pbXBvcnQgeyBpc1Byb2R1Y3Rpb24sIGlzRW1wdHlPYmplY3QgfSBmcm9tICdAZGVyaXYvc2hhcmVkJztcblxuaW1wb3J0IFZhbGlkYXRvciBmcm9tICdVdGlscy9WYWxpZGF0b3InO1xuXG4vKipcbiAqIEJhc2VTdG9yZSBjbGFzcyBpcyB0aGUgYmFzZSBjbGFzcyBmb3IgYWxsIGRlZmluZWQgc3RvcmVzIGluIHRoZSBhcHBsaWNhdGlvbi4gSXQgaGFuZGxlcyBzb21lIHN0dWZmIHN1Y2ggYXM6XG4gKiAgMS4gQ3JlYXRpbmcgc25hcHNob3Qgb2JqZWN0IGZyb20gdGhlIHN0b3JlLlxuICogIDIuIFNhdmluZyB0aGUgc3RvcmUncyBzbmFwc2hvdCBpbiBsb2NhbC9zZXNzaW9uIHN0b3JhZ2UgYW5kIGtlZXBpbmcgdGhlbSBpbiBzeW5jLlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCYXNlU3RvcmUge1xuICAgIC8qKlxuICAgICAqIEFuIGVudW0gb2JqZWN0IHRvIGRlZmluZSBMT0NBTF9TVE9SQUdFIGFuZCBTRVNTSU9OX1NUT1JBR0VcbiAgICAgKi9cbiAgICBzdGF0aWMgU1RPUkFHRVMgPSBPYmplY3QuZnJlZXplKHtcbiAgICAgICAgTE9DQUxfU1RPUkFHRTogU3ltYm9sKCdMT0NBTF9TVE9SQUdFJyksXG4gICAgICAgIFNFU1NJT05fU1RPUkFHRTogU3ltYm9sKCdTRVNTSU9OX1NUT1JBR0UnKSxcbiAgICB9KTtcblxuICAgIEBvYnNlcnZhYmxlXG4gICAgdmFsaWRhdGlvbl9lcnJvcnMgPSB7fTtcblxuICAgIEBvYnNlcnZhYmxlXG4gICAgdmFsaWRhdGlvbl9ydWxlcyA9IHt9O1xuXG4gICAgcHJlU3dpdGNoQWNjb3VudERpc3Bvc2VyID0gbnVsbDtcbiAgICBwcmVfc3dpdGNoX2FjY291bnRfbGlzdGVuZXIgPSBudWxsO1xuXG4gICAgc3dpdGNoQWNjb3VudERpc3Bvc2VyID0gbnVsbDtcbiAgICBzd2l0Y2hfYWNjb3VudF9saXN0ZW5lciA9IG51bGw7XG5cbiAgICBsb2dvdXREaXNwb3NlciA9IG51bGw7XG4gICAgbG9nb3V0X2xpc3RlbmVyID0gbnVsbDtcblxuICAgIGNsaWVudEluaXREaXNwb3NlciA9IG51bGw7XG4gICAgY2xpZW50X2luaXRfbGlzdGVuZXIgPSBudWxsO1xuXG4gICAgbmV0d29ya1N0YXR1c0NoYW5nZURpc3Bvc2VyID0gbnVsbDtcbiAgICBuZXR3b3JrX3N0YXR1c19jaGFuZ2VfbGlzdGVuZXIgPSBudWxsO1xuXG4gICAgdGhlbWVDaGFuZ2VEaXNwb3NlciA9IG51bGw7XG4gICAgdGhlbWVfY2hhbmdlX2xpc3RlbmVyID0gbnVsbDtcblxuICAgIHJlYWxBY2NvdW50U2lnbnVwRW5kZWREaXNwb3NlciA9IG51bGw7XG4gICAgcmVhbF9hY2NvdW50X3NpZ251cF9lbmRlZF9saXN0ZW5lciA9IG51bGw7XG5cbiAgICBAb2JzZXJ2YWJsZSBwYXJ0aWFsX2ZldGNoX3RpbWUgPSAwO1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3Igb2YgdGhlIGJhc2UgY2xhc3MgdGhhdCBnZXRzIHByb3BlcnRpZXMnIG5hbWUgb2YgY2hpbGQgd2hpY2ggc2hvdWxkIGJlIHNhdmVkIGluIHN0b3JhZ2VzXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAgICAgKiAgICAgQHByb3BlcnR5IHtPYmplY3R9ICAgcm9vdF9zdG9yZSAtIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSByb290IHN0b3JlIG9mIHRoZSBhcHAuXG4gICAgICogICAgIEBwcm9wZXJ0eSB7U3RyaW5nW119IGxvY2FsX3N0b3JhZ2VfcHJvcGVydGllcyAtIEEgbGlzdCBvZiBwcm9wZXJ0aWVzJyBuYW1lcyB0aGF0IHNob3VsZCBiZSBrZXB0IGluIGxvY2FsU3RvcmFnZS5cbiAgICAgKiAgICAgQHByb3BlcnR5IHtTdHJpbmdbXX0gc2Vzc2lvbl9zdG9yYWdlX3Byb3BlcnRpZXMgLSBBIGxpc3Qgb2YgcHJvcGVydGllcycgbmFtZXMgdGhhdCBzaG91bGQgYmUga2VwdCBpbiBzZXNzaW9uU3RvcmFnZS5cbiAgICAgKiAgICAgQHByb3BlcnR5IHtPYmplY3R9ICAgdmFsaWRhdGlvbl9ydWxlcyAtIEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSB2YWxpZGF0aW9uIHJ1bGVzIGZvciBlYWNoIHByb3BlcnR5IG9mIHRoZSBzdG9yZS5cbiAgICAgKiAgICAgQHByb3BlcnR5IHtTdHJpbmd9ICAgc3RvcmVfbmFtZSAtIEV4cGxpY2l0IHN0b3JlIG5hbWUgZm9yIGJyb3dzZXIgYXBwbGljYXRpb24gc3RvcmFnZSAodG8gYnlwYXNzIG1pbmlmaWNhdGlvbilcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHtcbiAgICAgICAgY29uc3QgeyByb290X3N0b3JlLCBsb2NhbF9zdG9yYWdlX3Byb3BlcnRpZXMsIHNlc3Npb25fc3RvcmFnZV9wcm9wZXJ0aWVzLCB2YWxpZGF0aW9uX3J1bGVzLCBzdG9yZV9uYW1lIH0gPVxuICAgICAgICAgICAgb3B0aW9ucztcblxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ3Jvb3Rfc3RvcmUnLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdsb2NhbF9zdG9yYWdlX3Byb3BlcnRpZXMnLCB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdzZXNzaW9uX3N0b3JhZ2VfcHJvcGVydGllcycsIHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGhhc19sb2NhbF9vcl9zZXNzaW9uX3N0b3JhZ2UgPVxuICAgICAgICAgICAgKGxvY2FsX3N0b3JhZ2VfcHJvcGVydGllcyAmJiBsb2NhbF9zdG9yYWdlX3Byb3BlcnRpZXMubGVuZ3RoKSB8fFxuICAgICAgICAgICAgKHNlc3Npb25fc3RvcmFnZV9wcm9wZXJ0aWVzICYmIHNlc3Npb25fc3RvcmFnZV9wcm9wZXJ0aWVzLmxlbmd0aCk7XG5cbiAgICAgICAgaWYgKGhhc19sb2NhbF9vcl9zZXNzaW9uX3N0b3JhZ2UpIHtcbiAgICAgICAgICAgIGlmICghc3RvcmVfbmFtZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc3RvcmVfbmFtZSBpcyByZXF1aXJlZCBmb3IgbG9jYWwvc2Vzc2lvbiBzdG9yYWdlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnc3RvcmVfbmFtZScsIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogc3RvcmVfbmFtZSxcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucm9vdF9zdG9yZSA9IHJvb3Rfc3RvcmU7XG4gICAgICAgIHRoaXMubG9jYWxfc3RvcmFnZV9wcm9wZXJ0aWVzID0gbG9jYWxfc3RvcmFnZV9wcm9wZXJ0aWVzIHx8IFtdO1xuICAgICAgICB0aGlzLnNlc3Npb25fc3RvcmFnZV9wcm9wZXJ0aWVzID0gc2Vzc2lvbl9zdG9yYWdlX3Byb3BlcnRpZXMgfHwgW107XG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdGlvblJ1bGVzKHZhbGlkYXRpb25fcnVsZXMpO1xuXG4gICAgICAgIHRoaXMuc2V0dXBSZWFjdGlvbkZvckxvY2FsU3RvcmFnZSgpO1xuICAgICAgICB0aGlzLnNldHVwUmVhY3Rpb25Gb3JTZXNzaW9uU3RvcmFnZSgpO1xuICAgICAgICB0aGlzLnJldHJpZXZlRnJvbVN0b3JhZ2UoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIHNuYXBzaG90IG9mIHRoZSBjdXJyZW50IHN0b3JlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ1tdfSBwcm9wZXJ0aWVzIC0gQSBsaXN0IG9mIHByb3BlcnRpZXMnIG5hbWVzIHRoYXQgc2hvdWxkIGJlIGluIHRoZSBzbmFwc2hvdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge09iamVjdH0gUmV0dXJucyBhIGNsb25lZCBvYmplY3Qgb2YgdGhlIHN0b3JlLlxuICAgICAqL1xuICAgIGdldFNuYXBzaG90KHByb3BlcnRpZXMpIHtcbiAgICAgICAgbGV0IHNuYXBzaG90ID0gdG9KUyh0aGlzKTtcblxuICAgICAgICBpZiAoIWlzRW1wdHlPYmplY3QodGhpcy5yb290X3N0b3JlKSkge1xuICAgICAgICAgICAgc25hcHNob3Qucm9vdF9zdG9yZSA9IHRoaXMucm9vdF9zdG9yZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcm9wZXJ0aWVzICYmIHByb3BlcnRpZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBzbmFwc2hvdCA9IHByb3BlcnRpZXMucmVkdWNlKChyZXN1bHQsIHApID0+IE9iamVjdC5hc3NpZ24ocmVzdWx0LCB7IFtwXTogc25hcHNob3RbcF0gfSksIHt9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzbmFwc2hvdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIGEgcmVhY3Rpb24gb24gcHJvcGVydGllcyB3aGljaCBhcmUgbWVudGlvbmVkIGluIGBsb2NhbF9zdG9yYWdlX3Byb3BlcnRpZXNgXG4gICAgICogIGFuZCBpbnZva2VzIGBzYXZlVG9TdG9yYWdlYCB3aGVuIHRoZXJlIGFyZSBhbnkgY2hhbmdlcyBvbiB0aGVtLlxuICAgICAqXG4gICAgICovXG4gICAgc2V0dXBSZWFjdGlvbkZvckxvY2FsU3RvcmFnZSgpIHtcbiAgICAgICAgaWYgKHRoaXMubG9jYWxfc3RvcmFnZV9wcm9wZXJ0aWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmVhY3Rpb24oXG4gICAgICAgICAgICAgICAgKCkgPT4gdGhpcy5sb2NhbF9zdG9yYWdlX3Byb3BlcnRpZXMubWFwKGkgPT4gdGhpc1tpXSksXG4gICAgICAgICAgICAgICAgKCkgPT4gdGhpcy5zYXZlVG9TdG9yYWdlKHRoaXMubG9jYWxfc3RvcmFnZV9wcm9wZXJ0aWVzLCBCYXNlU3RvcmUuU1RPUkFHRVMuTE9DQUxfU1RPUkFHRSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIGEgcmVhY3Rpb24gb24gcHJvcGVydGllcyB3aGljaCBhcmUgbWVudGlvbmVkIGluIGBzZXNzaW9uX3N0b3JhZ2VfcHJvcGVydGllc2BcbiAgICAgKiAgYW5kIGludm9rZXMgYHNhdmVUb1N0b3JhZ2VgIHdoZW4gdGhlcmUgYXJlIGFueSBjaGFuZ2VzIG9uIHRoZW0uXG4gICAgICpcbiAgICAgKi9cbiAgICBzZXR1cFJlYWN0aW9uRm9yU2Vzc2lvblN0b3JhZ2UoKSB7XG4gICAgICAgIGlmICh0aGlzLnNlc3Npb25fc3RvcmFnZV9wcm9wZXJ0aWVzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmVhY3Rpb24oXG4gICAgICAgICAgICAgICAgKCkgPT4gdGhpcy5zZXNzaW9uX3N0b3JhZ2VfcHJvcGVydGllcy5tYXAoaSA9PiB0aGlzW2ldKSxcbiAgICAgICAgICAgICAgICAoKSA9PiB0aGlzLnNhdmVUb1N0b3JhZ2UodGhpcy5zZXNzaW9uX3N0b3JhZ2VfcHJvcGVydGllcywgQmFzZVN0b3JlLlNUT1JBR0VTLlNFU1NJT05fU1RPUkFHRSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHByb3BlcnRpZXMgdGhhdCBhcmUgbm90IHBhc3NlZCBmcm9tIHRoZSBzbmFwc2hvdCBvZiB0aGUgc3RvcmUgYW5kIHNhdmVzIGl0IHRvIHRoZSBwYXNzZWQgc3RvcmFnZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmdbXX0gcHJvcGVydGllcyAtIEEgbGlzdCBvZiB0aGUgc3RvcmUncyBwcm9wZXJ0aWVzJyBuYW1lcyB3aGljaCBzaG91bGQgYmUgc2F2ZWQgaW4gdGhlIHN0b3JhZ2UuXG4gICAgICogQHBhcmFtIHtTeW1ib2x9ICAgc3RvcmFnZSAgICAtIEEgc3ltYm9sIG9iamVjdCB0aGF0IGRlZmluZXMgdGhlIHN0b3JhZ2Ugd2hpY2ggdGhlIHNuYXBzaG90IHNob3VsZCBiZSBzdG9yZWQgaW4gaXQuXG4gICAgICpcbiAgICAgKi9cbiAgICBzYXZlVG9TdG9yYWdlKHByb3BlcnRpZXMsIHN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3Qgc25hcHNob3QgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmdldFNuYXBzaG90KHByb3BlcnRpZXMpLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoc3RvcmFnZSA9PT0gQmFzZVN0b3JlLlNUT1JBR0VTLkxPQ0FMX1NUT1JBR0UpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuc3RvcmVfbmFtZSwgc25hcHNob3QpO1xuICAgICAgICB9IGVsc2UgaWYgKHN0b3JhZ2UgPT09IEJhc2VTdG9yZS5TVE9SQUdFUy5TRVNTSU9OX1NUT1JBR0UpIHtcbiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0odGhpcy5zdG9yZV9uYW1lLCBzbmFwc2hvdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgc2F2ZWQgc25hcHNob3Qgb2YgdGhlIHN0b3JlIGFuZCBhc3NpZ25zIHRvIHRoZSBjdXJyZW50IGluc3RhbmNlLlxuICAgICAqXG4gICAgICovXG4gICAgQGFjdGlvblxuICAgIHJldHJpZXZlRnJvbVN0b3JhZ2UoKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsX3N0b3JhZ2Vfc25hcHNob3QgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuc3RvcmVfbmFtZSwge30pKTtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbl9zdG9yYWdlX3NuYXBzaG90ID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHRoaXMuc3RvcmVfbmFtZSwge30pKTtcblxuICAgICAgICBjb25zdCBzbmFwc2hvdCA9IHsgLi4ubG9jYWxfc3RvcmFnZV9zbmFwc2hvdCwgLi4uc2Vzc2lvbl9zdG9yYWdlX3NuYXBzaG90IH07XG5cbiAgICAgICAgT2JqZWN0LmtleXMoc25hcHNob3QpLmZvckVhY2goayA9PiAodGhpc1trXSA9IHNuYXBzaG90W2tdKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB2YWxpZGF0aW9uIGVycm9yIG1lc3NhZ2VzIGZvciBhbiBvYnNlcnZhYmxlIHByb3BlcnR5IG9mIHRoZSBzdG9yZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5TmFtZSAtIFRoZSBvYnNlcnZhYmxlIHByb3BlcnR5J3MgbmFtZVxuICAgICAqIEBwYXJhbSBbe1N0cmluZ31dIG1lc3NhZ2VzIC0gQW4gYXJyYXkgb2Ygc3RyaW5ncyB0aGF0IGNvbnRhaW5zIHZhbGlkYXRpb24gZXJyb3IgbWVzc2FnZXMgZm9yIHRoZSBwYXJ0aWN1bGFyIHByb3BlcnR5LlxuICAgICAqXG4gICAgICovXG4gICAgQGFjdGlvblxuICAgIHNldFZhbGlkYXRpb25FcnJvck1lc3NhZ2VzKHByb3BlcnR5TmFtZSwgbWVzc2FnZXMpIHtcbiAgICAgICAgY29uc3QgaXNfZGlmZmVyZW50ID0gKCkgPT5cbiAgICAgICAgICAgICEhdGhpcy52YWxpZGF0aW9uX2Vycm9yc1twcm9wZXJ0eU5hbWVdXG4gICAgICAgICAgICAgICAgLmZpbHRlcih4ID0+ICFtZXNzYWdlcy5pbmNsdWRlcyh4KSlcbiAgICAgICAgICAgICAgICAuY29uY2F0KG1lc3NhZ2VzLmZpbHRlcih4ID0+ICF0aGlzLnZhbGlkYXRpb25fZXJyb3JzW3Byb3BlcnR5TmFtZV0uaW5jbHVkZXMoeCkpKS5sZW5ndGg7XG4gICAgICAgIGlmICghdGhpcy52YWxpZGF0aW9uX2Vycm9yc1twcm9wZXJ0eU5hbWVdIHx8IGlzX2RpZmZlcmVudCgpKSB7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25fZXJyb3JzW3Byb3BlcnR5TmFtZV0gPSBtZXNzYWdlcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgdmFsaWRhdGlvbiBydWxlc1xuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHJ1bGVzXG4gICAgICpcbiAgICAgKi9cbiAgICBAYWN0aW9uXG4gICAgc2V0VmFsaWRhdGlvblJ1bGVzKHJ1bGVzID0ge30pIHtcbiAgICAgICAgT2JqZWN0LmtleXMocnVsZXMpLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIHRoaXMuYWRkUnVsZShrZXksIHJ1bGVzW2tleV0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIHJ1bGVzIHRvIHRoZSBwYXJ0aWN1bGFyIHByb3BlcnR5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHlcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcnVsZXNcbiAgICAgKlxuICAgICAqL1xuICAgIEBhY3Rpb25cbiAgICBhZGRSdWxlKHByb3BlcnR5LCBydWxlcykge1xuICAgICAgICB0aGlzLnZhbGlkYXRpb25fcnVsZXNbcHJvcGVydHldID0gcnVsZXM7XG5cbiAgICAgICAgaW50ZXJjZXB0KHRoaXMsIHByb3BlcnR5LCBjaGFuZ2UgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVByb3BlcnR5KHByb3BlcnR5LCBjaGFuZ2UubmV3VmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIGNoYW5nZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGVzIGEgcGFydGljdWxhciBwcm9wZXJ0eSBvZiB0aGUgc3RvcmVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eSAtIFRoZSBuYW1lIG9mIHRoZSBwcm9wZXJ0eSBpbiB0aGUgc3RvcmVcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gdmFsdWUgICAgLSBUaGUgdmFsdWUgb2YgdGhlIHByb3BlcnR5LCBpdCBjYW4gYmUgdW5kZWZpbmVkLlxuICAgICAqXG4gICAgICovXG4gICAgQGFjdGlvblxuICAgIHZhbGlkYXRlUHJvcGVydHkocHJvcGVydHksIHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IHRyaWdnZXIgPSB0aGlzLnZhbGlkYXRpb25fcnVsZXNbcHJvcGVydHldLnRyaWdnZXI7XG4gICAgICAgIGNvbnN0IGlucHV0cyA9IHsgW3Byb3BlcnR5XTogdmFsdWUgIT09IHVuZGVmaW5lZCA/IHZhbHVlIDogdGhpc1twcm9wZXJ0eV0gfTtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbl9ydWxlcyA9IHsgW3Byb3BlcnR5XTogdGhpcy52YWxpZGF0aW9uX3J1bGVzW3Byb3BlcnR5XS5ydWxlcyB8fCBbXSB9O1xuXG4gICAgICAgIGlmICghIXRyaWdnZXIgJiYgT2JqZWN0Lmhhc093blByb3BlcnR5LmNhbGwodGhpcywgdHJpZ2dlcikpIHtcbiAgICAgICAgICAgIGlucHV0c1t0cmlnZ2VyXSA9IHRoaXNbdHJpZ2dlcl07XG4gICAgICAgICAgICB2YWxpZGF0aW9uX3J1bGVzW3RyaWdnZXJdID0gdGhpcy52YWxpZGF0aW9uX3J1bGVzW3RyaWdnZXJdLnJ1bGVzIHx8IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IFZhbGlkYXRvcihpbnB1dHMsIHZhbGlkYXRpb25fcnVsZXMsIHRoaXMpO1xuXG4gICAgICAgIHZhbGlkYXRvci5pc1Bhc3NlZCgpO1xuXG4gICAgICAgIE9iamVjdC5rZXlzKGlucHV0cykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXRWYWxpZGF0aW9uRXJyb3JNZXNzYWdlcyhrZXksIHZhbGlkYXRvci5lcnJvcnMuZ2V0KGtleSkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBWYWxpZGF0ZXMgYWxsIHByb3BlcnRpZXMgd2hpY2ggdmFsaWRhdGlvbiBydWxlIGhhcyBiZWVuIHNldCBmb3IuXG4gICAgICpcbiAgICAgKi9cbiAgICBAYWN0aW9uXG4gICAgdmFsaWRhdGVBbGxQcm9wZXJ0aWVzKCkge1xuICAgICAgICBjb25zdCB2YWxpZGF0aW9uX3J1bGVzID0gT2JqZWN0LmtleXModGhpcy52YWxpZGF0aW9uX3J1bGVzKTtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbl9lcnJvcnMgPSBPYmplY3Qua2V5cyh0aGlzLnZhbGlkYXRpb25fZXJyb3JzKTtcblxuICAgICAgICB2YWxpZGF0aW9uX3J1bGVzLmZvckVhY2gocCA9PiB7XG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlUHJvcGVydHkocCwgdGhpc1twXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFJlbW92ZSBrZXlzIHRoYXQgYXJlIHByZXNlbnQgaW4gZXJyb3IsIGJ1dCBub3QgaW4gcnVsZXM6XG4gICAgICAgIHZhbGlkYXRpb25fZXJyb3JzLmZvckVhY2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0aW9uX3J1bGVzLmluY2x1ZGVzKGVycm9yKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnZhbGlkYXRpb25fZXJyb3JzW2Vycm9yXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIG9uU3dpdGNoQWNjb3VudChsaXN0ZW5lcikge1xuICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuc3dpdGNoX2FjY291bnRfbGlzdGVuZXIgPSBsaXN0ZW5lcjtcblxuICAgICAgICAgICAgdGhpcy5zd2l0Y2hBY2NvdW50RGlzcG9zZXIgPSB3aGVuKFxuICAgICAgICAgICAgICAgICgpID0+IHRoaXMucm9vdF9zdG9yZS5jbGllbnQuc3dpdGNoX2Jyb2FkY2FzdCxcbiAgICAgICAgICAgICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnN3aXRjaF9hY2NvdW50X2xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC50aGVuICYmIHR5cGVvZiByZXN1bHQudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLmNsaWVudC5zd2l0Y2hFbmRTaWduYWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblN3aXRjaEFjY291bnQodGhpcy5zd2l0Y2hfYWNjb3VudF9saXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU3dpdGNoaW5nIGFjY291bnQgbGlzdGVuZXJzIGFyZSByZXF1aXJlZCB0byByZXR1cm4gYSBwcm9taXNlLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUgaXMgbm8gbGlzdGVuZXIgY3VycmVudGx5IGFjdGl2ZS4gc28gd2UgY2FuIGp1c3QgaWdub3JlIHRoZSBlcnJvciByYWlzZWQgZnJvbSB0cmVhdGluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYSBudWxsIG9iamVjdCBhcyBhIGZ1bmN0aW9uLiBBbHRob3VnaCwgaW4gZGV2ZWxvcG1lbnQgbW9kZSwgd2UgdGhyb3cgYSBjb25zb2xlIGVycm9yLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1Byb2R1Y3Rpb24oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIG9uUHJlU3dpdGNoQWNjb3VudChsaXN0ZW5lcikge1xuICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMucHJlX3N3aXRjaF9hY2NvdW50X2xpc3RlbmVyID0gbGlzdGVuZXI7XG5cbiAgICAgICAgICAgIHRoaXMucHJlU3dpdGNoQWNjb3VudERpc3Bvc2VyID0gd2hlbihcbiAgICAgICAgICAgICAgICAoKSA9PiB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50LnByZV9zd2l0Y2hfYnJvYWRjYXN0LFxuICAgICAgICAgICAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucHJlX3N3aXRjaF9hY2NvdW50X2xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC50aGVuICYmIHR5cGVvZiByZXN1bHQudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLmNsaWVudC5zZXRQcmVTd2l0Y2hBY2NvdW50KGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblByZVN3aXRjaEFjY291bnQodGhpcy5wcmVfc3dpdGNoX2FjY291bnRfbGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ByZS1zd2l0Y2ggYWNjb3VudCBsaXN0ZW5lcnMgYXJlIHJlcXVpcmVkIHRvIHJldHVybiBhIHByb21pc2UuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGVyZSBpcyBubyBsaXN0ZW5lciBjdXJyZW50bHkgYWN0aXZlLiBzbyB3ZSBjYW4ganVzdCBpZ25vcmUgdGhlIGVycm9yIHJhaXNlZCBmcm9tIHRyZWF0aW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhIG51bGwgb2JqZWN0IGFzIGEgZnVuY3Rpb24uIEFsdGhvdWdoLCBpbiBkZXZlbG9wbWVudCBtb2RlLCB3ZSB0aHJvdyBhIGNvbnNvbGUgZXJyb3IuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUHJvZHVjdGlvbigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgb25Mb2dvdXQobGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5sb2dvdXREaXNwb3NlciA9IHdoZW4oXG4gICAgICAgICAgICAoKSA9PiB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50Lmhhc19sb2dnZWRfb3V0LFxuICAgICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMubG9nb3V0X2xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LnRoZW4gJiYgdHlwZW9mIHJlc3VsdC50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLmNsaWVudC5zZXRMb2dvdXQoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Mb2dvdXQodGhpcy5sb2dvdXRfbGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xvZ291dCBsaXN0ZW5lcnMgYXJlIHJlcXVpcmVkIHRvIHJldHVybiBhIHByb21pc2UuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGVyZSBpcyBubyBsaXN0ZW5lciBjdXJyZW50bHkgYWN0aXZlLiBzbyB3ZSBjYW4ganVzdCBpZ25vcmUgdGhlIGVycm9yIHJhaXNlZCBmcm9tIHRyZWF0aW5nXG4gICAgICAgICAgICAgICAgICAgIC8vIGEgbnVsbCBvYmplY3QgYXMgYSBmdW5jdGlvbi4gQWx0aG91Z2gsIGluIGRldmVsb3BtZW50IG1vZGUsIHdlIHRocm93IGEgY29uc29sZSBlcnJvci5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1Byb2R1Y3Rpb24oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5sb2dvdXRfbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgb25DbGllbnRJbml0KGxpc3RlbmVyKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SW5pdERpc3Bvc2VyID0gd2hlbihcbiAgICAgICAgICAgICgpID0+IHRoaXMucm9vdF9zdG9yZS5jbGllbnQuaW5pdGlhbGl6ZWRfYnJvYWRjYXN0LFxuICAgICAgICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuY2xpZW50X2luaXRfbGlzdGVuZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQudGhlbiAmJiB0eXBlb2YgcmVzdWx0LnRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50LnNldEluaXRpYWxpemVkKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2xpZW50SW5pdCh0aGlzLmNsaWVudF9pbml0X2xpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbGllbnQgaW5pdCBsaXN0ZW5lcnMgYXJlIHJlcXVpcmVkIHRvIHJldHVybiBhIHByb21pc2UuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGVyZSBpcyBubyBsaXN0ZW5lciBjdXJyZW50bHkgYWN0aXZlLiBzbyB3ZSBjYW4ganVzdCBpZ25vcmUgdGhlIGVycm9yIHJhaXNlZCBmcm9tIHRyZWF0aW5nXG4gICAgICAgICAgICAgICAgICAgIC8vIGEgbnVsbCBvYmplY3QgYXMgYSBmdW5jdGlvbi4gQWx0aG91Z2gsIGluIGRldmVsb3BtZW50IG1vZGUsIHdlIHRocm93IGEgY29uc29sZSBlcnJvci5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1Byb2R1Y3Rpb24oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5jbGllbnRfaW5pdF9saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBvbk5ldHdvcmtTdGF0dXNDaGFuZ2UobGlzdGVuZXIpIHtcbiAgICAgICAgdGhpcy5uZXR3b3JrU3RhdHVzQ2hhbmdlRGlzcG9zZXIgPSByZWFjdGlvbihcbiAgICAgICAgICAgICgpID0+IHRoaXMucm9vdF9zdG9yZS5jb21tb24uaXNfbmV0d29ya19vbmxpbmUsXG4gICAgICAgICAgICBpc19vbmxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmV0d29ya19zdGF0dXNfY2hhbmdlX2xpc3RlbmVyKGlzX29ubGluZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUgaXMgbm8gbGlzdGVuZXIgY3VycmVudGx5IGFjdGl2ZS4gc28gd2UgY2FuIGp1c3QgaWdub3JlIHRoZSBlcnJvciByYWlzZWQgZnJvbSB0cmVhdGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyBhIG51bGwgb2JqZWN0IGFzIGEgZnVuY3Rpb24uIEFsdGhvdWdoLCBpbiBkZXZlbG9wbWVudCBtb2RlLCB3ZSB0aHJvdyBhIGNvbnNvbGUgZXJyb3IuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNQcm9kdWN0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5uZXR3b3JrX3N0YXR1c19jaGFuZ2VfbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgb25UaGVtZUNoYW5nZShsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLnRoZW1lQ2hhbmdlRGlzcG9zZXIgPSByZWFjdGlvbihcbiAgICAgICAgICAgICgpID0+IHRoaXMucm9vdF9zdG9yZS51aS5pc19kYXJrX21vZGVfb24sXG4gICAgICAgICAgICBpc19kYXJrX21vZGVfb24gPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGhlbWVfY2hhbmdlX2xpc3RlbmVyKGlzX2RhcmtfbW9kZV9vbik7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlcmUgaXMgbm8gbGlzdGVuZXIgY3VycmVudGx5IGFjdGl2ZS4gc28gd2UgY2FuIGp1c3QgaWdub3JlIHRoZSBlcnJvciByYWlzZWQgZnJvbSB0cmVhdGluZ1xuICAgICAgICAgICAgICAgICAgICAvLyBhIG51bGwgb2JqZWN0IGFzIGEgZnVuY3Rpb24uIEFsdGhvdWdoLCBpbiBkZXZlbG9wbWVudCBtb2RlLCB3ZSB0aHJvdyBhIGNvbnNvbGUgZXJyb3IuXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNQcm9kdWN0aW9uKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy50aGVtZV9jaGFuZ2VfbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgb25SZWFsQWNjb3VudFNpZ251cEVuZChsaXN0ZW5lcikge1xuICAgICAgICB0aGlzLnJlYWxBY2NvdW50U2lnbnVwRW5kZWREaXNwb3NlciA9IHdoZW4oXG4gICAgICAgICAgICAoKSA9PiB0aGlzLnJvb3Rfc3RvcmUudWkuaGFzX3JlYWxfYWNjb3VudF9zaWdudXBfZW5kZWQsXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZWFsX2FjY291bnRfc2lnbnVwX2VuZGVkX2xpc3RlbmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LnRoZW4gJiYgdHlwZW9mIHJlc3VsdC50aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnNldFJlYWxBY2NvdW50U2lnbnVwRW5kKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uUmVhbEFjY291bnRTaWdudXBFbmQodGhpcy5yZWFsX2FjY291bnRfc2lnbnVwX2VuZGVkX2xpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWFsIGFjY291bnQgc2lnbnVwIGxpc3RlbmVycyBhcmUgcmVxdWlyZWQgdG8gcmV0dXJuIGEgcHJvbWlzZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZXJlIGlzIG5vIGxpc3RlbmVyIGN1cnJlbnRseSBhY3RpdmUuIHNvIHdlIGNhbiBqdXN0IGlnbm9yZSB0aGUgZXJyb3IgcmFpc2VkIGZyb20gdHJlYXRpbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gYSBudWxsIG9iamVjdCBhcyBhIGZ1bmN0aW9uLiBBbHRob3VnaCwgaW4gZGV2ZWxvcG1lbnQgbW9kZSwgd2UgdGhyb3cgYSBjb25zb2xlIGVycm9yLlxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzUHJvZHVjdGlvbigpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMucmVhbF9hY2NvdW50X3NpZ251cF9lbmRlZF9saXN0ZW5lciA9IGxpc3RlbmVyO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBkaXNwb3NlUHJlU3dpdGNoQWNjb3VudCgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnByZVN3aXRjaEFjY291bnREaXNwb3NlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5wcmVTd2l0Y2hBY2NvdW50RGlzcG9zZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByZV9zd2l0Y2hfYWNjb3VudF9saXN0ZW5lciA9IG51bGw7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGRpc3Bvc2VTd2l0Y2hBY2NvdW50KCkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuc3dpdGNoQWNjb3VudERpc3Bvc2VyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLnN3aXRjaEFjY291bnREaXNwb3NlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3dpdGNoX2FjY291bnRfbGlzdGVuZXIgPSBudWxsO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBkaXNwb3NlTG9nb3V0KCkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMubG9nb3V0RGlzcG9zZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMubG9nb3V0RGlzcG9zZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmxvZ291dF9saXN0ZW5lciA9IG51bGw7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGRpc3Bvc2VDbGllbnRJbml0KCkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMuY2xpZW50SW5pdERpc3Bvc2VyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLmNsaWVudEluaXREaXNwb3NlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xpZW50X2luaXRfbGlzdGVuZXIgPSBudWxsO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBkaXNwb3NlTmV0d29ya1N0YXR1c0NoYW5nZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm5ldHdvcmtTdGF0dXNDaGFuZ2VEaXNwb3NlciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdGhpcy5uZXR3b3JrU3RhdHVzQ2hhbmdlRGlzcG9zZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5ldHdvcmtfc3RhdHVzX2NoYW5nZV9saXN0ZW5lciA9IG51bGw7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGRpc3Bvc2VUaGVtZUNoYW5nZSgpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnRoZW1lQ2hhbmdlRGlzcG9zZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRoaXMudGhlbWVDaGFuZ2VEaXNwb3NlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMudGhlbWVfY2hhbmdlX2xpc3RlbmVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgZGlzcG9zZVJlYWxBY2NvdW50U2lnbnVwRW5kKCkge1xuICAgICAgICBpZiAodHlwZW9mIHRoaXMucmVhbEFjY291bnRTaWdudXBFbmRlZERpc3Bvc2VyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aGlzLnJlYWxBY2NvdW50U2lnbnVwRW5kZWREaXNwb3NlcigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVhbF9hY2NvdW50X3NpZ251cF9lbmRlZF9saXN0ZW5lciA9IG51bGw7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIG9uVW5tb3VudCgpIHtcbiAgICAgICAgdGhpcy5kaXNwb3NlUHJlU3dpdGNoQWNjb3VudCgpO1xuICAgICAgICB0aGlzLmRpc3Bvc2VTd2l0Y2hBY2NvdW50KCk7XG4gICAgICAgIHRoaXMuZGlzcG9zZUxvZ291dCgpO1xuICAgICAgICB0aGlzLmRpc3Bvc2VDbGllbnRJbml0KCk7XG4gICAgICAgIHRoaXMuZGlzcG9zZU5ldHdvcmtTdGF0dXNDaGFuZ2UoKTtcbiAgICAgICAgdGhpcy5kaXNwb3NlVGhlbWVDaGFuZ2UoKTtcbiAgICAgICAgdGhpcy5kaXNwb3NlUmVhbEFjY291bnRTaWdudXBFbmQoKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgYXNzZXJ0SGFzVmFsaWRDYWNoZShsb2dpbmlkLCAuLi5yZWFjdGlvbnMpIHtcbiAgICAgICAgLy8gYWNjb3VudCB3YXMgY2hhbmdlZCB3aGVuIHRoaXMgd2FzIHVubW91bnRlZC5cbiAgICAgICAgaWYgKHRoaXMucm9vdF9zdG9yZS5jbGllbnQubG9naW5pZCAhPT0gbG9naW5pZCkge1xuICAgICAgICAgICAgcmVhY3Rpb25zLmZvckVhY2goYWN0ID0+IGFjdCgpKTtcbiAgICAgICAgICAgIHRoaXMucGFydGlhbF9mZXRjaF90aW1lID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG4iXSwibmFtZXMiOlsiYWN0aW9uIiwiaW50ZXJjZXB0Iiwib2JzZXJ2YWJsZSIsInJlYWN0aW9uIiwidG9KUyIsIndoZW4iLCJpc1Byb2R1Y3Rpb24iLCJpc0VtcHR5T2JqZWN0IiwiVmFsaWRhdG9yIiwiQmFzZVN0b3JlIiwiYm91bmQiLCJvcHRpb25zIiwicHJlU3dpdGNoQWNjb3VudERpc3Bvc2VyIiwicHJlX3N3aXRjaF9hY2NvdW50X2xpc3RlbmVyIiwic3dpdGNoQWNjb3VudERpc3Bvc2VyIiwic3dpdGNoX2FjY291bnRfbGlzdGVuZXIiLCJsb2dvdXREaXNwb3NlciIsImxvZ291dF9saXN0ZW5lciIsImNsaWVudEluaXREaXNwb3NlciIsImNsaWVudF9pbml0X2xpc3RlbmVyIiwibmV0d29ya1N0YXR1c0NoYW5nZURpc3Bvc2VyIiwibmV0d29ya19zdGF0dXNfY2hhbmdlX2xpc3RlbmVyIiwidGhlbWVDaGFuZ2VEaXNwb3NlciIsInRoZW1lX2NoYW5nZV9saXN0ZW5lciIsInJlYWxBY2NvdW50U2lnbnVwRW5kZWREaXNwb3NlciIsInJlYWxfYWNjb3VudF9zaWdudXBfZW5kZWRfbGlzdGVuZXIiLCJyb290X3N0b3JlIiwibG9jYWxfc3RvcmFnZV9wcm9wZXJ0aWVzIiwic2Vzc2lvbl9zdG9yYWdlX3Byb3BlcnRpZXMiLCJ2YWxpZGF0aW9uX3J1bGVzIiwic3RvcmVfbmFtZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiaGFzX2xvY2FsX29yX3Nlc3Npb25fc3RvcmFnZSIsImxlbmd0aCIsIkVycm9yIiwidmFsdWUiLCJzZXRWYWxpZGF0aW9uUnVsZXMiLCJzZXR1cFJlYWN0aW9uRm9yTG9jYWxTdG9yYWdlIiwic2V0dXBSZWFjdGlvbkZvclNlc3Npb25TdG9yYWdlIiwicmV0cmlldmVGcm9tU3RvcmFnZSIsInByb3BlcnRpZXMiLCJzbmFwc2hvdCIsInJlZHVjZSIsInJlc3VsdCIsInAiLCJhc3NpZ24iLCJtYXAiLCJpIiwic2F2ZVRvU3RvcmFnZSIsIlNUT1JBR0VTIiwiTE9DQUxfU1RPUkFHRSIsIlNFU1NJT05fU1RPUkFHRSIsInN0b3JhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0U25hcHNob3QiLCJrZXkiLCJ1bmRlZmluZWQiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwic2Vzc2lvblN0b3JhZ2UiLCJsb2NhbF9zdG9yYWdlX3NuYXBzaG90IiwicGFyc2UiLCJnZXRJdGVtIiwic2Vzc2lvbl9zdG9yYWdlX3NuYXBzaG90Iiwia2V5cyIsImZvckVhY2giLCJrIiwicHJvcGVydHlOYW1lIiwibWVzc2FnZXMiLCJpc19kaWZmZXJlbnQiLCJ2YWxpZGF0aW9uX2Vycm9ycyIsImZpbHRlciIsIngiLCJpbmNsdWRlcyIsImNvbmNhdCIsInJ1bGVzIiwiYWRkUnVsZSIsInByb3BlcnR5IiwiY2hhbmdlIiwidmFsaWRhdGVQcm9wZXJ0eSIsIm5ld1ZhbHVlIiwidHJpZ2dlciIsImlucHV0cyIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInZhbGlkYXRvciIsImlzUGFzc2VkIiwic2V0VmFsaWRhdGlvbkVycm9yTWVzc2FnZXMiLCJlcnJvcnMiLCJnZXQiLCJlcnJvciIsImxpc3RlbmVyIiwiY2xpZW50Iiwic3dpdGNoX2Jyb2FkY2FzdCIsInRoZW4iLCJzd2l0Y2hFbmRTaWduYWwiLCJvblN3aXRjaEFjY291bnQiLCJjb25zb2xlIiwicHJlX3N3aXRjaF9icm9hZGNhc3QiLCJzZXRQcmVTd2l0Y2hBY2NvdW50Iiwib25QcmVTd2l0Y2hBY2NvdW50IiwiaGFzX2xvZ2dlZF9vdXQiLCJzZXRMb2dvdXQiLCJvbkxvZ291dCIsImluaXRpYWxpemVkX2Jyb2FkY2FzdCIsInNldEluaXRpYWxpemVkIiwib25DbGllbnRJbml0IiwiY29tbW9uIiwiaXNfbmV0d29ya19vbmxpbmUiLCJpc19vbmxpbmUiLCJ1aSIsImlzX2RhcmtfbW9kZV9vbiIsImhhc19yZWFsX2FjY291bnRfc2lnbnVwX2VuZGVkIiwic2V0UmVhbEFjY291bnRTaWdudXBFbmQiLCJvblJlYWxBY2NvdW50U2lnbnVwRW5kIiwiZGlzcG9zZVByZVN3aXRjaEFjY291bnQiLCJkaXNwb3NlU3dpdGNoQWNjb3VudCIsImRpc3Bvc2VMb2dvdXQiLCJkaXNwb3NlQ2xpZW50SW5pdCIsImRpc3Bvc2VOZXR3b3JrU3RhdHVzQ2hhbmdlIiwiZGlzcG9zZVRoZW1lQ2hhbmdlIiwiZGlzcG9zZVJlYWxBY2NvdW50U2lnbnVwRW5kIiwibG9naW5pZCIsInJlYWN0aW9ucyIsImFjdCIsInBhcnRpYWxfZmV0Y2hfdGltZSIsImZyZWV6ZSIsIlN5bWJvbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Stores/base-store.js\n");

/***/ }),

/***/ "./Stores/client-store.js":
/*!********************************!*\
  !*** ./Stores/client-store.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ClientStore)\n/* harmony export */ });\n/* harmony import */ var js_cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! js-cookie */ \"../../../node_modules/js-cookie/src/js.cookie.js\");\n/* harmony import */ var js_cookie__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(js_cookie__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mobx */ \"../../../node_modules/mobx/lib/mobx.module.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! moment */ \"../../../node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _deriv_shared__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @deriv/shared */ \"../../shared/src/index.js\");\n/* harmony import */ var _deriv_translations__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @deriv/translations */ \"../../translations/src/index.js\");\n/* harmony import */ var Services__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! Services */ \"./Services/index.js\");\n/* harmony import */ var Services_socket_general__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! Services/socket-general */ \"./Services/socket-general.js\");\n/* harmony import */ var _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! _common/base/socket_base */ \"./_common/base/socket_base.js\");\n/* harmony import */ var _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_common_base_socket_base__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _common_base_socket_cache__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! _common/base/socket_cache */ \"./_common/base/socket_cache.js\");\n/* harmony import */ var _common_base_socket_cache__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_common_base_socket_cache__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _common_utility__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! _common/utility */ \"./_common/utility.js\");\n/* harmony import */ var _common_utility__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_common_utility__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _base_store__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./base-store */ \"./Stores/base-store.js\");\n/* harmony import */ var _Helpers_client__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./Helpers/client */ \"./Stores/Helpers/client.js\");\n/* harmony import */ var _Helpers_device__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./Helpers/device */ \"./Stores/Helpers/device.js\");\n/* harmony import */ var _Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./Helpers/client-notifications */ \"./Stores/Helpers/client-notifications.js\");\n/* harmony import */ var _Modules_Trading_Helpers_currency__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./Modules/Trading/Helpers/currency */ \"./Stores/Modules/Trading/Helpers/currency.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _dec18, _dec19, _dec20, _dec21, _dec22, _dec23, _dec24, _dec25, _dec26, _dec27, _dec28, _dec29, _dec30, _dec31, _dec32, _dec33, _dec34, _dec35, _dec36, _dec37, _dec38, _dec39, _dec40, _dec41, _dec42, _dec43, _dec44, _dec45, _dec46, _dec47, _dec48, _dec49, _dec50, _dec51, _dec52, _dec53, _dec54, _dec55, _dec56, _dec57, _dec58, _dec59, _dec60, _dec61, _dec62, _dec63, _dec64, _dec65, _dec66, _dec67, _dec68, _dec69, _dec70, _dec71, _dec72, _dec73, _dec74, _dec75, _class, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _descriptor11, _descriptor12, _descriptor13, _descriptor14, _descriptor15, _descriptor16, _descriptor17, _descriptor18, _descriptor19, _descriptor20, _descriptor21, _descriptor22, _descriptor23, _descriptor24, _descriptor25, _descriptor26, _descriptor27, _descriptor28, _descriptor29, _descriptor30, _descriptor31, _descriptor32, _descriptor33, _descriptor34, _descriptor35, _descriptor36, _descriptor37, _descriptor38, _descriptor39, _descriptor40, _descriptor41, _descriptor42, _descriptor43, _descriptor44, _descriptor45, _descriptor46, _descriptor47, _descriptor48, _descriptor49, _descriptor50;\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\nfunction _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar LANGUAGE_KEY = 'i18n_language';\nvar storage_key = 'client.accounts';\nvar store_name = 'client_store';\nvar eu_shortcode_regex = new RegExp('^(maltainvest|malta|iom)$');\nvar eu_excluded_regex = new RegExp('^mt$');\nvar ClientStore = (_dec = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec2 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec3 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec4 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec5 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec6 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec7 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec8 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec9 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec10 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec11 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec12 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec13 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec14 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec15 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec16 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec17 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec18 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec19 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec20 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec21 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec22 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec23 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec24 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec25 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec26 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec27 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec28 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec29 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec30 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec31 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec32 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec33 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec34 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec35 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec36 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec37 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec38 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec39 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec40 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec41 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec42 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec43 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec44 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec45 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec46 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec47 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec48 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec49 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec50 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec51 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec52 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec53 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec54 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec55 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec56 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec57 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec58 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec59 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec60 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec61 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec62 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec63 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec64 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec65 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec66 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec67 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec68 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec69 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec70 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec71 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec72 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec73 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec74 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec75 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, (_class = /*#__PURE__*/function (_BaseStore) {\n  _inherits(ClientStore, _BaseStore);\n\n  var _super = _createSuper(ClientStore);\n\n  // TODO: Temporary variable. Remove after MX account closure has finished.\n  // this will store the landing_company API response, including\n  // financial_company: {}\n  // gaming_company: {}\n  // mt_financial_company: {}\n  // mt_gaming_company: {}\n  // All possible landing companies of user between all\n  function ClientStore(root_store) {\n    var _this;\n\n    _classCallCheck(this, ClientStore);\n\n    var local_storage_properties = ['device_data'];\n    _this = _super.call(this, {\n      root_store: root_store,\n      local_storage_properties: local_storage_properties,\n      store_name: store_name\n    });\n\n    _initializerDefineProperty(_this, \"loginid\", _descriptor, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"preferred_language\", _descriptor2, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"upgrade_info\", _descriptor3, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"email\", _descriptor4, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"accounts\", _descriptor5, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"pre_switch_broadcast\", _descriptor6, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"switched\", _descriptor7, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_switching\", _descriptor8, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"switch_broadcast\", _descriptor9, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"initialized_broadcast\", _descriptor10, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"currencies_list\", _descriptor11, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"residence_list\", _descriptor12, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"states_list\", _descriptor13, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"selected_currency\", _descriptor14, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_populating_account_list\", _descriptor15, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_populating_mt5_account_list\", _descriptor16, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_populating_dxtrade_account_list\", _descriptor17, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"has_reality_check\", _descriptor18, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_reality_check_dismissed\", _descriptor19, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"reality_check_dur\", _descriptor20, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"reality_check_timeout\", _descriptor21, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"website_status\", _descriptor22, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"account_settings\", _descriptor23, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"account_status\", _descriptor24, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"device_data\", _descriptor25, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_logging_in\", _descriptor26, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"has_logged_out\", _descriptor27, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_landing_company_loaded\", _descriptor28, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_account_setting_loaded\", _descriptor29, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"client_notifications\", _descriptor30, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"landing_companies\", _descriptor31, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"standpoint\", _descriptor32, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"upgradeable_landing_companies\", _descriptor33, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"mt5_disabled_signup_types\", _descriptor34, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"mt5_login_list\", _descriptor35, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"mt5_login_list_error\", _descriptor36, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"dxtrade_accounts_list\", _descriptor37, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"dxtrade_accounts_list_error\", _descriptor38, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"dxtrade_disabled_signup_types\", _descriptor39, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"statement\", _descriptor40, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"obj_total_balance\", _descriptor41, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"verification_code\", _descriptor42, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"account_limits\", _descriptor43, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"self_exclusion\", _descriptor44, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"local_currency_config\", _descriptor45, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"has_cookie_account\", _descriptor46, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"financial_assessment\", _descriptor47, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"mt5_trading_servers\", _descriptor48, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"dxtrade_trading_servers\", _descriptor49, _assertThisInitialized(_this));\n\n    _this.is_mt5_account_list_updated = false;\n\n    _this.hasAnyRealAccount = function () {\n      return _this.account_list.some(function (acc) {\n        return acc.is_virtual === 0;\n      });\n    };\n\n    _this.hasAccountErrorInCFDList = function (platform, account_type) {\n      if (!_this.is_logged_in) return false;\n      var list = platform === _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.MT5 ? _this.mt5_login_list : _this.dxtrade_accounts_list;\n      return list === null || list === void 0 ? void 0 : list.some(function (account) {\n        return !!account.has_error && account.account_type === account_type;\n      });\n    };\n\n    _this.isMT5Allowed = function (landing_companies) {\n      // default allowing mt5 to true before landing_companies gets populated\n      // since most clients are allowed to use mt5\n      if (!landing_companies || !Object.keys(landing_companies).length) return true;\n\n      if (!_this.mt5_login_list.some(function (acc) {\n        return acc.market_type === 'synthetic';\n      })) {\n        if (_this.country_standpoint.is_belgium || _this.country_standpoint.is_france) return false;\n      }\n\n      return 'mt_financial_company' in landing_companies || 'mt_gaming_company' in landing_companies;\n    };\n\n    _this.isDxtradeAllowed = function (landing_companies) {\n      var _this$website_status;\n\n      // Stop showing DerivX for non-logged in EU users\n      if (!_this.is_logged_in && _this.is_eu_country) return false;\n      if (!((_this$website_status = _this.website_status) !== null && _this$website_status !== void 0 && _this$website_status.clients_country) || !landing_companies || !Object.keys(landing_companies).length) return true;\n      return 'dxtrade_financial_company' in landing_companies || 'dxtrade_gaming_company' in landing_companies || !_this.is_logged_in && !_this.is_eu && !_this.is_eu_country;\n    };\n\n    _initializerDefineProperty(_this, \"setPreferredLanguage\", _descriptor50, _assertThisInitialized(_this));\n\n    _this.isEuCountrySelected = function (selected_country) {\n      if (selected_country) return (0,_common_utility__WEBPACK_IMPORTED_MODULE_9__.isEuCountry)(selected_country);\n      return false;\n    };\n\n    _this.isAccountOfType = function (type) {\n      var client_account_type = (0,_Helpers_client__WEBPACK_IMPORTED_MODULE_11__.getClientAccountType)(_this.loginid);\n      return (type === 'virtual' && client_account_type === 'virtual' || type === 'real' && client_account_type !== 'virtual' || type === client_account_type) && !_this.isDisabled();\n    };\n\n    _this.isAccountOfTypeDisabled = function (type) {\n      var filtered_list = _this.account_list.filter(function (acc) {\n        return (0,_Helpers_client__WEBPACK_IMPORTED_MODULE_11__.getClientAccountType)(acc.loginid) === type;\n      });\n\n      return filtered_list.length > 0 && filtered_list.every(function (acc) {\n        return acc.is_disabled;\n      });\n    };\n\n    _this.getRiskAssessment = function () {\n      var _this$account_status;\n\n      if (!_this.account_status) return false;\n      var status = (_this$account_status = _this.account_status) === null || _this$account_status === void 0 ? void 0 : _this$account_status.status;\n      return _this.isAccountOfType('financial') ? /(financial_assessment|trading_experience)_not_complete/.test(status) : /financial_assessment_not_complete/.test(status);\n    };\n\n    _this.shouldCompleteTax = function () {\n      var _ref;\n\n      if (!_this.isAccountOfType('financial')) return false;\n      return !/crs_tin_information/.test((_ref = _this.account_status || {}) === null || _ref === void 0 ? void 0 : _ref.status);\n    };\n\n    (0,mobx__WEBPACK_IMPORTED_MODULE_1__.reaction)(function () {\n      return [_this.is_logged_in, _this.loginid, _this.email, _this.landing_company, _this.currency, _this.residence, _this.account_settings, _this.preferred_language];\n    }, function () {\n      _this.setCookieAccount();\n    });\n    (0,mobx__WEBPACK_IMPORTED_MODULE_1__.when)(function () {\n      return !_this.is_logged_in && _this.root_store.ui && _this.root_store.ui.is_real_acc_signup_on;\n    }, function () {\n      return _this.root_store.ui.closeRealAccountSignup();\n    });\n    return _this;\n  }\n\n  _createClass(ClientStore, [{\n    key: \"balance\",\n    get: function get() {\n      if ((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(this.accounts)) return undefined;\n      return this.accounts[this.loginid] && 'balance' in this.accounts[this.loginid] ? this.accounts[this.loginid].balance.toString() : undefined;\n    }\n  }, {\n    key: \"is_reality_check_visible\",\n    get: function get() {\n      if (!this.loginid || !this.landing_company) {\n        return false;\n      }\n\n      return !!(this.has_reality_check && !this.reality_check_dismissed);\n    }\n  }, {\n    key: \"is_svg\",\n    get: function get() {\n      if (!this.landing_company_shortcode) {\n        return false;\n      }\n\n      return this.landing_company_shortcode === 'svg' || this.landing_company_shortcode === 'costarica';\n    }\n  }, {\n    key: \"reality_check_duration\",\n    get: function get() {\n      return this.has_reality_check ? this.reality_check_dur || +_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.get('reality_check_duration') : undefined;\n    }\n  }, {\n    key: \"reality_check_dismissed\",\n    get: function get() {\n      return this.has_reality_check ? this.is_reality_check_dismissed || JSON.parse(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.get('reality_check_dismissed') || false) : undefined;\n    }\n  }, {\n    key: \"has_active_real_account\",\n    get: function get() {\n      return this.active_accounts.some(function (acc) {\n        return acc.is_virtual === 0;\n      });\n    }\n  }, {\n    key: \"has_maltainvest_account\",\n    get: function get() {\n      return this.active_accounts.some(function (acc) {\n        return acc.landing_company_shortcode === 'maltainvest';\n      });\n    }\n  }, {\n    key: \"has_malta_account\",\n    get: function get() {\n      return this.active_accounts.some(function (acc) {\n        return acc.landing_company_shortcode === 'malta';\n      });\n    }\n  }, {\n    key: \"has_any_real_account\",\n    get: function get() {\n      return this.hasAnyRealAccount();\n    }\n  }, {\n    key: \"first_switchable_real_loginid\",\n    get: function get() {\n      var result = this.active_accounts.find(function (acc) {\n        return acc.is_virtual === 0 && acc.landing_company_shortcode === 'svg';\n      });\n      return result.loginid || undefined;\n    }\n  }, {\n    key: \"can_change_fiat_currency\",\n    get: function get() {\n      var has_no_mt5 = !this.has_real_mt5_login;\n      var has_no_dxtrade = !this.has_real_dxtrade_login;\n      var has_no_transaction = this.statement.count === 0 && this.statement.transactions.length === 0;\n      var has_account_criteria = has_no_transaction && has_no_mt5 && has_no_dxtrade;\n      return !this.is_virtual && has_account_criteria && this.current_currency_type === 'fiat';\n    }\n  }, {\n    key: \"legal_allowed_currencies\",\n    get: function get() {\n      var _this2 = this;\n\n      var getDefaultAllowedCurrencies = function getDefaultAllowedCurrencies() {\n        if (_this2.landing_companies.gaming_company) {\n          return _this2.landing_companies.gaming_company.legal_allowed_currencies;\n        }\n\n        if (_this2.landing_companies.financial_company) {\n          return _this2.landing_companies.financial_company.legal_allowed_currencies;\n        }\n\n        return [];\n      };\n\n      if (!this.landing_companies || !this.root_store.ui) return [];\n\n      if (!this.root_store.ui.real_account_signup_target) {\n        return getDefaultAllowedCurrencies();\n      }\n\n      if (['set_currency', 'manage'].includes(this.root_store.ui.real_account_signup_target) && this.current_landing_company) {\n        return this.current_landing_company.legal_allowed_currencies;\n      }\n\n      var target = this.root_store.ui.real_account_signup_target === 'maltainvest' ? 'financial' : 'gaming';\n\n      if (this.landing_companies[\"\".concat(target, \"_company\")]) {\n        return this.landing_companies[\"\".concat(target, \"_company\")].legal_allowed_currencies;\n      }\n\n      return getDefaultAllowedCurrencies();\n    }\n  }, {\n    key: \"upgradeable_currencies\",\n    get: function get() {\n      var _this3 = this;\n\n      if (!this.legal_allowed_currencies || !this.website_status.currencies_config) return [];\n      return this.legal_allowed_currencies.map(function (currency) {\n        return _objectSpread({\n          value: currency\n        }, _this3.website_status.currencies_config[currency]);\n      });\n    }\n  }, {\n    key: \"current_currency_type\",\n    get: function get() {\n      if (this.account_type === 'virtual') return 'virtual';\n\n      if (this.website_status && this.website_status.currencies_config && this.website_status.currencies_config[this.currency]) {\n        return this.website_status.currencies_config[this.currency].type;\n      }\n\n      return undefined;\n    }\n  }, {\n    key: \"available_crypto_currencies\",\n    get: function get() {\n      var values = Object.values(this.accounts).reduce(function (acc, item) {\n        acc.push(item.currency);\n        return acc;\n      }, []);\n      return this.upgradeable_currencies.filter(function (acc) {\n        return !values.includes(acc.value) && acc.type === 'crypto';\n      });\n    }\n  }, {\n    key: \"has_iom_account\",\n    get: function get() {\n      return this.active_accounts.some(function (acc) {\n        return acc.landing_company_shortcode === 'iom';\n      });\n    }\n  }, {\n    key: \"has_fiat\",\n    get: function get() {\n      var values = Object.values(this.accounts).reduce(function (acc, item) {\n        if (!item.is_virtual) {\n          acc.push(item.currency);\n        }\n\n        return acc;\n      }, []);\n      return !!this.upgradeable_currencies.filter(function (acc) {\n        return values.includes(acc.value) && acc.type === 'fiat';\n      }).length;\n    }\n  }, {\n    key: \"current_fiat_currency\",\n    get: function get() {\n      var values = Object.values(this.accounts).reduce(function (acc, item) {\n        if (!item.is_virtual) {\n          acc.push(item.currency);\n        }\n\n        return acc;\n      }, []);\n      return this.has_fiat ? this.upgradeable_currencies.filter(function (acc) {\n        return values.includes(acc.value) && acc.type === 'fiat';\n      })[0].value : undefined;\n    } // return the landing company object that belongs to the current client by matching shortcode\n    // note that it will be undefined for logged out and virtual clients\n\n  }, {\n    key: \"current_landing_company\",\n    get: function get() {\n      var _this4 = this;\n\n      var landing_company = this.landing_companies && Object.keys(this.landing_companies).find(function (company) {\n        var _this4$landing_compan;\n\n        return ((_this4$landing_compan = _this4.landing_companies[company]) === null || _this4$landing_compan === void 0 ? void 0 : _this4$landing_compan.shortcode) === _this4.landing_company_shortcode;\n      });\n      return landing_company ? this.landing_companies[landing_company] : undefined;\n    }\n  }, {\n    key: \"account_list\",\n    get: function get() {\n      var _this5 = this;\n\n      return this.all_loginids.map(function (id) {\n        return _this5.getAccountInfo(id);\n      }).filter(function (account) {\n        return account;\n      });\n    }\n  }, {\n    key: \"has_real_mt5_login\",\n    get: function get() {\n      return this.mt5_login_list.some(function (account) {\n        return account.account_type === 'real';\n      });\n    }\n  }, {\n    key: \"has_real_dxtrade_login\",\n    get: function get() {\n      return this.dxtrade_accounts_list.some(function (account) {\n        return account.account_type === 'real';\n      });\n    }\n  }, {\n    key: \"has_account_error_in_mt5_real_list\",\n    get: function get() {\n      return this.hasAccountErrorInCFDList(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.MT5, 'real');\n    }\n  }, {\n    key: \"has_account_error_in_mt5_demo_list\",\n    get: function get() {\n      return this.hasAccountErrorInCFDList(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.MT5, 'demo');\n    }\n  }, {\n    key: \"has_account_error_in_dxtrade_real_list\",\n    get: function get() {\n      return this.hasAccountErrorInCFDList(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE, 'real');\n    }\n  }, {\n    key: \"has_account_error_in_dxtrade_demo_list\",\n    get: function get() {\n      return this.hasAccountErrorInCFDList(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE, 'demo');\n    }\n  }, {\n    key: \"can_have_more_real_synthetic_mt5\",\n    get: function get() {\n      var number_of_current_added_synthetics = this.mt5_login_list.reduce(function (acc, cur) {\n        var is_included = cur.account_type === 'real' && (cur.market_type === 'synthetic' || cur.market_type === 'gaming');\n        return is_included ? acc + 1 : acc;\n      }, 0);\n      var number_of_available_synthetic = this.mt5_trading_servers.reduce(function (acc, cur) {\n        return cur.supported_accounts.includes('gaming') && !cur.disabled ? acc + 1 : acc;\n      }, 0);\n      return number_of_current_added_synthetics > 0 && number_of_available_synthetic > 0;\n    }\n  }, {\n    key: \"active_accounts\",\n    get: function get() {\n      return this.accounts instanceof Object ? Object.values(this.accounts).filter(function (account) {\n        return !account.is_disabled;\n      }) : [];\n    }\n  }, {\n    key: \"all_loginids\",\n    get: function get() {\n      return !(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(this.accounts) ? Object.keys(this.accounts) : [];\n    }\n  }, {\n    key: \"account_title\",\n    get: function get() {\n      return (0,_Helpers_client__WEBPACK_IMPORTED_MODULE_11__.getAccountTitle)(this.loginid);\n    }\n  }, {\n    key: \"currency\",\n    get: function get() {\n      if (this.selected_currency.length) {\n        return this.selected_currency;\n      } else if (this.is_logged_in) {\n        return this.accounts[this.loginid].currency;\n      }\n\n      return this.default_currency;\n    }\n  }, {\n    key: \"default_currency\",\n    get: function get() {\n      if (Object.keys(this.currencies_list).length > 0) {\n        var keys = Object.keys(this.currencies_list); // Fix for edge case when logging out from crypto accounts causes Fiat list to be empty\n\n        if (this.currencies_list[(0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Fiat')].length < 1) return 'USD';\n        return Object.values(this.currencies_list[\"\".concat(keys[0])])[0].text;\n      }\n\n      return 'USD';\n    }\n  }, {\n    key: \"should_allow_authentication\",\n    get: function get() {\n      var _this$account_status2, _this$account_status3;\n\n      return (_this$account_status2 = this.account_status) === null || _this$account_status2 === void 0 ? void 0 : (_this$account_status3 = _this$account_status2.status) === null || _this$account_status3 === void 0 ? void 0 : _this$account_status3.some(function (status) {\n        return status === 'allow_document_upload' || status === 'allow_poi_resubmission';\n      });\n    }\n  }, {\n    key: \"is_authentication_needed\",\n    get: function get() {\n      var _this$account_status4, _this$account_status5, _this$account_status6;\n\n      return !this.is_fully_authenticated && !!((_this$account_status4 = this.account_status) !== null && _this$account_status4 !== void 0 && (_this$account_status5 = _this$account_status4.authentication) !== null && _this$account_status5 !== void 0 && (_this$account_status6 = _this$account_status5.needs_verification) !== null && _this$account_status6 !== void 0 && _this$account_status6.length);\n    }\n  }, {\n    key: \"is_tnc_needed\",\n    get: function get() {\n      if (this.is_virtual) return false;\n      var client_tnc_status = this.account_settings.client_tnc_status;\n      var terms_conditions_version = this.website_status.terms_conditions_version;\n      return typeof client_tnc_status !== 'undefined' && client_tnc_status !== terms_conditions_version;\n    }\n  }, {\n    key: \"is_social_signup\",\n    get: function get() {\n      var _this$account_status7, _this$account_status8;\n\n      return (_this$account_status7 = this.account_status) === null || _this$account_status7 === void 0 ? void 0 : (_this$account_status8 = _this$account_status7.status) === null || _this$account_status8 === void 0 ? void 0 : _this$account_status8.includes('social_signup');\n    }\n  }, {\n    key: \"is_mt5_password_not_set\",\n    get: function get() {\n      var _this$account_status9, _this$account_status10;\n\n      return (_this$account_status9 = this.account_status) === null || _this$account_status9 === void 0 ? void 0 : (_this$account_status10 = _this$account_status9.status) === null || _this$account_status10 === void 0 ? void 0 : _this$account_status10.includes('mt5_password_not_set');\n    }\n  }, {\n    key: \"is_dxtrade_password_not_set\",\n    get: function get() {\n      var _this$account_status11, _this$account_status12;\n\n      return (_this$account_status11 = this.account_status) === null || _this$account_status11 === void 0 ? void 0 : (_this$account_status12 = _this$account_status11.status) === null || _this$account_status12 === void 0 ? void 0 : _this$account_status12.includes('dxtrade_password_not_set');\n    }\n  }, {\n    key: \"is_financial_information_incomplete\",\n    get: function get() {\n      var _this$account_status13, _this$account_status14;\n\n      return (_this$account_status13 = this.account_status) === null || _this$account_status13 === void 0 ? void 0 : (_this$account_status14 = _this$account_status13.status) === null || _this$account_status14 === void 0 ? void 0 : _this$account_status14.some(function (status) {\n        return status === 'financial_information_not_complete';\n      });\n    }\n  }, {\n    key: \"is_deposit_lock\",\n    get: function get() {\n      var _this$account_status15, _this$account_status16;\n\n      return (_this$account_status15 = this.account_status) === null || _this$account_status15 === void 0 ? void 0 : (_this$account_status16 = _this$account_status15.status) === null || _this$account_status16 === void 0 ? void 0 : _this$account_status16.some(function (status_name) {\n        return status_name === 'deposit_locked';\n      });\n    }\n  }, {\n    key: \"is_withdrawal_lock\",\n    get: function get() {\n      var _this$account_status17, _this$account_status18;\n\n      return (_this$account_status17 = this.account_status) === null || _this$account_status17 === void 0 ? void 0 : (_this$account_status18 = _this$account_status17.status) === null || _this$account_status18 === void 0 ? void 0 : _this$account_status18.some(function (status_name) {\n        return status_name === 'withdrawal_locked';\n      });\n    }\n  }, {\n    key: \"is_trading_experience_incomplete\",\n    get: function get() {\n      var _this$account_status19, _this$account_status20;\n\n      return (_this$account_status19 = this.account_status) === null || _this$account_status19 === void 0 ? void 0 : (_this$account_status20 = _this$account_status19.status) === null || _this$account_status20 === void 0 ? void 0 : _this$account_status20.some(function (status) {\n        return status === 'trading_experience_not_complete';\n      });\n    }\n  }, {\n    key: \"authentication_status\",\n    get: function get() {\n      var _this$account_status21, _this$account_status22, _this$account_status23, _this$account_status24, _this$account_status25, _this$account_status26;\n\n      var document_status = (_this$account_status21 = this.account_status) === null || _this$account_status21 === void 0 ? void 0 : (_this$account_status22 = _this$account_status21.authentication) === null || _this$account_status22 === void 0 ? void 0 : (_this$account_status23 = _this$account_status22.document) === null || _this$account_status23 === void 0 ? void 0 : _this$account_status23.status;\n      var identity_status = (_this$account_status24 = this.account_status) === null || _this$account_status24 === void 0 ? void 0 : (_this$account_status25 = _this$account_status24.authentication) === null || _this$account_status25 === void 0 ? void 0 : (_this$account_status26 = _this$account_status25.identity) === null || _this$account_status26 === void 0 ? void 0 : _this$account_status26.status;\n      return {\n        document_status: document_status,\n        identity_status: identity_status\n      };\n    }\n  }, {\n    key: \"social_identity_provider\",\n    get: function get() {\n      var _this$account_status27;\n\n      return (_this$account_status27 = this.account_status) === null || _this$account_status27 === void 0 ? void 0 : _this$account_status27.social_identity_provider;\n    }\n  }, {\n    key: \"is_from_restricted_country\",\n    get: function get() {\n      var _this$residence_list$,\n          _this6 = this;\n\n      return ((_this$residence_list$ = this.residence_list.find(function (item) {\n        return item.value === _this6.residence;\n      })) === null || _this$residence_list$ === void 0 ? void 0 : _this$residence_list$.disabled) === 'DISABLED';\n    }\n  }, {\n    key: \"is_fully_authenticated\",\n    get: function get() {\n      var _this$account_status28, _this$account_status29;\n\n      return (_this$account_status28 = this.account_status) === null || _this$account_status28 === void 0 ? void 0 : (_this$account_status29 = _this$account_status28.status) === null || _this$account_status29 === void 0 ? void 0 : _this$account_status29.some(function (status) {\n        return status === 'authenticated';\n      });\n    }\n  }, {\n    key: \"is_pending_authentication\",\n    get: function get() {\n      var _this$account_status30, _this$account_status31;\n\n      return (_this$account_status30 = this.account_status) === null || _this$account_status30 === void 0 ? void 0 : (_this$account_status31 = _this$account_status30.status) === null || _this$account_status31 === void 0 ? void 0 : _this$account_status31.some(function (status) {\n        return status === 'document_under_review';\n      });\n    }\n  }, {\n    key: \"is_financial_account\",\n    get: function get() {\n      if (!this.landing_companies) return false;\n      return this.account_type === 'financial';\n    }\n  }, {\n    key: \"is_age_verified\",\n    get: function get() {\n      var _this$account_status32, _this$account_status33;\n\n      return (_this$account_status32 = this.account_status) === null || _this$account_status32 === void 0 ? void 0 : (_this$account_status33 = _this$account_status32.status) === null || _this$account_status33 === void 0 ? void 0 : _this$account_status33.some(function (status) {\n        return status === 'age_verification';\n      });\n    }\n  }, {\n    key: \"landing_company_shortcode\",\n    get: function get() {\n      if (this.accounts[this.loginid]) {\n        return this.accounts[this.loginid].landing_company_shortcode;\n      }\n\n      return undefined;\n    }\n  }, {\n    key: \"landing_company\",\n    get: function get() {\n      return this.landing_companies;\n    }\n  }, {\n    key: \"is_valid_login\",\n    get: function get() {\n      if (!this.is_logged_in) return true;\n      var valid_login_ids_regex = new RegExp('^(MX|MF|VRTC|MLT|CR|FOG)[0-9]+$', 'i');\n      return this.all_loginids.every(function (id) {\n        return valid_login_ids_regex.test(id);\n      });\n    }\n  }, {\n    key: \"is_logged_in\",\n    get: function get() {\n      return !!(!(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(this.accounts) && Object.keys(this.accounts).length > 0 && this.loginid && this.accounts[this.loginid].token);\n    }\n  }, {\n    key: \"is_virtual\",\n    get: function get() {\n      return !(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(this.accounts) && this.accounts[this.loginid] && !!this.accounts[this.loginid].is_virtual;\n    }\n  }, {\n    key: \"is_eu\",\n    get: function get() {\n      if (!this.landing_companies) return false;\n      var _this$landing_compani = this.landing_companies,\n          gaming_company = _this$landing_compani.gaming_company,\n          financial_company = _this$landing_compani.financial_company;\n      var financial_shortcode = financial_company === null || financial_company === void 0 ? void 0 : financial_company.shortcode;\n      var gaming_shortcode = gaming_company === null || gaming_company === void 0 ? void 0 : gaming_company.shortcode;\n      return financial_shortcode || gaming_shortcode ? eu_shortcode_regex.test(financial_shortcode) || eu_shortcode_regex.test(gaming_shortcode) : eu_excluded_regex.test(this.residence);\n    }\n  }, {\n    key: \"is_uk\",\n    get: function get() {\n      return this.residence === 'gb';\n    }\n  }, {\n    key: \"country_standpoint\",\n    get: function get() {\n      var result = {\n        is_united_kingdom: this.is_uk,\n        is_isle_of_man: this.residence === 'im',\n        is_france: this.residence === 'fr',\n        is_belgium: this.residence === 'be',\n        // Other EU countries: Germany, Spain, Italy, Luxembourg and Greece\n        is_other_eu: this.residence === 'de' || this.residence === 'es' || this.residence === 'it' || this.residence === 'lu' || this.residence === 'gr'\n      };\n      result.is_rest_of_eu = this.is_eu && !result.is_uk && !result.is_france && !result.is_belgium && !result.is_other_eu;\n      return result;\n    }\n  }, {\n    key: \"custom_notifications\",\n    get: function get() {\n      var _this7 = this;\n\n      var notification_content = {\n        mx_mlt_notification: {\n          header: function header() {\n            if (_this7.has_malta_account || _this7.can_have_mlt_account) {\n              return (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Your Options account is scheduled to be closed');\n            } else if (_this7.is_uk) {\n              return (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Your Gaming account is scheduled to be closed');\n            }\n\n            return (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Your account is scheduled to be closed');\n          },\n          main: function main() {\n            if (_this7.has_malta_account || _this7.can_have_mlt_account) {\n              return (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Withdraw all funds from your Options account.');\n            } else if (_this7.is_uk) {\n              return (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Please withdraw all your funds as soon as possible.');\n            }\n\n            return (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Please proceed to withdraw your funds before 30 November 2021.');\n          }\n        }\n      };\n      return notification_content;\n    } // Manual list of MLT countries during MLT/MX account removal.\n    // Also needed to check onboarding modal text for specific country.\n\n  }, {\n    key: \"can_have_mlt_account\",\n    get: function get() {\n      var countries = ['nl', 'cy', 'ie', 'ro', 'be', 'lt', 'bg', 'cz', 'dk', 'se', 'pl', 'ee', 'hr', 'at', 'hu', 'sl', 'fi', 'sk', 'pt', 'lv'].includes(this.residence);\n      return countries;\n    } // Manual list of MX countries during MLT/MX account removal.\n\n  }, {\n    key: \"can_have_mx_account\",\n    get: function get() {\n      var countries = ['gb', 'im'].includes(this.residence);\n      return countries;\n    } // Manual list of MF countries during MLT/MX account removal.\n    // Also needed to check onboarding modal text for specific country.\n\n  }, {\n    key: \"can_have_mf_account\",\n    get: function get() {\n      var countries = ['it', 'fr', 'de', 'lu', 'es', 'gr', 'nl', 'cy', 'ie', 'ro', 'lt', 'bg', 'cz', 'dk', 'se', 'pl', 'ee', 'hr', 'at', 'hu', 'sl', 'fi', 'sk', 'pt', 'lv'].includes(this.residence);\n      return countries;\n    }\n  }, {\n    key: \"can_upgrade\",\n    get: function get() {\n      return this.upgrade_info && (this.upgrade_info.can_upgrade || this.upgrade_info.can_open_multi);\n    }\n  }, {\n    key: \"can_upgrade_to\",\n    get: function get() {\n      return this.upgrade_info && this.upgrade_info.can_upgrade_to;\n    }\n  }, {\n    key: \"virtual_account_loginid\",\n    get: function get() {\n      var _this8 = this;\n\n      return this.all_loginids.find(function (loginid) {\n        return !!_this8.accounts[loginid].is_virtual;\n      });\n    }\n  }, {\n    key: \"is_single_currency\",\n    get: function get() {\n      var _this9 = this;\n\n      return Object.keys(this.currencies_list).map(function (type) {\n        return Object.values(_this9.currencies_list[type]).length;\n      }).reduce(function (acc, cur) {\n        return acc + cur;\n      }, 0) === 1;\n    }\n  }, {\n    key: \"account_type\",\n    get: function get() {\n      return (0,_Helpers_client__WEBPACK_IMPORTED_MODULE_11__.getClientAccountType)(this.loginid);\n    }\n  }, {\n    key: \"is_mt5_allowed\",\n    get: function get() {\n      return this.isMT5Allowed(this.landing_companies);\n    }\n  }, {\n    key: \"is_dxtrade_allowed\",\n    get: function get() {\n      return this.isDxtradeAllowed(this.landing_companies);\n    }\n  }, {\n    key: \"clients_country\",\n    get: function get() {\n      var _this$website_status2;\n\n      return (_this$website_status2 = this.website_status) === null || _this$website_status2 === void 0 ? void 0 : _this$website_status2.clients_country;\n    }\n  }, {\n    key: \"is_eu_country\",\n    get: function get() {\n      var country = this.website_status.clients_country;\n      if (country) return (0,_common_utility__WEBPACK_IMPORTED_MODULE_9__.isEuCountry)(country);\n      return false;\n    }\n  }, {\n    key: \"is_options_blocked\",\n    get: function get() {\n      return (0,_common_utility__WEBPACK_IMPORTED_MODULE_9__.isOptionsBlocked)(this.residence);\n    }\n  }, {\n    key: \"is_multipliers_only\",\n    get: function get() {\n      return (0,_common_utility__WEBPACK_IMPORTED_MODULE_9__.isMultipliersOnly)(this.residence);\n    }\n    /**\n     * Store Values relevant to the loginid to local storage.\n     *\n     * @param loginid\n     */\n\n  }, {\n    key: \"resetLocalStorageValues\",\n    value: function resetLocalStorageValues(loginid) {\n      this.accounts[loginid].accepted_bch = 0;\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.setObject(storage_key, this.accounts);\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.set('active_loginid', loginid);\n      this.syncWithLegacyPlatforms(loginid, (0,mobx__WEBPACK_IMPORTED_MODULE_1__.toJS)(this.accounts));\n      this.loginid = loginid;\n    }\n  }, {\n    key: \"getBasicUpgradeInfo\",\n    value: function getBasicUpgradeInfo() {\n      var _this10 = this;\n\n      var upgradeable_landing_companies = _toConsumableArray(new Set(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.State.getResponse('authorize.upgradeable_landing_companies')));\n\n      var can_open_multi = false;\n      var type, can_upgrade_to;\n\n      if ((upgradeable_landing_companies || []).length) {\n        can_open_multi = upgradeable_landing_companies.indexOf(this.accounts[this.loginid].landing_company_shortcode) !== -1;\n\n        var canUpgrade = function canUpgrade() {\n          for (var _len = arguments.length, landing_companies = new Array(_len), _key = 0; _key < _len; _key++) {\n            landing_companies[_key] = arguments[_key];\n          }\n\n          return landing_companies.find(function (landing_company) {\n            return landing_company !== _this10.accounts[_this10.loginid].landing_company_shortcode && upgradeable_landing_companies.indexOf(landing_company) !== -1;\n          });\n        };\n\n        can_upgrade_to = canUpgrade('svg', 'iom', 'malta', 'maltainvest');\n\n        if (can_upgrade_to) {\n          type = can_upgrade_to === 'maltainvest' ? 'financial' : 'real';\n        }\n      }\n\n      return {\n        type: type,\n        can_upgrade: !!can_upgrade_to,\n        can_upgrade_to: can_upgrade_to,\n        can_open_multi: can_open_multi\n      };\n    }\n  }, {\n    key: \"setMT5DisabledSignupTypes\",\n    value: function setMT5DisabledSignupTypes(disabled_types_obj) {\n      var current_list = this.mt5_disabled_signup_types;\n      this.mt5_disabled_signup_types = _objectSpread(_objectSpread({}, current_list), disabled_types_obj);\n    }\n  }, {\n    key: \"setCFDDisabledSignupTypes\",\n    value: function setCFDDisabledSignupTypes(platform, disabled_types_obj) {\n      if (platform === _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE) {\n        var current_list = this.dxtrade_disabled_signup_types;\n        this.dxtrade_disabled_signup_types = _objectSpread({\n          current_list: current_list\n        }, disabled_types_obj);\n      }\n    }\n  }, {\n    key: \"getLimits\",\n    value: function getLimits() {\n      var _this11 = this;\n\n      return new Promise(function (resolve) {\n        Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.getLimits().then(function (data) {\n          (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n            if (data.error) {\n              _this11.account_limits = {\n                api_initial_load_error: data.error.message\n              };\n              resolve(data);\n            } else {\n              _this11.account_limits = _objectSpread(_objectSpread({}, data.get_limits), {}, {\n                is_loading: false\n              });\n              resolve(data);\n            }\n          });\n        });\n      });\n    }\n  }, {\n    key: \"setCookieAccount\",\n    value: function setCookieAccount() {\n      var domain = /deriv\\.(com|me)/.test(window.location.hostname) ? _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.deriv_urls.DERIV_HOST_NAME : 'binary.sx'; // eslint-disable-next-line max-len\n\n      var loginid = this.loginid,\n          email = this.email,\n          landing_company_shortcode = this.landing_company_shortcode,\n          currency = this.currency,\n          residence = this.residence,\n          account_settings = this.account_settings,\n          preferred_language = this.preferred_language,\n          user_id = this.user_id;\n      var first_name = account_settings.first_name,\n          last_name = account_settings.last_name,\n          name = account_settings.name;\n\n      if (loginid && email) {\n        var client_information = {\n          loginid: loginid,\n          email: email,\n          landing_company_shortcode: landing_company_shortcode,\n          currency: currency,\n          residence: residence,\n          first_name: first_name,\n          last_name: last_name,\n          name: name,\n          preferred_language: preferred_language,\n          user_id: user_id\n        };\n        js_cookie__WEBPACK_IMPORTED_MODULE_0___default().set('client_information', client_information, {\n          domain: domain\n        });\n        this.has_cookie_account = true;\n      } else {\n        js_cookie__WEBPACK_IMPORTED_MODULE_0___default().remove('client_information', {\n          domain: domain\n        });\n        this.has_cookie_account = false;\n      }\n    }\n  }, {\n    key: \"getSelfExclusion\",\n    value: function getSelfExclusion() {\n      var _this12 = this;\n\n      return new Promise(function (resolve) {\n        Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.getSelfExclusion().then(function (data) {\n          (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n            if (data.get_self_exclusion) {\n              _this12.self_exclusion = data.get_self_exclusion;\n            } else {\n              _this12.self_exclusion = false;\n            }\n\n            resolve(data);\n          });\n        });\n      });\n    }\n  }, {\n    key: \"updateSelfExclusion\",\n    value: function updateSelfExclusion(values) {\n      var _this13 = this;\n\n      return new Promise(function (resolve) {\n        Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.setSelfExclusion(values).then(function (data) {\n          if (!data.error) {\n            _this13.getSelfExclusion();\n          }\n\n          resolve(data);\n        });\n      });\n    }\n  }, {\n    key: \"responsePayoutCurrencies\",\n    value: function responsePayoutCurrencies(response) {\n      var list = response.payout_currencies || response;\n      this.currencies_list = (0,_Modules_Trading_Helpers_currency__WEBPACK_IMPORTED_MODULE_14__.buildCurrenciesList)(list);\n      this.selectCurrency('');\n    }\n  }, {\n    key: \"responseAuthorize\",\n    value: function responseAuthorize(response) {\n      this.accounts[this.loginid].email = response.authorize.email;\n      this.accounts[this.loginid].currency = response.authorize.currency;\n      this.accounts[this.loginid].is_virtual = +response.authorize.is_virtual;\n      this.accounts[this.loginid].session_start = parseInt(moment__WEBPACK_IMPORTED_MODULE_2___default()().utc().valueOf() / 1000);\n      this.accounts[this.loginid].landing_company_shortcode = response.authorize.landing_company_name;\n      this.accounts[this.loginid].country = response.country;\n      this.updateAccountList(response.authorize.account_list);\n      this.upgrade_info = this.getBasicUpgradeInfo();\n      this.user_id = response.authorize.user_id;\n      this.upgradeable_landing_companies = _toConsumableArray(new Set(response.authorize.upgradeable_landing_companies));\n      this.local_currency_config.currency = Object.keys(response.authorize.local_currencies)[0]; // For residences without local currency (e.g. ax)\n\n      var default_fractional_digits = 2;\n      this.local_currency_config.decimal_places = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(response.authorize.local_currencies) ? default_fractional_digits : +response.authorize.local_currencies[this.local_currency_config.currency].fractional_digits;\n    }\n  }, {\n    key: \"setWebsiteStatus\",\n    value: function setWebsiteStatus(response) {\n      this.website_status = response.website_status;\n      this.responseWebsiteStatus(response);\n      (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.setCurrencies)(this.website_status);\n    }\n  }, {\n    key: \"accountRealReaction\",\n    value: function () {\n      var _accountRealReaction = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(response) {\n        var _this14 = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", new Promise(function (resolve) {\n                  var _response$new_account;\n\n                  (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                    _this14.is_populating_account_list = true;\n                  });\n                  var client_accounts = JSON.parse(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.get(storage_key));\n\n                  var _ref2 = (_response$new_account = response.new_account_real) !== null && _response$new_account !== void 0 ? _response$new_account : response.new_account_maltainvest,\n                      oauth_token = _ref2.oauth_token,\n                      client_id = _ref2.client_id;\n\n                  _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().authorize(oauth_token).then(function (authorize_response) {\n                    var new_data = {};\n                    new_data.token = oauth_token;\n                    new_data.residence = authorize_response.authorize.country;\n                    new_data.currency = authorize_response.authorize.currency;\n                    new_data.is_virtual = authorize_response.authorize.is_virtual;\n                    new_data.landing_company_name = authorize_response.authorize.landing_company_fullname;\n                    new_data.landing_company_shortcode = authorize_response.authorize.landing_company_name;\n                    (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                      return client_accounts[client_id] = new_data;\n                    });\n\n                    _this14.setLoginInformation(client_accounts, client_id);\n\n                    Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.getSettings().then(function (get_settings_response) {\n                      _this14.setAccountSettings(get_settings_response.get_settings);\n\n                      resolve();\n                    });\n                  });\n                }));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function accountRealReaction(_x) {\n        return _accountRealReaction.apply(this, arguments);\n      }\n\n      return accountRealReaction;\n    }()\n  }, {\n    key: \"setLoginInformation\",\n    value: function setLoginInformation(client_accounts, client_id) {\n      this.setAccounts(client_accounts);\n      localStorage.setItem(storage_key, JSON.stringify(client_accounts));\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.set(storage_key, JSON.stringify(client_accounts));\n      this.is_populating_account_list = false;\n      this.upgrade_info = this.getBasicUpgradeInfo();\n      this.setSwitched(client_id);\n      this.syncWithLegacyPlatforms(client_id, client_accounts);\n    }\n  }, {\n    key: \"realAccountSignup\",\n    value: function () {\n      var _realAccountSignup = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(form_values) {\n        var DEFAULT_CRYPTO_ACCOUNT_CURRENCY, is_maltainvest_account, is_samoa_account, currency, response;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                DEFAULT_CRYPTO_ACCOUNT_CURRENCY = 'BTC';\n                is_maltainvest_account = this.root_store.ui.real_account_signup_target === 'maltainvest';\n                is_samoa_account = this.root_store.ui.real_account_signup_target === 'samoa';\n                currency = '';\n                form_values.residence = this.residence;\n\n                if (is_maltainvest_account) {\n                  currency = form_values.currency;\n                  form_values.accept_risk = form_values.accept_risk || 0;\n                  delete form_values.currency;\n                }\n\n                if (!is_maltainvest_account) {\n                  _context2.next = 12;\n                  break;\n                }\n\n                _context2.next = 9;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.newAccountRealMaltaInvest(form_values);\n\n              case 9:\n                _context2.t0 = _context2.sent;\n                _context2.next = 15;\n                break;\n\n              case 12:\n                _context2.next = 14;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.newAccountReal(form_values);\n\n              case 14:\n                _context2.t0 = _context2.sent;\n\n              case 15:\n                response = _context2.t0;\n\n                if (response.error) {\n                  _context2.next = 29;\n                  break;\n                }\n\n                _context2.next = 19;\n                return this.accountRealReaction(response);\n\n              case 19:\n                if (!is_maltainvest_account) {\n                  _context2.next = 22;\n                  break;\n                }\n\n                _context2.next = 22;\n                return this.setAccountCurrency(currency);\n\n              case 22:\n                if (!is_samoa_account) {\n                  _context2.next = 25;\n                  break;\n                }\n\n                _context2.next = 25;\n                return this.setAccountCurrency(DEFAULT_CRYPTO_ACCOUNT_CURRENCY);\n\n              case 25:\n                localStorage.removeItem('real_account_signup_wizard');\n                _context2.next = 28;\n                return this.root_store.gtm.pushDataLayer({\n                  event: 'real_signup'\n                });\n\n              case 28:\n                return _context2.abrupt(\"return\", Promise.resolve(_objectSpread(_objectSpread(_objectSpread({}, response), is_maltainvest_account ? {\n                  new_account_maltainvest: _objectSpread(_objectSpread({}, response.new_account_maltainvest), {}, {\n                    currency: currency\n                  })\n                } : {}), is_samoa_account ? {\n                  new_account_samoa: {\n                    currency: currency\n                  }\n                } : {})));\n\n              case 29:\n                return _context2.abrupt(\"return\", Promise.reject(response.error));\n\n              case 30:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function realAccountSignup(_x2) {\n        return _realAccountSignup.apply(this, arguments);\n      }\n\n      return realAccountSignup;\n    }()\n  }, {\n    key: \"setAccountCurrency\",\n    value: function () {\n      var _setAccountCurrency = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(currency) {\n        var response;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.setAccountCurrency(currency, {\n                  previous_currency: this.currency\n                });\n\n              case 2:\n                response = _context3.sent;\n\n                if (response.error) {\n                  _context3.next = 7;\n                  break;\n                }\n\n                _context3.next = 6;\n                return this.updateAccountCurrency(currency);\n\n              case 6:\n                return _context3.abrupt(\"return\", Promise.resolve(response));\n\n              case 7:\n                return _context3.abrupt(\"return\", Promise.reject(response.error));\n\n              case 8:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function setAccountCurrency(_x3) {\n        return _setAccountCurrency.apply(this, arguments);\n      }\n\n      return setAccountCurrency;\n    }()\n  }, {\n    key: \"updateAccountCurrency\",\n    value: function () {\n      var _updateAccountCurrency = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(currency) {\n        var _this15 = this;\n\n        var is_set_storage,\n            _args4 = arguments;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                is_set_storage = _args4.length > 1 && _args4[1] !== undefined ? _args4[1] : true;\n                (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                  var new_account = _objectSpread({}, _this15.accounts[_this15.loginid]);\n\n                  new_account.currency = currency;\n                  if (!('balance' in new_account)) new_account.balance = 0;\n                  _this15.accounts[_this15.loginid] = new_account;\n                });\n\n                if (is_set_storage) {\n                  localStorage.setItem(storage_key, JSON.stringify(this.accounts));\n                  _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.setObject(storage_key, JSON.parse(JSON.stringify(this.accounts)));\n                }\n\n                this.selectCurrency(currency);\n                this.root_store.ui.removeNotificationMessage({\n                  key: 'currency'\n                });\n                this.root_store.ui.removeNotificationByKey({\n                  key: 'currency'\n                });\n                _context4.next = 8;\n                return this.init();\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function updateAccountCurrency(_x4) {\n        return _updateAccountCurrency.apply(this, arguments);\n      }\n\n      return updateAccountCurrency;\n    }()\n  }, {\n    key: \"createCryptoAccount\",\n    value: function () {\n      var _createCryptoAccount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(currency) {\n        var residence, _this$account_setting, date_of_birth, first_name, last_name, data, response;\n\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                residence = this.residence;\n                _this$account_setting = this.account_settings, date_of_birth = _this$account_setting.date_of_birth, first_name = _this$account_setting.first_name, last_name = _this$account_setting.last_name;\n                data = {\n                  residence: residence,\n                  currency: currency,\n                  first_name: first_name,\n                  last_name: last_name,\n                  date_of_birth: (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.toMoment)(date_of_birth).format('YYYY-MM-DD')\n                };\n                _context5.next = 5;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.newAccountReal(data);\n\n              case 5:\n                response = _context5.sent;\n\n                if (response.error) {\n                  _context5.next = 10;\n                  break;\n                }\n\n                _context5.next = 9;\n                return this.accountRealReaction(response);\n\n              case 9:\n                return _context5.abrupt(\"return\", Promise.resolve(response));\n\n              case 10:\n                return _context5.abrupt(\"return\", Promise.reject(response.error));\n\n              case 11:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function createCryptoAccount(_x5) {\n        return _createCryptoAccount.apply(this, arguments);\n      }\n\n      return createCryptoAccount;\n    }()\n  }, {\n    key: \"residence\",\n    get: function get() {\n      if (this.is_logged_in) {\n        var _this$account_setting2;\n\n        return (_this$account_setting2 = this.account_settings.country_code) !== null && _this$account_setting2 !== void 0 ? _this$account_setting2 : '';\n      }\n\n      return '';\n    }\n  }, {\n    key: \"email_address\",\n    get: function get() {\n      if (this.accounts && this.accounts[this.loginid]) {\n        return this.accounts[this.loginid].email;\n      }\n\n      return '';\n    }\n  }, {\n    key: \"is_website_status_ready\",\n    get: function get() {\n      return this.website_status && !_common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().getAvailability().is_down;\n    }\n  }, {\n    key: \"updateAccountList\",\n    value: function updateAccountList(account_list) {\n      var _this16 = this;\n\n      account_list.forEach(function (account) {\n        if (_this16.accounts[account.loginid]) {\n          _this16.accounts[account.loginid].excluded_until = account.excluded_until || '';\n          Object.keys(account).forEach(function (param) {\n            var param_to_set = param === 'country' ? 'residence' : param;\n            var value_to_set = typeof account[param] === 'undefined' ? '' : account[param];\n\n            if (param_to_set !== 'loginid') {\n              _this16.accounts[account.loginid][param_to_set] = value_to_set;\n            }\n          });\n        }\n      });\n    }\n    /**\n     * Switch to the given loginid account.\n     *\n     * @param {string} loginid\n     */\n\n  }, {\n    key: \"switchAccount\",\n    value: function () {\n      var _switchAccount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6(loginid) {\n        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                this.setPreSwitchAccount(true);\n                this.setIsLoggingIn(true);\n                this.root_store.ui.removeNotifications(true);\n                this.root_store.ui.removeAllNotificationMessages(true);\n                this.setSwitched(loginid);\n                _context6.t0 = this;\n                _context6.next = 8;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.payoutCurrencies();\n\n              case 8:\n                _context6.t1 = _context6.sent;\n\n                _context6.t0.responsePayoutCurrencies.call(_context6.t0, _context6.t1);\n\n              case 10:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function switchAccount(_x6) {\n        return _switchAccount.apply(this, arguments);\n      }\n\n      return switchAccount;\n    }()\n  }, {\n    key: \"resetVirtualBalance\",\n    value: function () {\n      var _resetVirtualBalance = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {\n        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                this.root_store.ui.removeNotificationByKey({\n                  key: 'reset_virtual_balance'\n                });\n                this.root_store.ui.removeNotificationMessage({\n                  key: 'reset_virtual_balance',\n                  should_show_again: true\n                });\n                _context7.next = 4;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.topupVirtual();\n\n              case 4:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function resetVirtualBalance() {\n        return _resetVirtualBalance.apply(this, arguments);\n      }\n\n      return resetVirtualBalance;\n    }()\n  }, {\n    key: \"switchEndSignal\",\n    value: function switchEndSignal() {\n      this.switch_broadcast = false;\n    }\n  }, {\n    key: \"refreshNotifications\",\n    value: function refreshNotifications() {\n      this.root_store.ui.removeNotifications(true);\n      this.root_store.ui.removeAllNotificationMessages();\n      var client = this.accounts[this.loginid];\n\n      var _handleClientNotifica = (0,_Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_13__.handleClientNotifications)(client, this, this.root_store.ui, this.root_store.modules.cashier, this.root_store.common),\n          has_missing_required_field = _handleClientNotifica.has_missing_required_field;\n\n      this.setHasMissingRequiredField(has_missing_required_field);\n    }\n    /**\n     * We initially fetch things from local storage, and then do everything inside the store.\n     */\n\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(login_new_user) {\n        var _this17 = this;\n\n        var search, search_params, redirect_url, authorize_response, client, language, account_settings;\n        return regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                search = window.location.search;\n                search_params = new URLSearchParams(search);\n                redirect_url = search_params === null || search_params === void 0 ? void 0 : search_params.get('redirect_url');\n                this.setIsLoggingIn(true);\n                _context8.next = 6;\n                return this.setUserLogin(login_new_user);\n\n              case 6:\n                authorize_response = _context8.sent;\n                this.setDeviceData(); // On case of invalid token, no need to continue with additional api calls.\n\n                if (!(authorize_response !== null && authorize_response !== void 0 && authorize_response.error)) {\n                  _context8.next = 16;\n                  break;\n                }\n\n                _context8.next = 11;\n                return this.logout();\n\n              case 11:\n                this.root_store.common.setError(true, {\n                  header: authorize_response.error.message,\n                  message: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Please Log in'),\n                  should_show_refresh: false,\n                  redirect_label: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Log in'),\n                  redirectOnClick: function redirectOnClick() {\n                    return (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.redirectToLogin)(false, (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.getLanguage)());\n                  }\n                });\n                this.setIsLoggingIn(false);\n                this.setInitialized(false);\n                this.setSwitched('');\n                return _context8.abrupt(\"return\", false);\n\n              case 16:\n                this.setLoginId(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.get('active_loginid'));\n                this.setAccounts(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.getObject(storage_key));\n                this.setSwitched('');\n                client = this.accounts[this.loginid]; // If there is an authorize_response, it means it was the first login\n\n                if (!authorize_response) {\n                  _context8.next = 35;\n                  break;\n                }\n\n                if (!(this.loginid === authorize_response.authorize.loginid)) {\n                  _context8.next = 29;\n                  break;\n                }\n\n                Services_socket_general__WEBPACK_IMPORTED_MODULE_6__.default.authorizeAccount(authorize_response); // Client comes back from oauth and logs in\n\n                _context8.next = 25;\n                return this.root_store.rudderstack.identifyEvent();\n\n              case 25:\n                _context8.next = 27;\n                return this.root_store.gtm.pushDataLayer({\n                  event: 'login'\n                });\n\n              case 27:\n                _context8.next = 31;\n                break;\n\n              case 29:\n                _context8.next = 31;\n                return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().authorize(client.token);\n\n              case 31:\n                if (redirect_url) {\n                  window.location.replace((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.urlFor)(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.routes[redirect_url], {\n                    query_string: search\n                  }));\n                }\n\n                (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                  _this17.is_populating_account_list = false;\n                });\n                language = authorize_response.authorize.preferred_language;\n\n                if (language !== 'EN' && language !== _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.get(LANGUAGE_KEY)) {\n                  window.location.replace((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.urlForLanguage)(authorize_response.authorize.preferred_language));\n                }\n\n              case 35:\n                /**\n                 * Set up reaction for account_settings, account_status, is_p2p_visible\n                 */\n                (0,mobx__WEBPACK_IMPORTED_MODULE_1__.reaction)(function () {\n                  var _this17$root_store$mo, _this17$root_store$mo2, _this17$root_store$co;\n\n                  return [_this17.account_settings, _this17.account_status, (_this17$root_store$mo = _this17.root_store.modules) === null || _this17$root_store$mo === void 0 ? void 0 : (_this17$root_store$mo2 = _this17$root_store$mo.cashier) === null || _this17$root_store$mo2 === void 0 ? void 0 : _this17$root_store$mo2.is_p2p_visible, (_this17$root_store$co = _this17.root_store.common) === null || _this17$root_store$co === void 0 ? void 0 : _this17$root_store$co.selected_contract_type, _this17.is_eu];\n                }, function () {\n                  client = _this17.accounts[_this17.loginid];\n                  _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().wait('landing_company').then(function () {\n                    _this17.root_store.ui.removeNotifications();\n\n                    _this17.root_store.ui.removeAllNotificationMessages();\n\n                    var _handleClientNotifica2 = (0,_Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_13__.handleClientNotifications)(client, _this17, _this17.root_store.ui, _this17.root_store.modules.cashier, _this17.root_store.common),\n                        has_missing_required_field = _handleClientNotifica2.has_missing_required_field;\n\n                    if (client && !client.is_virtual) {\n                      _this17.setHasMissingRequiredField(has_missing_required_field);\n                    }\n                  });\n                });\n                this.selectCurrency('');\n                _context8.t0 = this;\n                _context8.next = 40;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.payoutCurrencies();\n\n              case 40:\n                _context8.t1 = _context8.sent;\n\n                _context8.t0.responsePayoutCurrencies.call(_context8.t0, _context8.t1);\n\n                if (!this.is_logged_in) {\n                  _context8.next = 66;\n                  break;\n                }\n\n                Services__WEBPACK_IMPORTED_MODULE_5__.WS.storage.mt5LoginList().then(this.responseMt5LoginList);\n                Services__WEBPACK_IMPORTED_MODULE_5__.WS.tradingServers(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.MT5).then(this.responseMT5TradingServers);\n                Services__WEBPACK_IMPORTED_MODULE_5__.WS.tradingPlatformAccountsList(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE).then(this.responseTradingPlatformAccountsList);\n                Services__WEBPACK_IMPORTED_MODULE_5__.WS.tradingServers(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE).then(this.responseDxtradeTradingServers);\n                _context8.t2 = this;\n                _context8.next = 50;\n                return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().send({\n                  statement: 1\n                });\n\n              case 50:\n                _context8.t3 = _context8.sent;\n\n                _context8.t2.responseStatement.call(_context8.t2, _context8.t3);\n\n                _context8.next = 54;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.cache.getSettings();\n\n              case 54:\n                account_settings = _context8.sent.get_settings;\n                if (account_settings) this.setPreferredLanguage(account_settings.preferred_language);\n                _context8.next = 58;\n                return this.fetchResidenceList();\n\n              case 58:\n                if (account_settings && !account_settings.residence) {\n                  this.root_store.ui.toggleSetResidenceModal(true);\n                }\n\n                _context8.next = 61;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.cache.landingCompany(this.residence).then(this.responseLandingCompany);\n\n              case 61:\n                if (this.is_virtual) {\n                  _context8.next = 64;\n                  break;\n                }\n\n                _context8.next = 64;\n                return this.getLimits();\n\n              case 64:\n                _context8.next = 67;\n                break;\n\n              case 66:\n                this.resetMt5AccountListPopulation();\n\n              case 67:\n                _context8.t4 = this;\n                _context8.next = 70;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.wait('website_status');\n\n              case 70:\n                _context8.t5 = _context8.sent;\n\n                _context8.t4.responseWebsiteStatus.call(_context8.t4, _context8.t5);\n\n                this.registerReactions();\n                this.setIsLoggingIn(false);\n                this.setInitialized(true);\n                return _context8.abrupt(\"return\", true);\n\n              case 76:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function init(_x7) {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"resetMt5AccountListPopulation\",\n    value: function resetMt5AccountListPopulation() {\n      this.is_populating_mt5_account_list = false;\n    }\n  }, {\n    key: \"responseWebsiteStatus\",\n    value: function responseWebsiteStatus(response) {\n      this.website_status = response.website_status;\n\n      if (this.website_status.message && this.website_status.message.length) {\n        this.root_store.ui.addNotificationMessage({\n          key: 'maintenance',\n          header: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Site is being updated'),\n          message: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)(this.website_status.message),\n          type: 'warning',\n          is_persistent: true\n        });\n      } else {\n        this.root_store.ui.removeNotificationMessage({\n          key: 'maintenance'\n        });\n      }\n    }\n  }, {\n    key: \"responseLandingCompany\",\n    value: function responseLandingCompany(response) {\n      this.is_landing_company_loaded = true;\n      this.landing_companies = response.landing_company;\n      this.setStandpoint(this.landing_companies);\n      this.setRealityCheck();\n    }\n  }, {\n    key: \"setStandpoint\",\n    value: function setStandpoint(landing_companies) {\n      if (!landing_companies) return;\n      var gaming_company = landing_companies.gaming_company,\n          financial_company = landing_companies.financial_company;\n\n      if (gaming_company !== null && gaming_company !== void 0 && gaming_company.shortcode) {\n        var _gaming_company$short, _objectSpread2;\n\n        this.standpoint = _objectSpread(_objectSpread({}, this.standpoint), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, gaming_company.shortcode, !!(gaming_company !== null && gaming_company !== void 0 && gaming_company.shortcode)), _defineProperty(_objectSpread2, \"gaming_company\", (_gaming_company$short = gaming_company === null || gaming_company === void 0 ? void 0 : gaming_company.shortcode) !== null && _gaming_company$short !== void 0 ? _gaming_company$short : false), _objectSpread2));\n      }\n\n      if (financial_company !== null && financial_company !== void 0 && financial_company.shortcode) {\n        var _financial_company$sh, _objectSpread3;\n\n        this.standpoint = _objectSpread(_objectSpread({}, this.standpoint), {}, (_objectSpread3 = {}, _defineProperty(_objectSpread3, financial_company.shortcode, !!(financial_company !== null && financial_company !== void 0 && financial_company.shortcode)), _defineProperty(_objectSpread3, \"financial_company\", (_financial_company$sh = financial_company === null || financial_company === void 0 ? void 0 : financial_company.shortcode) !== null && _financial_company$sh !== void 0 ? _financial_company$sh : false), _objectSpread3));\n      }\n    }\n  }, {\n    key: \"setRealityCheck\",\n    value: function setRealityCheck() {\n      var _this$current_landing;\n\n      this.has_reality_check = (_this$current_landing = this.current_landing_company) === null || _this$current_landing === void 0 ? void 0 : _this$current_landing.has_reality_check; // if page reloaded after reality check was submitted\n      // use the submitted values to initiate rather than asking again\n\n      if (this.has_reality_check && this.reality_check_duration && typeof this.reality_check_timeout === 'undefined') {\n        this.setRealityCheckDuration(this.reality_check_duration);\n      }\n    }\n  }, {\n    key: \"setLoginId\",\n    value: function setLoginId(loginid) {\n      this.loginid = loginid;\n    }\n  }, {\n    key: \"setAccounts\",\n    value: function setAccounts(accounts) {\n      this.accounts = accounts;\n    }\n  }, {\n    key: \"setSwitched\",\n    value: function setSwitched(switched) {\n      this.switched = switched;\n    }\n  }, {\n    key: \"setHasMissingRequiredField\",\n    value: function setHasMissingRequiredField(has_missing_required_field) {\n      this.has_missing_required_field = has_missing_required_field;\n    }\n    /**\n     * Check if account is disabled or not\n     *\n     * @param loginid\n     * @returns {string}\n     */\n\n  }, {\n    key: \"isDisabled\",\n    value: function isDisabled() {\n      var loginid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.loginid;\n      return this.getAccount(loginid).is_disabled;\n    }\n    /**\n     * Get accounts token from given login id.\n     *\n     * @param loginid\n     * @returns {string}\n     */\n\n  }, {\n    key: \"getToken\",\n    value: function getToken() {\n      var loginid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.loginid;\n      return this.getAccount(loginid).token;\n    }\n    /**\n     * Get account object from given login id\n     *\n     * @param loginid\n     * @returns {object}\n     */\n\n  }, {\n    key: \"getAccount\",\n    value: function getAccount() {\n      var loginid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.loginid;\n      return this.accounts[loginid];\n    }\n    /**\n     * Get information required by account switcher\n     *\n     * @param loginid\n     * @returns {{loginid: *, is_virtual: (number|number|*), icon: string, title: *}}\n     */\n\n  }, {\n    key: \"getAccountInfo\",\n    value: function getAccountInfo() {\n      var loginid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.loginid;\n      var account = this.getAccount(loginid);\n      var currency = account.currency;\n      var is_disabled = account.is_disabled;\n      var is_virtual = account.is_virtual;\n      var account_type = !is_virtual && currency ? currency : this.account_title;\n      return {\n        loginid: loginid,\n        is_disabled: is_disabled,\n        is_virtual: is_virtual,\n        icon: account_type.toLowerCase(),\n        // TODO: display the icon\n        title: account_type.toLowerCase() === 'virtual' ? (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('DEMO') : account_type\n      };\n    }\n  }, {\n    key: \"setIsLoggingIn\",\n    value: function setIsLoggingIn(bool) {\n      this.is_logging_in = bool;\n    }\n  }, {\n    key: \"setPreSwitchAccount\",\n    value: function setPreSwitchAccount(is_pre_switch) {\n      this.pre_switch_broadcast = is_pre_switch;\n    }\n  }, {\n    key: \"broadcastAccountChange\",\n    value: function broadcastAccountChange() {\n      this.switch_broadcast = true;\n    }\n  }, {\n    key: \"broadcastAccountChangeAfterAuthorize\",\n    value: function broadcastAccountChangeAfterAuthorize() {\n      var _this18 = this;\n\n      return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().wait('authorize').then(function () {\n        _this18.broadcastAccountChange();\n      });\n    }\n  }, {\n    key: \"handleNotFoundLoginId\",\n    value: function handleNotFoundLoginId() {\n      // Logout if the switched_account doesn't belong to any loginid.\n      this.root_store.ui.addNotificationMessage({\n        message: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Could not switch to default account.'),\n        type: 'danger'\n      }); // request a logout\n\n      this.logout();\n    }\n  }, {\n    key: \"isUnableToFindLoginId\",\n    value: function isUnableToFindLoginId() {\n      var _this19 = this;\n\n      return !this.all_loginids.some(function (id) {\n        return id !== _this19.switched;\n      }) || this.switched === this.loginid;\n    }\n  }, {\n    key: \"switchAccountHandler\",\n    value: function () {\n      var _switchAccountHandler = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee9() {\n        var _this$getAccount,\n            _this20 = this;\n\n        var from_login_id, should_switch_socket_connection;\n        return regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                if (!(!this.switched || !this.switched.length || !((_this$getAccount = this.getAccount(this.switched)) !== null && _this$getAccount !== void 0 && _this$getAccount.token))) {\n                  _context9.next = 9;\n                  break;\n                }\n\n                if (!this.isUnableToFindLoginId()) {\n                  _context9.next = 4;\n                  break;\n                }\n\n                this.handleNotFoundLoginId();\n                return _context9.abrupt(\"return\");\n\n              case 4:\n                // Send a toast message to let the user know we can't switch his account.\n                this.root_store.ui.addNotificationMessage({\n                  message: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Switching to default account.'),\n                  type: 'info'\n                }); // switch to default account.\n\n                this.switchAccount(this.all_loginids[0]);\n                _context9.next = 8;\n                return this.switchAccountHandler();\n\n              case 8:\n                return _context9.abrupt(\"return\");\n\n              case 9:\n                (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                  return _this20.is_switching = true;\n                });\n                from_login_id = this.loginid;\n                this.resetLocalStorageValues(this.switched);\n                _common_base_socket_cache__WEBPACK_IMPORTED_MODULE_8__.clear(); // if real to virtual --> switch to blue\n                // if virtual to real --> switch to green\n                // else keep the existing connection\n\n                should_switch_socket_connection = this.is_virtual || /VRTC/.test(from_login_id);\n\n                if (!should_switch_socket_connection) {\n                  _context9.next = 20;\n                  break;\n                }\n\n                _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().closeAndOpenNewConnection();\n                _context9.next = 18;\n                return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().wait('authorize');\n\n              case 18:\n                _context9.next = 24;\n                break;\n\n              case 20:\n                _context9.next = 22;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.forgetAll('balance');\n\n              case 22:\n                _context9.next = 24;\n                return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().authorize(this.getToken());\n\n              case 24:\n                if (this.root_store.common.has_error) this.root_store.common.setError(false, null);\n                sessionStorage.setItem('active_tab', '1'); // set local storage\n\n                this.root_store.gtm.setLoginFlag();\n                _context9.next = 29;\n                return this.init();\n\n              case 29:\n                // broadcastAccountChange is already called after new connection is authorized\n                if (!should_switch_socket_connection) this.broadcastAccountChange();\n                if (!this.is_virtual) this.getLimits();\n                (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                  return _this20.is_switching = false;\n                });\n\n              case 32:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function switchAccountHandler() {\n        return _switchAccountHandler.apply(this, arguments);\n      }\n\n      return switchAccountHandler;\n    }()\n  }, {\n    key: \"registerReactions\",\n    value: function registerReactions() {\n      var _this21 = this;\n\n      // Switch account reactions.\n      (0,mobx__WEBPACK_IMPORTED_MODULE_1__.when)(function () {\n        return _this21.switched;\n      }, function () {\n        var _this21$accounts$_thi;\n\n        // Remove real account notifications upon switching to virtual\n        if ((_this21$accounts$_thi = _this21.accounts[_this21.switched]) !== null && _this21$accounts$_thi !== void 0 && _this21$accounts$_thi.is_virtual) {\n          _this21.root_store.ui.removeNotifications(true);\n\n          _this21.root_store.ui.removeAllNotificationMessages();\n        }\n\n        _this21.switchAccountHandler();\n      });\n    }\n  }, {\n    key: \"resetVirtualBalanceNotification\",\n    value: function resetVirtualBalanceNotification(loginid) {\n      if (!this.is_logged_in) return;\n      if (!this.accounts[loginid].is_virtual) return;\n      var min_reset_limit = 1000;\n      var max_reset_limit = 999000;\n      var balance = parseInt(this.accounts[loginid].balance); // Display notification message to user with virtual account to reset their balance\n      // if the balance is less than equals to 1000 or more than equals to 999000\n\n      if (balance <= min_reset_limit || balance >= max_reset_limit) {\n        var message = (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Your demo account balance is low. Reset your balance to continue trading from your demo account.');\n        if (balance >= max_reset_limit) message = (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Your demo account balance has reached the maximum limit, and you will not be able to place new trades. Reset your balance to continue trading from your demo account.');\n        this.root_store.ui.addNotificationMessage((0,_Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_13__.clientNotifications)({}, {\n          resetVirtualBalance: this.resetVirtualBalance,\n          message: message\n        }).reset_virtual_balance);\n      } else {\n        this.root_store.ui.removeNotificationByKey({\n          key: 'reset_virtual_balance'\n        });\n        this.root_store.ui.removeNotificationMessage({\n          key: 'reset_virtual_balance',\n          should_show_again: true\n        });\n      }\n    }\n  }, {\n    key: \"setBalanceActiveAccount\",\n    value: function setBalanceActiveAccount(obj_balance) {\n      if (this.accounts[obj_balance === null || obj_balance === void 0 ? void 0 : obj_balance.loginid] && obj_balance.loginid === this.loginid) {\n        this.accounts[obj_balance.loginid].balance = obj_balance.balance;\n\n        if (this.accounts[obj_balance.loginid].is_virtual) {\n          this.resetVirtualBalanceNotification(obj_balance.loginid);\n        }\n\n        this.resetLocalStorageValues(this.loginid);\n      }\n    } // This callback is used for balance: all\n    // Balance: all is very slow\n    // --> so we keep a separate balance subscription for the active account\n\n  }, {\n    key: \"setBalanceOtherAccounts\",\n    value: function setBalanceOtherAccounts(obj_balance) {\n      var _this$root_store$modu,\n          _this$root_store$modu2,\n          _this22 = this;\n\n      // Balance subscription response received when mt5 transfer is in progress should be ignored.\n      // After mt5 transfer is done, `balanceAll` is requested along with `mt5LoginList` in order to update the correct balance.\n      if ((_this$root_store$modu = this.root_store.modules) !== null && _this$root_store$modu !== void 0 && (_this$root_store$modu2 = _this$root_store$modu.cashier) !== null && _this$root_store$modu2 !== void 0 && _this$root_store$modu2.isMT5TransferInProgress()) return; // Only the first response of balance:all will include all accounts\n      // subsequent requests will be single account balance updates\n\n      if (this.accounts[obj_balance === null || obj_balance === void 0 ? void 0 : obj_balance.loginid] && !obj_balance.accounts && obj_balance.loginid !== this.loginid) {\n        this.accounts[obj_balance.loginid].balance = obj_balance.balance;\n      }\n\n      if (this.accounts[obj_balance === null || obj_balance === void 0 ? void 0 : obj_balance.loginid] && obj_balance.accounts) {\n        Object.keys(obj_balance.accounts).forEach(function (account_id) {\n          var is_active_account_id = account_id === _this22.loginid;\n\n          if (!is_active_account_id && _this22.accounts[account_id]) {\n            _this22.accounts[account_id].balance = +obj_balance.accounts[account_id].balance;\n          }\n        });\n      }\n\n      if (obj_balance.total) {\n        var total_real = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.getPropertyValue)(obj_balance, ['total', 'deriv']);\n        var total_mt5 = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.getPropertyValue)(obj_balance, ['total', _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.MT5]);\n        var total_dxtrade = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.getPropertyValue)(obj_balance, ['total', _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE]); // in API streaming responses MT5 balance is not re-sent, so we need to reuse the first mt5 total sent\n\n        var has_mt5 = !(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(total_mt5);\n        var has_dxtrade = !(0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(total_dxtrade);\n        this.obj_total_balance = {\n          amount_real: +total_real.amount,\n          amount_mt5: has_mt5 ? +total_mt5.amount : this.obj_total_balance.amount_mt5,\n          amount_dxtrade: has_dxtrade ? +total_dxtrade.amount : this.obj_total_balance.amount_dxtrade,\n          currency: total_real.currency\n        };\n      }\n    }\n  }, {\n    key: \"selectCurrency\",\n    value: function selectCurrency(value) {\n      this.selected_currency = value;\n    }\n  }, {\n    key: \"setResidence\",\n    value: function setResidence(residence) {\n      this.accounts[this.loginid].residence = residence;\n    }\n  }, {\n    key: \"setEmail\",\n    value: function setEmail(email) {\n      this.accounts[this.loginid].email = email;\n      this.email = email;\n    }\n  }, {\n    key: \"setAccountSettings\",\n    value: function setAccountSettings(settings) {\n      this.account_settings = settings;\n      this.is_account_setting_loaded = true;\n    }\n  }, {\n    key: \"setAccountStatus\",\n    value: function setAccountStatus(status) {\n      this.account_status = status;\n    }\n  }, {\n    key: \"setInitialized\",\n    value: function setInitialized(is_initialized) {\n      this.initialized_broadcast = is_initialized;\n    }\n  }, {\n    key: \"cleanUp\",\n    value: function cleanUp() {\n      var _this23 = this;\n\n      this.root_store.gtm.pushDataLayer({\n        event: 'log_out'\n      });\n      this.loginid = null;\n      this.user_id = null;\n      this.upgrade_info = undefined;\n      this.accounts = {};\n      this.mt5_login_list = [];\n      this.landing_companies = {};\n      localStorage.setItem('active_loginid', this.loginid);\n      localStorage.setItem('client.accounts', JSON.stringify(this.accounts));\n      (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee10() {\n        return regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.t0 = _this23;\n                _context10.next = 3;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.payoutCurrencies();\n\n              case 3:\n                _context10.t1 = _context10.sent;\n\n                _context10.t0.responsePayoutCurrencies.call(_context10.t0, _context10.t1);\n\n              case 5:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10);\n      })));\n      this.root_store.ui.removeAllNotificationMessages(true);\n      this.syncWithLegacyPlatforms(this.loginid, this.accounts);\n      this.cleanupRealityCheck();\n    }\n  }, {\n    key: \"logout\",\n    value: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee11() {\n        var response;\n        return regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return (0,Services__WEBPACK_IMPORTED_MODULE_5__.requestLogout)();\n\n              case 2:\n                response = _context11.sent;\n\n                if (response.logout === 1) {\n                  this.cleanUp();\n                  this.root_store.rudderstack.reset();\n                  this.setLogout(true);\n                }\n\n                return _context11.abrupt(\"return\", response);\n\n              case 5:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }, {\n    key: \"setLogout\",\n    value: function setLogout(is_logged_out) {\n      this.has_logged_out = is_logged_out;\n      if (this.root_store.common.has_error) this.root_store.common.setError(false, null);\n    }\n    /* eslint-disable */\n\n  }, {\n    key: \"storeClientAccounts\",\n    value: function storeClientAccounts(obj_params, account_list) {\n      // store consistent names with other API calls\n      // API_V4: send consistent names\n      var map_names = {\n        country: 'residence',\n        landing_company_name: 'landing_company_shortcode'\n      };\n      var client_object = {};\n      var active_loginid;\n\n      if (obj_params.selected_acct) {\n        active_loginid = obj_params.selected_acct;\n      }\n\n      account_list.forEach(function (account) {\n        Object.keys(account).forEach(function (param) {\n          if (param === 'loginid') {\n            if (!active_loginid && !account.is_disabled) {\n              if (!account.is_virtual) {\n                active_loginid = account[param];\n              } else if (account.is_virtual) {\n                // TODO: [only_virtual] remove this to stop logging non-SVG clients into virtual\n                active_loginid = account[param];\n              }\n            }\n          } else {\n            var param_to_set = map_names[param] || param;\n            var value_to_set = typeof account[param] === 'undefined' ? '' : account[param];\n\n            if (!(account.loginid in client_object)) {\n              client_object[account.loginid] = {};\n            }\n\n            client_object[account.loginid][param_to_set] = value_to_set;\n          }\n        });\n      });\n      var i = 1;\n\n      while (obj_params[\"acct\".concat(i)]) {\n        var loginid = obj_params[\"acct\".concat(i)];\n        var token = obj_params[\"token\".concat(i)];\n\n        if (loginid && token) {\n          client_object[loginid].token = token;\n        }\n\n        i++;\n      } // if didn't find any login ID that matched the above condition\n      // or the selected one doesn't have a token, set the first one\n\n\n      if (!active_loginid || !client_object[active_loginid].token) {\n        active_loginid = obj_params.acct1;\n      } // TODO: send login flag to GTM if needed\n\n\n      if (active_loginid && Object.keys(client_object).length) {\n        localStorage.setItem('active_loginid', active_loginid);\n        localStorage.setItem('client.accounts', JSON.stringify(client_object));\n        this.syncWithLegacyPlatforms(active_loginid, this.accounts);\n      }\n    }\n  }, {\n    key: \"setUserLogin\",\n    value: function () {\n      var _setUserLogin = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee12(login_new_user) {\n        var _this24 = this;\n\n        var obj_params, search, _search_params, search_params, search_param_without_account, is_client_logging_in, authorize_response;\n\n        return regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                // login_new_user is populated only on virtual sign-up\n                obj_params = {};\n                search = window.location.search;\n\n                if (search) {\n                  search_params = new URLSearchParams(window.location.search);\n                  search_params.forEach(function (value, key) {\n                    var account_keys = ['acct', 'token', 'cur'];\n                    var is_account_param = account_keys.some(function (account_key) {\n                      return (key === null || key === void 0 ? void 0 : key.includes(account_key)) && key !== 'affiliate_token';\n                    });\n\n                    if (is_account_param) {\n                      obj_params[key] = value;\n                    }\n                  }); // delete account query params - but keep other query params (e.g. utm)\n\n                  Object.keys(obj_params).forEach(function (key) {\n                    return search_params[\"delete\"](key);\n                  });\n                  search_params[\"delete\"]('state'); // remove unused state= query string\n\n                  search_params = (_search_params = search_params) === null || _search_params === void 0 ? void 0 : _search_params.toString();\n                  search_param_without_account = search_params ? \"?\".concat(search_params) : '/';\n                  history.replaceState(null, null, \"\".concat(search_param_without_account).concat(window.location.hash));\n                }\n\n                is_client_logging_in = login_new_user ? login_new_user.token1 : obj_params.token1;\n\n                if (!is_client_logging_in) {\n                  _context12.next = 16;\n                  break;\n                }\n\n                window.history.replaceState({}, document.title, sessionStorage.getItem('redirect_url'));\n                _common_base_socket_cache__WEBPACK_IMPORTED_MODULE_8__.clear(); // is_populating_account_list is used for socket general to know not to filter the first-time logins\n\n                this.is_populating_account_list = true;\n                _context12.next = 10;\n                return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().authorize(is_client_logging_in);\n\n              case 10:\n                authorize_response = _context12.sent;\n\n                if (login_new_user) {\n                  // overwrite obj_params if login is for new virtual account\n                  obj_params = login_new_user;\n                }\n\n                if (!authorize_response.error) {\n                  _context12.next = 14;\n                  break;\n                }\n\n                return _context12.abrupt(\"return\", authorize_response);\n\n              case 14:\n                (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                  var account_list = (authorize_response.authorize || {}).account_list;\n                  _this24.upgradeable_landing_companies = _toConsumableArray(new Set(authorize_response.upgradeable_landing_companies));\n\n                  if (_this24.canStoreClientAccounts(obj_params, account_list)) {\n                    _this24.storeClientAccounts(obj_params, account_list);\n                  } else {\n                    // Since there is no API error, we have to add this to manually trigger checks in other parts of the code.\n                    authorize_response.error = {\n                      code: 'MismatchedAcct',\n                      message: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_4__.localize)('Invalid token')\n                    };\n                  }\n                });\n                return _context12.abrupt(\"return\", authorize_response);\n\n              case 16:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function setUserLogin(_x8) {\n        return _setUserLogin.apply(this, arguments);\n      }\n\n      return setUserLogin;\n    }()\n  }, {\n    key: \"canStoreClientAccounts\",\n    value: function canStoreClientAccounts(obj_params, account_list) {\n      var is_ready_to_process = account_list && (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(this.accounts);\n      var accts = Object.keys(obj_params).filter(function (value) {\n        return /^acct./.test(value);\n      });\n      var is_cross_checked = accts.every(function (acct) {\n        return account_list.some(function (account) {\n          return account.loginid === obj_params[acct];\n        });\n      });\n      return is_ready_to_process && is_cross_checked;\n    }\n  }, {\n    key: \"setVerificationCode\",\n    value: function setVerificationCode(code, action) {\n      this.verification_code[action] = code;\n\n      if (code) {\n        _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.set(\"verification_code.\".concat(action), code);\n      } else {\n        _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.remove(\"verification_code.\".concat(action));\n      }\n\n      if (action === 'signup') {\n        // TODO: add await if error handling needs to happen before AccountSignup is initialised\n        this.fetchResidenceList(); // Prefetch for use in account signup process\n      }\n    }\n  }, {\n    key: \"setDeviceData\",\n    value: function setDeviceData() {\n      (0,_Helpers_device__WEBPACK_IMPORTED_MODULE_12__.setDeviceDataCookie)('signup_device', (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isDesktopOs)() ? 'desktop' : 'mobile');\n    }\n  }, {\n    key: \"getSignupParams\",\n    value: function getSignupParams() {\n      var param_list = ['date_first_contact', 'signup_device', 'gclid_url', 'utm_source', 'utm_ad_id', 'utm_adgroup_id', 'utm_adrollclk_id', 'utm_campaign_id', 'utm_campaign', 'utm_fbcl_id', 'utm_gl_client_id', 'utm_msclk_id', 'utm_medium', 'utm_term', 'utm_content', 'affiliate_token'];\n      var signup_params = {};\n      var url_params = new URLSearchParams(window.location.search);\n      param_list.forEach(function (key) {\n        if (url_params.get(key)) {\n          signup_params[key] = url_params.get(key);\n        }\n      });\n      return signup_params;\n    }\n  }, {\n    key: \"onSetResidence\",\n    value: function onSetResidence(_ref4, cb) {\n      var _this25 = this;\n\n      var residence = _ref4.residence;\n      if (!residence) return;\n      Services__WEBPACK_IMPORTED_MODULE_5__.WS.setSettings({\n        residence: residence\n      }).then( /*#__PURE__*/function () {\n        var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee15(response) {\n          return regeneratorRuntime.wrap(function _callee15$(_context15) {\n            while (1) {\n              switch (_context15.prev = _context15.next) {\n                case 0:\n                  if (!response.error) {\n                    _context15.next = 4;\n                    break;\n                  }\n\n                  cb(response.error.message);\n                  _context15.next = 12;\n                  break;\n\n                case 4:\n                  _context15.next = 6;\n                  return _this25.setResidence(residence);\n\n                case 6:\n                  _context15.next = 8;\n                  return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.landingCompany(_this25.accounts[_this25.loginid].residence).then(_this25.responseLandingCompany);\n\n                case 8:\n                  _context15.next = 10;\n                  return Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.getSettings().then( /*#__PURE__*/function () {\n                    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee13(response) {\n                      return regeneratorRuntime.wrap(function _callee13$(_context13) {\n                        while (1) {\n                          switch (_context13.prev = _context13.next) {\n                            case 0:\n                              _this25.setAccountSettings(response.get_settings);\n\n                            case 1:\n                            case \"end\":\n                              return _context13.stop();\n                          }\n                        }\n                      }, _callee13);\n                    }));\n\n                    return function (_x10) {\n                      return _ref6.apply(this, arguments);\n                    };\n                  }());\n\n                case 10:\n                  (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee14() {\n                    return regeneratorRuntime.wrap(function _callee14$(_context14) {\n                      while (1) {\n                        switch (_context14.prev = _context14.next) {\n                          case 0:\n                            _context14.next = 2;\n                            return _common_base_socket_base__WEBPACK_IMPORTED_MODULE_7___default().authorize(_this25.getToken()).then(function () {\n                              (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                                return _this25.upgrade_info = _this25.getBasicUpgradeInfo();\n                              });\n                            });\n\n                          case 2:\n                          case \"end\":\n                            return _context14.stop();\n                        }\n                      }\n                    }, _callee14);\n                  })));\n                  cb();\n\n                case 12:\n                case \"end\":\n                  return _context15.stop();\n              }\n            }\n          }, _callee15);\n        }));\n\n        return function (_x9) {\n          return _ref5.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"onSignup\",\n    value: function onSignup(_ref8, cb) {\n      var _this26 = this;\n\n      var password = _ref8.password,\n          residence = _ref8.residence,\n          email_consent = _ref8.email_consent;\n      if (!this.verification_code.signup || !password || !residence) return;\n      if (email_consent === undefined) return;\n      email_consent = email_consent ? 1 : 0;\n      Services__WEBPACK_IMPORTED_MODULE_5__.WS.newAccountVirtual(this.verification_code.signup, password, residence, email_consent, this.getSignupParams()).then( /*#__PURE__*/function () {\n        var _ref9 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee16(response) {\n          var _response$new_account2, client_id, currency, oauth_token;\n\n          return regeneratorRuntime.wrap(function _callee16$(_context16) {\n            while (1) {\n              switch (_context16.prev = _context16.next) {\n                case 0:\n                  if (!response.error) {\n                    _context16.next = 4;\n                    break;\n                  }\n\n                  cb(response.error.message);\n                  _context16.next = 10;\n                  break;\n\n                case 4:\n                  cb(); // Initialize client store with new user login\n\n                  _response$new_account2 = response.new_account_virtual, client_id = _response$new_account2.client_id, currency = _response$new_account2.currency, oauth_token = _response$new_account2.oauth_token;\n                  _context16.next = 8;\n                  return _this26.switchToNewlyCreatedAccount(client_id, oauth_token, currency);\n\n                case 8:\n                  // GTM Signup event\n                  _this26.root_store.gtm.pushDataLayer({\n                    event: 'virtual_signup'\n                  });\n\n                  if (!_this26.country_standpoint.is_france && !_this26.country_standpoint.is_belgium && residence !== 'im') {\n                    _this26.root_store.ui.toggleWelcomeModal({\n                      is_visible: true,\n                      should_persist: true\n                    });\n                  }\n\n                case 10:\n                case \"end\":\n                  return _context16.stop();\n              }\n            }\n          }, _callee16);\n        }));\n\n        return function (_x11) {\n          return _ref9.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"switchToNewlyCreatedAccount\",\n    value: function () {\n      var _switchToNewlyCreatedAccount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee17(client_id, oauth_token, currency) {\n        var new_user_login;\n        return regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                this.setPreSwitchAccount(true);\n                new_user_login = {\n                  acct1: client_id,\n                  token1: oauth_token,\n                  curr1: currency\n                };\n                _context17.next = 4;\n                return this.init(new_user_login);\n\n              case 4:\n                this.broadcastAccountChange();\n\n              case 5:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      function switchToNewlyCreatedAccount(_x12, _x13, _x14) {\n        return _switchToNewlyCreatedAccount.apply(this, arguments);\n      }\n\n      return switchToNewlyCreatedAccount;\n    }()\n  }, {\n    key: \"fetchAccountSettings\",\n    value: function fetchAccountSettings() {\n      var _this27 = this;\n\n      return new Promise(function (resolve) {\n        Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.getSettings().then(function (response) {\n          _this27.setAccountSettings(response.get_settings);\n\n          resolve(response);\n        });\n      });\n    }\n  }, {\n    key: \"fetchResidenceList\",\n    value: function fetchResidenceList() {\n      var _this28 = this;\n\n      return new Promise(function (resolve) {\n        Services__WEBPACK_IMPORTED_MODULE_5__.WS.storage.residenceList().then(function (response) {\n          _this28.setResidenceList(response);\n\n          resolve(response);\n        });\n      });\n    }\n  }, {\n    key: \"setResidenceList\",\n    value: function setResidenceList(residence_list_response) {\n      this.residence_list = residence_list_response.residence_list || [];\n    }\n  }, {\n    key: \"fetchStatesList\",\n    value: function fetchStatesList() {\n      var _this29 = this;\n\n      return new Promise(function (resolve, reject) {\n        Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.statesList({\n          states_list: _this29.accounts[_this29.loginid].residence\n        }).then(function (response) {\n          if (response.error) {\n            reject(response.error);\n          } else {\n            (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n              _this29.states_list = response.states_list || [];\n            });\n          }\n\n          resolve(response);\n        });\n      });\n    }\n  }, {\n    key: \"resetMt5ListPopulatedState\",\n    value: function resetMt5ListPopulatedState() {\n      this.is_mt5_account_list_updated = false;\n      this.is_populating_mt5_account_list = true;\n      this.mt5_login_list_error = null;\n    }\n  }, {\n    key: \"updateMt5LoginList\",\n    value: function () {\n      var _updateMt5LoginList = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee18() {\n        var response;\n        return regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                if (!(this.is_logged_in && !this.is_mt5_account_list_updated && !this.is_populating_mt5_account_list)) {\n                  _context18.next = 5;\n                  break;\n                }\n\n                _context18.next = 3;\n                return Services__WEBPACK_IMPORTED_MODULE_5__.WS.mt5LoginList();\n\n              case 3:\n                response = _context18.sent;\n                this.responseMt5LoginList(response);\n\n              case 5:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      function updateMt5LoginList() {\n        return _updateMt5LoginList.apply(this, arguments);\n      }\n\n      return updateMt5LoginList;\n    }()\n  }, {\n    key: \"responseMT5TradingServers\",\n    value: function responseMT5TradingServers(response) {\n      if (response.error) {\n        this.mt5_trading_servers = [];\n        return;\n      }\n\n      this.mt5_trading_servers = response.trading_servers;\n    }\n  }, {\n    key: \"responseMt5LoginList\",\n    value: function responseMt5LoginList(response) {\n      var _this30 = this;\n\n      this.is_populating_mt5_account_list = false;\n      this.is_mt5_account_list_updated = true;\n      this.mt5_login_list_error = null;\n      /** we need to update mt5_login_list on mount of account switcher\n       *  to get the new MT5 balances (balance does not stream for MT5 accounts due to API restriction)\n       *  but to avoid spamming this call since the rate limit is strict\n       *  keep the current mt5_login_list response cached for one minute\n       *  after one minute consider it outdated and allow re-requesting it */\n\n      setTimeout(function () {\n        _this30.is_mt5_account_list_updated = false;\n      }, 60000);\n\n      if (!response.error) {\n        this.mt5_login_list = response.mt5_login_list.map(function (account) {\n          var display_login = (account.error ? account.error.details.login : account.login).replace(/^(MT[DR]?)/i, '');\n\n          if (account.error) {\n            var _account$error$detail = account.error.details,\n                account_type = _account$error$detail.account_type,\n                server = _account$error$detail.server;\n\n            _this30.setMT5DisabledSignupTypes(_defineProperty({}, account_type, true));\n\n            return {\n              account_type: account_type,\n              display_login: display_login,\n              has_error: true,\n              server: server\n            };\n          }\n\n          return _objectSpread(_objectSpread({}, account), {}, {\n            display_login: display_login\n          });\n        });\n      } else {\n        this.mt5_login_list_error = response.error;\n      }\n    }\n  }, {\n    key: \"responseDxtradeTradingServers\",\n    value: function responseDxtradeTradingServers(response) {\n      var _this31 = this;\n\n      if (response.error) {\n        this.dxtrade_trading_servers = [];\n        return;\n      }\n\n      this.dxtrade_trading_servers = response.trading_servers;\n      this.dxtrade_trading_servers.forEach(function (trading_server) {\n        var account_type = trading_server.account_type,\n            disabled = trading_server.disabled;\n\n        if (disabled) {\n          _this31.setCFDDisabledSignupTypes(_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE, _defineProperty({}, account_type, true));\n        }\n      });\n    }\n  }, {\n    key: \"responseTradingPlatformAccountsList\",\n    value: function responseTradingPlatformAccountsList(response) {\n      var _this32 = this;\n\n      var _ref10 = response.echo_req || {},\n          platform = _ref10.platform;\n\n      this[\"is_populating_\".concat(platform, \"_account_list\")] = false;\n      this[\"\".concat(platform, \"_accounts_list_error\")] = null;\n\n      if (!response.error) {\n        this[\"\".concat(platform, \"_accounts_list\")] = response.trading_platform_accounts.map(function (account) {\n          var display_login = account.error ? account.error.details.account_id : account.account_id;\n\n          if (account.error) {\n            var _account$error$detail2 = account.error.details,\n                account_type = _account$error$detail2.account_type,\n                server = _account$error$detail2.server;\n\n            if (platform === _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.CFD_PLATFORMS.DXTRADE) {\n              _this32.setCFDDisabledSignupTypes(platform, _defineProperty({}, account_type, true));\n            }\n\n            return {\n              account_type: account_type,\n              display_login: display_login,\n              has_error: true,\n              server: server\n            };\n          }\n\n          return _objectSpread(_objectSpread({}, account), {}, {\n            display_login: display_login\n          });\n        });\n      } else {\n        this[\"\".concat(platform, \"_accounts_list_error\")] = response.error;\n      }\n    }\n  }, {\n    key: \"responseStatement\",\n    value: function responseStatement(response) {\n      if (!response.error) {\n        this.statement = response.statement;\n      }\n    }\n  }, {\n    key: \"getChangeableFields\",\n    value: function getChangeableFields() {\n      var get_settings = Object.keys(this.account_settings).length === 0 ? Services__WEBPACK_IMPORTED_MODULE_5__.WS.authorized.storage.getSettings() : this.account_settings;\n      var readonly_fields = [].concat(_toConsumableArray(get_settings.immutable_fields), ['immutable_fields', 'email', 'password']);\n      return Object.keys(get_settings).filter(function (field) {\n        return !readonly_fields.includes(field);\n      });\n    }\n  }, {\n    key: \"syncWithLegacyPlatforms\",\n    value: function syncWithLegacyPlatforms(active_loginid, client_accounts) {\n      var smartTrader = {};\n      var binaryBot = {};\n      smartTrader.iframe = document.getElementById('localstorage-sync');\n      binaryBot.iframe = document.getElementById('localstorage-sync__bot');\n      smartTrader.origin = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.getUrlSmartTrader)();\n      binaryBot.origin = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.getUrlBinaryBot)();\n      [smartTrader, binaryBot].forEach(function (platform) {\n        if (platform.iframe) {\n          // Keep client.accounts in sync (in case user wasn't logged in).\n          platform.iframe.contentWindow.postMessage({\n            key: 'client.accounts',\n            value: JSON.stringify(client_accounts)\n          }, platform.origin);\n          platform.iframe.contentWindow.postMessage({\n            key: 'active_loginid',\n            value: active_loginid\n          }, platform.origin);\n        }\n      });\n    }\n  }, {\n    key: \"is_high_risk\",\n    get: function get() {\n      if ((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_3__.isEmptyObject)(this.account_status)) return false;\n      return this.account_status.risk_classification === 'high';\n    }\n  }, {\n    key: \"has_residence\",\n    get: function get() {\n      var _this$accounts$this$l;\n\n      return !!((_this$accounts$this$l = this.accounts[this.loginid]) !== null && _this$accounts$this$l !== void 0 && _this$accounts$this$l.residence);\n    }\n  }, {\n    key: \"setVisibilityRealityCheck\",\n    value: function setVisibilityRealityCheck(is_visible) {\n      // if reality check timeout has been set, don't make it visible until it runs out\n      if (is_visible && typeof this.reality_check_timeout === 'number') {\n        return;\n      }\n\n      this.is_reality_check_dismissed = !is_visible; // store in localstorage to keep track of across tabs/on refresh\n\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.set('reality_check_dismissed', !is_visible);\n    }\n  }, {\n    key: \"clearRealityCheckTimeout\",\n    value: function clearRealityCheckTimeout() {\n      clearTimeout(this.reality_check_timeout);\n      this.reality_check_timeout = undefined;\n    }\n  }, {\n    key: \"setRealityCheckDuration\",\n    value: function setRealityCheckDuration(duration) {\n      var _this33 = this;\n\n      this.reality_check_dur = +duration;\n      this.clearRealityCheckTimeout(); // store in localstorage to keep track of across tabs/on refresh\n\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.set('reality_check_duration', +duration);\n      this.reality_check_timeout = setTimeout(function () {\n        // set reality_check_timeout to undefined\n        _this33.clearRealityCheckTimeout(); // after this duration passes, show the summary pop up\n\n\n        _this33.setVisibilityRealityCheck(1);\n      }, +duration * 60 * 1000);\n    }\n  }, {\n    key: \"cleanupRealityCheck\",\n    value: function cleanupRealityCheck() {\n      this.has_reality_check = false;\n      this.is_reality_check_dismissed = undefined;\n      this.reality_check_dur = undefined;\n      this.clearRealityCheckTimeout();\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.remove('reality_check_duration');\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.remove('reality_check_dismissed');\n    }\n  }, {\n    key: \"fetchFinancialAssessment\",\n    value: function fetchFinancialAssessment() {\n      var _this34 = this;\n\n      return new Promise( /*#__PURE__*/function () {\n        var _ref11 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee19(resolve) {\n          var _yield$WS$getFinancia, get_financial_assessment;\n\n          return regeneratorRuntime.wrap(function _callee19$(_context19) {\n            while (1) {\n              switch (_context19.prev = _context19.next) {\n                case 0:\n                  _context19.next = 2;\n                  return Services__WEBPACK_IMPORTED_MODULE_5__.WS.getFinancialAssessment();\n\n                case 2:\n                  _yield$WS$getFinancia = _context19.sent;\n                  get_financial_assessment = _yield$WS$getFinancia.get_financial_assessment;\n                  (0,mobx__WEBPACK_IMPORTED_MODULE_1__.runInAction)(function () {\n                    return _this34.financial_assessment = get_financial_assessment;\n                  });\n                  resolve(get_financial_assessment);\n\n                case 6:\n                case \"end\":\n                  return _context19.stop();\n              }\n            }\n          }, _callee19);\n        }));\n\n        return function (_x15) {\n          return _ref11.apply(this, arguments);\n        };\n      }());\n    }\n  }]);\n\n  return ClientStore;\n}(_base_store__WEBPACK_IMPORTED_MODULE_10__.default), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"loginid\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"preferred_language\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"upgrade_info\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor4 = _applyDecoratedDescriptor(_class.prototype, \"email\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor5 = _applyDecoratedDescriptor(_class.prototype, \"accounts\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor6 = _applyDecoratedDescriptor(_class.prototype, \"pre_switch_broadcast\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor7 = _applyDecoratedDescriptor(_class.prototype, \"switched\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return '';\n  }\n}), _descriptor8 = _applyDecoratedDescriptor(_class.prototype, \"is_switching\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor9 = _applyDecoratedDescriptor(_class.prototype, \"switch_broadcast\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor10 = _applyDecoratedDescriptor(_class.prototype, \"initialized_broadcast\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor11 = _applyDecoratedDescriptor(_class.prototype, \"currencies_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor12 = _applyDecoratedDescriptor(_class.prototype, \"residence_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor13 = _applyDecoratedDescriptor(_class.prototype, \"states_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor14 = _applyDecoratedDescriptor(_class.prototype, \"selected_currency\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return '';\n  }\n}), _descriptor15 = _applyDecoratedDescriptor(_class.prototype, \"is_populating_account_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor16 = _applyDecoratedDescriptor(_class.prototype, \"is_populating_mt5_account_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return true;\n  }\n}), _descriptor17 = _applyDecoratedDescriptor(_class.prototype, \"is_populating_dxtrade_account_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return true;\n  }\n}), _descriptor18 = _applyDecoratedDescriptor(_class.prototype, \"has_reality_check\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor19 = _applyDecoratedDescriptor(_class.prototype, \"is_reality_check_dismissed\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor20 = _applyDecoratedDescriptor(_class.prototype, \"reality_check_dur\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor21 = _applyDecoratedDescriptor(_class.prototype, \"reality_check_timeout\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor22 = _applyDecoratedDescriptor(_class.prototype, \"website_status\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor23 = _applyDecoratedDescriptor(_class.prototype, \"account_settings\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor24 = _applyDecoratedDescriptor(_class.prototype, \"account_status\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor25 = _applyDecoratedDescriptor(_class.prototype, \"device_data\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor26 = _applyDecoratedDescriptor(_class.prototype, \"is_logging_in\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor27 = _applyDecoratedDescriptor(_class.prototype, \"has_logged_out\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor28 = _applyDecoratedDescriptor(_class.prototype, \"is_landing_company_loaded\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor29 = _applyDecoratedDescriptor(_class.prototype, \"is_account_setting_loaded\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor30 = _applyDecoratedDescriptor(_class.prototype, \"client_notifications\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return _Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_13__.clientNotifications;\n  }\n}), _descriptor31 = _applyDecoratedDescriptor(_class.prototype, \"landing_companies\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor32 = _applyDecoratedDescriptor(_class.prototype, \"standpoint\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      iom: false,\n      svg: false,\n      malta: false,\n      maltainvest: false,\n      gaming_company: false,\n      financial_company: false\n    };\n  }\n}), _descriptor33 = _applyDecoratedDescriptor(_class.prototype, \"upgradeable_landing_companies\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor34 = _applyDecoratedDescriptor(_class.prototype, \"mt5_disabled_signup_types\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      real: false,\n      demo: false\n    };\n  }\n}), _descriptor35 = _applyDecoratedDescriptor(_class.prototype, \"mt5_login_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor36 = _applyDecoratedDescriptor(_class.prototype, \"mt5_login_list_error\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return null;\n  }\n}), _descriptor37 = _applyDecoratedDescriptor(_class.prototype, \"dxtrade_accounts_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor38 = _applyDecoratedDescriptor(_class.prototype, \"dxtrade_accounts_list_error\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return null;\n  }\n}), _descriptor39 = _applyDecoratedDescriptor(_class.prototype, \"dxtrade_disabled_signup_types\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      real: false,\n      demo: false\n    };\n  }\n}), _descriptor40 = _applyDecoratedDescriptor(_class.prototype, \"statement\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor41 = _applyDecoratedDescriptor(_class.prototype, \"obj_total_balance\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      amount_real: undefined,\n      amount_mt5: undefined,\n      amount_dxtrade: undefined,\n      currency: ''\n    };\n  }\n}), _descriptor42 = _applyDecoratedDescriptor(_class.prototype, \"verification_code\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      signup: '',\n      reset_password: '',\n      payment_withdraw: '',\n      payment_agent_withdraw: '',\n      trading_platform_mt5_password_reset: '',\n      trading_platform_dxtrade_password_reset: ''\n    };\n  }\n}), _descriptor43 = _applyDecoratedDescriptor(_class.prototype, \"account_limits\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor44 = _applyDecoratedDescriptor(_class.prototype, \"self_exclusion\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor45 = _applyDecoratedDescriptor(_class.prototype, \"local_currency_config\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      currency: '',\n      decimal_places: undefined\n    };\n  }\n}), _descriptor46 = _applyDecoratedDescriptor(_class.prototype, \"has_cookie_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor47 = _applyDecoratedDescriptor(_class.prototype, \"financial_assessment\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return null;\n  }\n}), _descriptor48 = _applyDecoratedDescriptor(_class.prototype, \"mt5_trading_servers\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor49 = _applyDecoratedDescriptor(_class.prototype, \"dxtrade_trading_servers\", [mobx__WEBPACK_IMPORTED_MODULE_1__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"balance\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"balance\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_reality_check_visible\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_reality_check_visible\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_svg\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_svg\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"reality_check_duration\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"reality_check_duration\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"reality_check_dismissed\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"reality_check_dismissed\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_active_real_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_active_real_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_maltainvest_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_maltainvest_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_malta_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_malta_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_any_real_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_any_real_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"first_switchable_real_loginid\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"first_switchable_real_loginid\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_change_fiat_currency\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_change_fiat_currency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"legal_allowed_currencies\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"legal_allowed_currencies\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"upgradeable_currencies\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"upgradeable_currencies\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"current_currency_type\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"current_currency_type\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"available_crypto_currencies\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"available_crypto_currencies\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_iom_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_iom_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_fiat\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_fiat\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"current_fiat_currency\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"current_fiat_currency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"current_landing_company\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"current_landing_company\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"account_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"account_list\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_real_mt5_login\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_real_mt5_login\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_real_dxtrade_login\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_real_dxtrade_login\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_account_error_in_mt5_real_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_account_error_in_mt5_real_list\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_account_error_in_mt5_demo_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_account_error_in_mt5_demo_list\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_account_error_in_dxtrade_real_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_account_error_in_dxtrade_real_list\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_account_error_in_dxtrade_demo_list\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_account_error_in_dxtrade_demo_list\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_have_more_real_synthetic_mt5\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_have_more_real_synthetic_mt5\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"active_accounts\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"active_accounts\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"all_loginids\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"all_loginids\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"account_title\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"account_title\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"currency\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"currency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"default_currency\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"default_currency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"should_allow_authentication\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"should_allow_authentication\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_authentication_needed\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_authentication_needed\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_tnc_needed\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_tnc_needed\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_social_signup\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_social_signup\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_mt5_password_not_set\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_mt5_password_not_set\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_dxtrade_password_not_set\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_dxtrade_password_not_set\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_financial_information_incomplete\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_financial_information_incomplete\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_deposit_lock\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_deposit_lock\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_withdrawal_lock\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_withdrawal_lock\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_trading_experience_incomplete\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_trading_experience_incomplete\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"authentication_status\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"authentication_status\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"social_identity_provider\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"social_identity_provider\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_from_restricted_country\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_from_restricted_country\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_fully_authenticated\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_fully_authenticated\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_pending_authentication\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_pending_authentication\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_financial_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_financial_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_age_verified\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_age_verified\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"landing_company_shortcode\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"landing_company_shortcode\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"landing_company\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"landing_company\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_valid_login\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_valid_login\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_logged_in\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_logged_in\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_virtual\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_virtual\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_eu\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_eu\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_uk\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_uk\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"country_standpoint\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"country_standpoint\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"custom_notifications\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"custom_notifications\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_have_mlt_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_have_mlt_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_have_mx_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_have_mx_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_have_mf_account\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_have_mf_account\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_upgrade\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_upgrade\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"can_upgrade_to\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"can_upgrade_to\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"virtual_account_loginid\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"virtual_account_loginid\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_single_currency\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_single_currency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"account_type\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"account_type\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_mt5_allowed\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_mt5_allowed\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_dxtrade_allowed\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_dxtrade_allowed\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"clients_country\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"clients_country\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_eu_country\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_eu_country\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_options_blocked\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_options_blocked\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_multipliers_only\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_multipliers_only\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"resetLocalStorageValues\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"resetLocalStorageValues\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"getBasicUpgradeInfo\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"getBasicUpgradeInfo\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setMT5DisabledSignupTypes\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"setMT5DisabledSignupTypes\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setCFDDisabledSignupTypes\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"setCFDDisabledSignupTypes\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"getLimits\", [_dec5], Object.getOwnPropertyDescriptor(_class.prototype, \"getLimits\"), _class.prototype), _descriptor50 = _applyDecoratedDescriptor(_class.prototype, \"setPreferredLanguage\", [_dec6], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    var _this35 = this;\n\n    return function (lang) {\n      _this35.preferred_language = lang;\n      _deriv_shared__WEBPACK_IMPORTED_MODULE_3__.LocalStore.setObject(LANGUAGE_KEY, lang);\n    };\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"setCookieAccount\", [_dec7], Object.getOwnPropertyDescriptor(_class.prototype, \"setCookieAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"updateSelfExclusion\", [_dec8], Object.getOwnPropertyDescriptor(_class.prototype, \"updateSelfExclusion\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responsePayoutCurrencies\", [_dec9], Object.getOwnPropertyDescriptor(_class.prototype, \"responsePayoutCurrencies\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseAuthorize\", [_dec10], Object.getOwnPropertyDescriptor(_class.prototype, \"responseAuthorize\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setWebsiteStatus\", [_dec11], Object.getOwnPropertyDescriptor(_class.prototype, \"setWebsiteStatus\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"accountRealReaction\", [_dec12], Object.getOwnPropertyDescriptor(_class.prototype, \"accountRealReaction\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setLoginInformation\", [_dec13], Object.getOwnPropertyDescriptor(_class.prototype, \"setLoginInformation\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"realAccountSignup\", [_dec14], Object.getOwnPropertyDescriptor(_class.prototype, \"realAccountSignup\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setAccountCurrency\", [_dec15], Object.getOwnPropertyDescriptor(_class.prototype, \"setAccountCurrency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"updateAccountCurrency\", [_dec16], Object.getOwnPropertyDescriptor(_class.prototype, \"updateAccountCurrency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"createCryptoAccount\", [_dec17], Object.getOwnPropertyDescriptor(_class.prototype, \"createCryptoAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"residence\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"residence\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"email_address\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"email_address\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_website_status_ready\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_website_status_ready\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"updateAccountList\", [_dec18], Object.getOwnPropertyDescriptor(_class.prototype, \"updateAccountList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"switchAccount\", [_dec19], Object.getOwnPropertyDescriptor(_class.prototype, \"switchAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"resetVirtualBalance\", [_dec20], Object.getOwnPropertyDescriptor(_class.prototype, \"resetVirtualBalance\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"switchEndSignal\", [_dec21], Object.getOwnPropertyDescriptor(_class.prototype, \"switchEndSignal\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"refreshNotifications\", [_dec22], Object.getOwnPropertyDescriptor(_class.prototype, \"refreshNotifications\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"init\", [_dec23], Object.getOwnPropertyDescriptor(_class.prototype, \"init\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"resetMt5AccountListPopulation\", [_dec24], Object.getOwnPropertyDescriptor(_class.prototype, \"resetMt5AccountListPopulation\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseWebsiteStatus\", [_dec25], Object.getOwnPropertyDescriptor(_class.prototype, \"responseWebsiteStatus\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseLandingCompany\", [_dec26], Object.getOwnPropertyDescriptor(_class.prototype, \"responseLandingCompany\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setStandpoint\", [_dec27], Object.getOwnPropertyDescriptor(_class.prototype, \"setStandpoint\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setRealityCheck\", [_dec28], Object.getOwnPropertyDescriptor(_class.prototype, \"setRealityCheck\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setLoginId\", [_dec29], Object.getOwnPropertyDescriptor(_class.prototype, \"setLoginId\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setAccounts\", [_dec30], Object.getOwnPropertyDescriptor(_class.prototype, \"setAccounts\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setSwitched\", [_dec31], Object.getOwnPropertyDescriptor(_class.prototype, \"setSwitched\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setHasMissingRequiredField\", [_dec32], Object.getOwnPropertyDescriptor(_class.prototype, \"setHasMissingRequiredField\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setIsLoggingIn\", [_dec33], Object.getOwnPropertyDescriptor(_class.prototype, \"setIsLoggingIn\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setPreSwitchAccount\", [_dec34], Object.getOwnPropertyDescriptor(_class.prototype, \"setPreSwitchAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"broadcastAccountChange\", [_dec35], Object.getOwnPropertyDescriptor(_class.prototype, \"broadcastAccountChange\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"switchAccountHandler\", [_dec36], Object.getOwnPropertyDescriptor(_class.prototype, \"switchAccountHandler\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"registerReactions\", [_dec37], Object.getOwnPropertyDescriptor(_class.prototype, \"registerReactions\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"resetVirtualBalanceNotification\", [_dec38], Object.getOwnPropertyDescriptor(_class.prototype, \"resetVirtualBalanceNotification\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setBalanceActiveAccount\", [_dec39], Object.getOwnPropertyDescriptor(_class.prototype, \"setBalanceActiveAccount\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setBalanceOtherAccounts\", [_dec40], Object.getOwnPropertyDescriptor(_class.prototype, \"setBalanceOtherAccounts\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"selectCurrency\", [_dec41], Object.getOwnPropertyDescriptor(_class.prototype, \"selectCurrency\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setResidence\", [_dec42], Object.getOwnPropertyDescriptor(_class.prototype, \"setResidence\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setEmail\", [_dec43], Object.getOwnPropertyDescriptor(_class.prototype, \"setEmail\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setAccountSettings\", [_dec44], Object.getOwnPropertyDescriptor(_class.prototype, \"setAccountSettings\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setAccountStatus\", [_dec45], Object.getOwnPropertyDescriptor(_class.prototype, \"setAccountStatus\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setInitialized\", [_dec46], Object.getOwnPropertyDescriptor(_class.prototype, \"setInitialized\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"cleanUp\", [_dec47], Object.getOwnPropertyDescriptor(_class.prototype, \"cleanUp\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"logout\", [_dec48], Object.getOwnPropertyDescriptor(_class.prototype, \"logout\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setLogout\", [_dec49], Object.getOwnPropertyDescriptor(_class.prototype, \"setLogout\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"storeClientAccounts\", [_dec50], Object.getOwnPropertyDescriptor(_class.prototype, \"storeClientAccounts\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setUserLogin\", [_dec51], Object.getOwnPropertyDescriptor(_class.prototype, \"setUserLogin\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"canStoreClientAccounts\", [_dec52], Object.getOwnPropertyDescriptor(_class.prototype, \"canStoreClientAccounts\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setVerificationCode\", [_dec53], Object.getOwnPropertyDescriptor(_class.prototype, \"setVerificationCode\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setDeviceData\", [_dec54], Object.getOwnPropertyDescriptor(_class.prototype, \"setDeviceData\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"getSignupParams\", [_dec55], Object.getOwnPropertyDescriptor(_class.prototype, \"getSignupParams\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onSetResidence\", [_dec56], Object.getOwnPropertyDescriptor(_class.prototype, \"onSetResidence\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"onSignup\", [_dec57], Object.getOwnPropertyDescriptor(_class.prototype, \"onSignup\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"fetchAccountSettings\", [_dec58], Object.getOwnPropertyDescriptor(_class.prototype, \"fetchAccountSettings\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"fetchResidenceList\", [_dec59], Object.getOwnPropertyDescriptor(_class.prototype, \"fetchResidenceList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setResidenceList\", [_dec60], Object.getOwnPropertyDescriptor(_class.prototype, \"setResidenceList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"fetchStatesList\", [_dec61], Object.getOwnPropertyDescriptor(_class.prototype, \"fetchStatesList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"resetMt5ListPopulatedState\", [_dec62], Object.getOwnPropertyDescriptor(_class.prototype, \"resetMt5ListPopulatedState\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"updateMt5LoginList\", [_dec63], Object.getOwnPropertyDescriptor(_class.prototype, \"updateMt5LoginList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseMT5TradingServers\", [_dec64], Object.getOwnPropertyDescriptor(_class.prototype, \"responseMT5TradingServers\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseMt5LoginList\", [_dec65], Object.getOwnPropertyDescriptor(_class.prototype, \"responseMt5LoginList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseDxtradeTradingServers\", [_dec66], Object.getOwnPropertyDescriptor(_class.prototype, \"responseDxtradeTradingServers\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseTradingPlatformAccountsList\", [_dec67], Object.getOwnPropertyDescriptor(_class.prototype, \"responseTradingPlatformAccountsList\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"responseStatement\", [_dec68], Object.getOwnPropertyDescriptor(_class.prototype, \"responseStatement\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"getChangeableFields\", [_dec69], Object.getOwnPropertyDescriptor(_class.prototype, \"getChangeableFields\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"syncWithLegacyPlatforms\", [_dec70], Object.getOwnPropertyDescriptor(_class.prototype, \"syncWithLegacyPlatforms\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"is_high_risk\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"is_high_risk\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"has_residence\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"has_residence\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setVisibilityRealityCheck\", [_dec71], Object.getOwnPropertyDescriptor(_class.prototype, \"setVisibilityRealityCheck\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"clearRealityCheckTimeout\", [_dec72], Object.getOwnPropertyDescriptor(_class.prototype, \"clearRealityCheckTimeout\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setRealityCheckDuration\", [_dec73], Object.getOwnPropertyDescriptor(_class.prototype, \"setRealityCheckDuration\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"cleanupRealityCheck\", [_dec74], Object.getOwnPropertyDescriptor(_class.prototype, \"cleanupRealityCheck\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"fetchFinancialAssessment\", [_dec75], Object.getOwnPropertyDescriptor(_class.prototype, \"fetchFinancialAssessment\"), _class.prototype)), _class));\n\n/* eslint-enable *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9TdG9yZXMvY2xpZW50LXN0b3JlLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQWlCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQStCQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQWtEQTtBQUFBOztBQUFBOztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFGQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTs7QUFBQTtBQTZFQTtBQUFBO0FBQUE7QUFDQTs7QUE5RUE7QUFnT0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQXBPQTtBQStsQkE7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUF4bUJBO0FBMG1CQTs7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUtBOztBQXRuQkE7O0FBQUE7QUF5K0JBO0FBQ0E7QUFDQTs7QUEzK0JBO0FBOCtCQTtBQUVBO0FBTUE7O0FBdC9CQTtBQXkvQkE7QUFBQTtBQUFBOztBQUNBO0FBQUE7QUFBQTtBQUNBOztBQTMvQkE7QUE2L0JBOztBQUNBO0FBRUE7QUFFQTtBQUdBOztBQXJnQ0E7QUF1Z0NBOztBQUNBO0FBRUE7QUFDQTs7QUF2Z0NBO0FBQ0E7QUFBQTtBQVdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBckJBO0FBdUJBOzs7O0FBRUE7QUFFQTtBQUNBO0FBR0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUdBOzs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUNBOzs7QUFNQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBSUE7QUFDQTs7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQURBO0FBQUE7QUFJQTs7O0FBRUE7QUFFQTs7QUFDQTtBQUtBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFHQTs7OztBQUNBO0FBQ0E7O0FBQ0E7QUFHQTs7QUFBQTtBQUFBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7OztBQVNBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUFBO0FBRUE7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUVBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUFBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUFBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUFBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUFBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQUE7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUVBO0FBTUE7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUdBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQWNBO0FBR0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQWhCQTtBQURBO0FBb0JBO0FBQ0E7QUFHQTs7OztBQUNBO0FBRUE7QUFzQkE7QUFDQTs7OztBQUdBO0FBRUE7QUFDQTtBQUNBO0FBR0E7Ozs7QUFDQTtBQUVBO0FBMkJBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQUE7QUFBQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFFQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBNEJBO0FBQ0E7O0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7O0FBR0E7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBRUE7QUFBQTtBQUZBOztBQU1BOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQVFBO0FBRUE7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVVBO0FBQUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFWQTtBQVlBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7OztBQUNBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBR0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFFQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUFBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTs7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQXhCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7OztBQTJCQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBWEE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQVlBOztBQVpBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQXlCQTtBQXpCQTtBQUFBO0FBMEJBO0FBQUE7O0FBMUJBO0FBQUE7QUErQkE7QUFFQTtBQUZBO0FBREE7QUFTQTtBQUNBO0FBREE7QUFEQTs7QUF0Q0E7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7QUFrREE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBREE7O0FBRkE7QUFFQTs7QUFGQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7Ozs7QUFZQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFEQTtBQWhCQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7OztBQXNCQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBSkE7QUFBQTs7QUFBQTtBQVlBOztBQVpBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7O0FBb0JBO0FBRUE7QUFBQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBdUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7OztBQVVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUhBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7Ozs7Ozs7Ozs7QUFPQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQUE7O0FBT0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQU5BO0FBQUE7O0FBQUE7QUFPQTtBQUNBOztBQVJBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUF0QkE7O0FBQUE7QUEwQkE7QUFDQTtBQUNBO0FBQ0E7O0FBN0JBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQWtDQTs7QUFsQ0E7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUF3Q0E7QUFEQTs7QUF2Q0E7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQThDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUF2REE7QUEwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFBQTtBQUFBO0FBUUE7QUFDQTtBQUNBOztBQUNBOztBQUNBO0FBQUE7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBeEZBO0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQTRGQTtBQUNBO0FBRUE7QUFDQTtBQWhHQTtBQUFBO0FBQUE7QUFvR0E7QUFEQTs7QUFuR0E7QUFBQTs7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBdUdBO0FBQ0E7QUF4R0E7QUFBQTs7QUFBQTtBQTJHQTtBQUNBO0FBQ0E7O0FBN0dBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQWtIQTs7QUFsSEE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTs7QUFzSEE7QUFDQTtBQUNBO0FBeEhBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7O0FBNEhBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUFBOztBQUNBO0FBQUE7O0FBQ0E7QUFLQTs7QUFDQTtBQUFBOztBQUNBO0FBS0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUVBOztBQUNBO0FBS0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBTEE7QUFPQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBOztBQUtBO0FBQ0E7OztBQUVBO0FBQUE7O0FBQ0E7QUFBQTtBQUFBO0FBQ0E7Ozs7QUFFQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUlBO0FBSkE7O0FBQUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUZBOztBQU1BO0FBZkE7QUFBQTs7QUFBQTtBQUFBOztBQUFBO0FBb0JBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7O0FBQ0E7O0FBNUJBO0FBQUE7QUFBQTtBQUFBOztBQStCQTtBQS9CQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBcUNBO0FBQ0E7O0FBR0E7QUF6Q0E7QUFBQTs7QUFBQTtBQTZDQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7O0FBbERBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7O0FBcURBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBOztBQUNBO0FBQ0E7QUFHQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTs7OztBQUNBO0FBQ0E7QUFBQTtBQUFBOztBQUNBO0FBQ0E7QUFDQTtBQUdBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTs7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUdBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBVkE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7Ozs7Ozs7Ozs7QUFlQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUdBOzs7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUVBO0FBQUE7O0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7QUFBQTtBQUFBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBNUJBO0FBQUE7QUFBQTtBQUFBOztBQThCQTtBQUNBOztBQUVBO0FBakNBO0FBQUE7O0FBQUE7QUFrQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBdkNBO0FBQUE7QUFBQTtBQUFBOztBQUFBOztBQUFBO0FBNkNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFDQTtBQTFEQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7Ozs7Ozs7OztBQStEQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFBQTtBQUNBO0FBQUE7QUFEQTtBQUlBO0FBQ0E7OztBQUVBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFrQkE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOzs7QUFFQTtBQUNBOztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBRUE7QUFGQTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQTtBQUFBO0FBUUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQVJBO0FBV0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTs7QUFIQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUtBOztBQWhCQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFGQTtBQUFBO0FBQUE7QUFBQTtBQXFCQTs7O0FBRUE7QUFDQTs7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBTUE7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFFQTtBQUZBO0FBQUE7O0FBQUE7QUFJQTs7QUFKQTtBQUFBO0FBQUE7O0FBQUE7QUFTQTtBQUNBO0FBQ0E7QUFEQTs7QUFJQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBaEJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQU5BO0FBQUE7QUFBQTtBQUFBO0FBeUJBOzs7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBRkE7QUFBQTs7QUFBQTtBQVFBOztBQVJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7O0FBV0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUFBO0FBQUE7O0FBQUE7QUFHQTtBQUNBOztBQUpBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7Ozs7O0FBUUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFJQTtBQUNBO0FBQUE7QUFBQTs7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7QUFDQTtBQUVBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUFBOztBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFBQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTs7QUFDQTtBQUNBO0FBR0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBTUE7O0FBQ0E7QUFFQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUtBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRkE7QUFNQTtBQUVBO0FBQ0E7QUFGQTtBQU1BO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7O0FBQ0E7QUFBQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTs7QUFKQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQU1BOzs7O0FBL3JFQTs7Ozs7QUFFQTs7Ozs7QUFDQTs7Ozs7QUFDQTs7Ozs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFDQTs7Ozs7QUFDQTs7Ozs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFDQTs7Ozs7QUFBQTs7QUFHQTs7Ozs7QUFBQTs7QUFPQTs7Ozs7QUFBQTs7QUFHQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BOztBQVNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTs7QUFPQTs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BOztBQVFBOzs7OztBQUFBOztBQUVBOzs7OztBQUFBOztBQUVBOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUZBOztBQUlBOzs7OztBQUFBOztBQUVBOzs7OztBQUFBOztBQUVBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBOztBQTZCQTs7Ozs7OztBQXNzQkE7QUFDQTtBQUNBO0FBQ0E7O0FBZ1BBOztBQW9wQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9TdG9yZXMvY2xpZW50LXN0b3JlLmpzPzQ5YmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENvb2tpZXMgZnJvbSAnanMtY29va2llJztcbmltcG9ydCB7IGFjdGlvbiwgY29tcHV0ZWQsIG9ic2VydmFibGUsIHJlYWN0aW9uLCBydW5JbkFjdGlvbiwgdG9KUywgd2hlbiB9IGZyb20gJ21vYngnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHtcbiAgICByZWRpcmVjdFRvTG9naW4sXG4gICAgZ2V0UHJvcGVydHlWYWx1ZSxcbiAgICBnZXRVcmxTbWFydFRyYWRlcixcbiAgICBnZXRVcmxCaW5hcnlCb3QsXG4gICAgaXNEZXNrdG9wT3MsXG4gICAgaXNFbXB0eU9iamVjdCxcbiAgICBMb2NhbFN0b3JlLFxuICAgIHNldEN1cnJlbmNpZXMsXG4gICAgU3RhdGUsXG4gICAgdG9Nb21lbnQsXG4gICAgZGVyaXZfdXJscyxcbiAgICB1cmxGb3IsXG4gICAgdXJsRm9yTGFuZ3VhZ2UsXG4gICAgQ0ZEX1BMQVRGT1JNUyxcbiAgICByb3V0ZXMsXG59IGZyb20gJ0BkZXJpdi9zaGFyZWQnO1xuaW1wb3J0IHsgZ2V0TGFuZ3VhZ2UsIGxvY2FsaXplIH0gZnJvbSAnQGRlcml2L3RyYW5zbGF0aW9ucyc7XG5pbXBvcnQgeyByZXF1ZXN0TG9nb3V0LCBXUyB9IGZyb20gJ1NlcnZpY2VzJztcbmltcG9ydCBCaW5hcnlTb2NrZXRHZW5lcmFsIGZyb20gJ1NlcnZpY2VzL3NvY2tldC1nZW5lcmFsJztcbmltcG9ydCBCaW5hcnlTb2NrZXQgZnJvbSAnX2NvbW1vbi9iYXNlL3NvY2tldF9iYXNlJztcbmltcG9ydCAqIGFzIFNvY2tldENhY2hlIGZyb20gJ19jb21tb24vYmFzZS9zb2NrZXRfY2FjaGUnO1xuaW1wb3J0IHsgaXNFdUNvdW50cnksIGlzTXVsdGlwbGllcnNPbmx5LCBpc09wdGlvbnNCbG9ja2VkIH0gZnJvbSAnX2NvbW1vbi91dGlsaXR5JztcbmltcG9ydCBCYXNlU3RvcmUgZnJvbSAnLi9iYXNlLXN0b3JlJztcbmltcG9ydCB7IGdldENsaWVudEFjY291bnRUeXBlLCBnZXRBY2NvdW50VGl0bGUgfSBmcm9tICcuL0hlbHBlcnMvY2xpZW50JztcbmltcG9ydCB7IHNldERldmljZURhdGFDb29raWUgfSBmcm9tICcuL0hlbHBlcnMvZGV2aWNlJztcbmltcG9ydCB7IGhhbmRsZUNsaWVudE5vdGlmaWNhdGlvbnMsIGNsaWVudE5vdGlmaWNhdGlvbnMgfSBmcm9tICcuL0hlbHBlcnMvY2xpZW50LW5vdGlmaWNhdGlvbnMnO1xuaW1wb3J0IHsgYnVpbGRDdXJyZW5jaWVzTGlzdCB9IGZyb20gJy4vTW9kdWxlcy9UcmFkaW5nL0hlbHBlcnMvY3VycmVuY3knO1xuXG5jb25zdCBMQU5HVUFHRV9LRVkgPSAnaTE4bl9sYW5ndWFnZSc7XG5jb25zdCBzdG9yYWdlX2tleSA9ICdjbGllbnQuYWNjb3VudHMnO1xuY29uc3Qgc3RvcmVfbmFtZSA9ICdjbGllbnRfc3RvcmUnO1xuY29uc3QgZXVfc2hvcnRjb2RlX3JlZ2V4ID0gbmV3IFJlZ0V4cCgnXihtYWx0YWludmVzdHxtYWx0YXxpb20pJCcpO1xuY29uc3QgZXVfZXhjbHVkZWRfcmVnZXggPSBuZXcgUmVnRXhwKCdebXQkJyk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENsaWVudFN0b3JlIGV4dGVuZHMgQmFzZVN0b3JlIHtcbiAgICBAb2JzZXJ2YWJsZSBsb2dpbmlkO1xuICAgIEBvYnNlcnZhYmxlIHByZWZlcnJlZF9sYW5ndWFnZTtcbiAgICBAb2JzZXJ2YWJsZSB1cGdyYWRlX2luZm87XG4gICAgQG9ic2VydmFibGUgZW1haWw7XG4gICAgQG9ic2VydmFibGUgYWNjb3VudHMgPSB7fTtcbiAgICBAb2JzZXJ2YWJsZSBwcmVfc3dpdGNoX2Jyb2FkY2FzdCA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIHN3aXRjaGVkID0gJyc7XG4gICAgQG9ic2VydmFibGUgaXNfc3dpdGNoaW5nID0gZmFsc2U7XG4gICAgQG9ic2VydmFibGUgc3dpdGNoX2Jyb2FkY2FzdCA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIGluaXRpYWxpemVkX2Jyb2FkY2FzdCA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIGN1cnJlbmNpZXNfbGlzdCA9IHt9O1xuICAgIEBvYnNlcnZhYmxlIHJlc2lkZW5jZV9saXN0ID0gW107XG4gICAgQG9ic2VydmFibGUgc3RhdGVzX2xpc3QgPSBbXTtcbiAgICBAb2JzZXJ2YWJsZSBzZWxlY3RlZF9jdXJyZW5jeSA9ICcnO1xuICAgIEBvYnNlcnZhYmxlIGlzX3BvcHVsYXRpbmdfYWNjb3VudF9saXN0ID0gZmFsc2U7XG4gICAgQG9ic2VydmFibGUgaXNfcG9wdWxhdGluZ19tdDVfYWNjb3VudF9saXN0ID0gdHJ1ZTtcbiAgICBAb2JzZXJ2YWJsZSBpc19wb3B1bGF0aW5nX2R4dHJhZGVfYWNjb3VudF9saXN0ID0gdHJ1ZTtcbiAgICBAb2JzZXJ2YWJsZSBoYXNfcmVhbGl0eV9jaGVjayA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIGlzX3JlYWxpdHlfY2hlY2tfZGlzbWlzc2VkO1xuICAgIEBvYnNlcnZhYmxlIHJlYWxpdHlfY2hlY2tfZHVyO1xuICAgIEBvYnNlcnZhYmxlIHJlYWxpdHlfY2hlY2tfdGltZW91dDtcbiAgICBAb2JzZXJ2YWJsZSB3ZWJzaXRlX3N0YXR1cyA9IHt9O1xuICAgIEBvYnNlcnZhYmxlIGFjY291bnRfc2V0dGluZ3MgPSB7fTtcbiAgICBAb2JzZXJ2YWJsZSBhY2NvdW50X3N0YXR1cyA9IHt9O1xuICAgIEBvYnNlcnZhYmxlIGRldmljZV9kYXRhID0ge307XG4gICAgQG9ic2VydmFibGUgaXNfbG9nZ2luZ19pbiA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIGhhc19sb2dnZWRfb3V0ID0gZmFsc2U7XG4gICAgQG9ic2VydmFibGUgaXNfbGFuZGluZ19jb21wYW55X2xvYWRlZCA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIGlzX2FjY291bnRfc2V0dGluZ19sb2FkZWQgPSBmYWxzZTtcblxuICAgIC8vIFRPRE86IFRlbXBvcmFyeSB2YXJpYWJsZS4gUmVtb3ZlIGFmdGVyIE1YIGFjY291bnQgY2xvc3VyZSBoYXMgZmluaXNoZWQuXG4gICAgQG9ic2VydmFibGUgY2xpZW50X25vdGlmaWNhdGlvbnMgPSBjbGllbnROb3RpZmljYXRpb25zO1xuXG4gICAgLy8gdGhpcyB3aWxsIHN0b3JlIHRoZSBsYW5kaW5nX2NvbXBhbnkgQVBJIHJlc3BvbnNlLCBpbmNsdWRpbmdcbiAgICAvLyBmaW5hbmNpYWxfY29tcGFueToge31cbiAgICAvLyBnYW1pbmdfY29tcGFueToge31cbiAgICAvLyBtdF9maW5hbmNpYWxfY29tcGFueToge31cbiAgICAvLyBtdF9nYW1pbmdfY29tcGFueToge31cbiAgICBAb2JzZXJ2YWJsZSBsYW5kaW5nX2NvbXBhbmllcyA9IHt9O1xuXG4gICAgLy8gQWxsIHBvc3NpYmxlIGxhbmRpbmcgY29tcGFuaWVzIG9mIHVzZXIgYmV0d2VlbiBhbGxcbiAgICBAb2JzZXJ2YWJsZSBzdGFuZHBvaW50ID0ge1xuICAgICAgICBpb206IGZhbHNlLFxuICAgICAgICBzdmc6IGZhbHNlLFxuICAgICAgICBtYWx0YTogZmFsc2UsXG4gICAgICAgIG1hbHRhaW52ZXN0OiBmYWxzZSxcbiAgICAgICAgZ2FtaW5nX2NvbXBhbnk6IGZhbHNlLFxuICAgICAgICBmaW5hbmNpYWxfY29tcGFueTogZmFsc2UsXG4gICAgfTtcblxuICAgIEBvYnNlcnZhYmxlIHVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzID0gW107XG4gICAgQG9ic2VydmFibGUgbXQ1X2Rpc2FibGVkX3NpZ251cF90eXBlcyA9IHsgcmVhbDogZmFsc2UsIGRlbW86IGZhbHNlIH07XG4gICAgQG9ic2VydmFibGUgbXQ1X2xvZ2luX2xpc3QgPSBbXTtcbiAgICBAb2JzZXJ2YWJsZSBtdDVfbG9naW5fbGlzdF9lcnJvciA9IG51bGw7XG4gICAgQG9ic2VydmFibGUgZHh0cmFkZV9hY2NvdW50c19saXN0ID0gW107XG4gICAgQG9ic2VydmFibGUgZHh0cmFkZV9hY2NvdW50c19saXN0X2Vycm9yID0gbnVsbDtcbiAgICBAb2JzZXJ2YWJsZSBkeHRyYWRlX2Rpc2FibGVkX3NpZ251cF90eXBlcyA9IHsgcmVhbDogZmFsc2UsIGRlbW86IGZhbHNlIH07XG4gICAgQG9ic2VydmFibGUgc3RhdGVtZW50ID0gW107XG4gICAgQG9ic2VydmFibGUgb2JqX3RvdGFsX2JhbGFuY2UgPSB7XG4gICAgICAgIGFtb3VudF9yZWFsOiB1bmRlZmluZWQsXG4gICAgICAgIGFtb3VudF9tdDU6IHVuZGVmaW5lZCxcbiAgICAgICAgYW1vdW50X2R4dHJhZGU6IHVuZGVmaW5lZCxcbiAgICAgICAgY3VycmVuY3k6ICcnLFxuICAgIH07XG5cbiAgICBAb2JzZXJ2YWJsZSB2ZXJpZmljYXRpb25fY29kZSA9IHtcbiAgICAgICAgc2lnbnVwOiAnJyxcbiAgICAgICAgcmVzZXRfcGFzc3dvcmQ6ICcnLFxuICAgICAgICBwYXltZW50X3dpdGhkcmF3OiAnJyxcbiAgICAgICAgcGF5bWVudF9hZ2VudF93aXRoZHJhdzogJycsXG4gICAgICAgIHRyYWRpbmdfcGxhdGZvcm1fbXQ1X3Bhc3N3b3JkX3Jlc2V0OiAnJyxcbiAgICAgICAgdHJhZGluZ19wbGF0Zm9ybV9keHRyYWRlX3Bhc3N3b3JkX3Jlc2V0OiAnJyxcbiAgICB9O1xuICAgIEBvYnNlcnZhYmxlIGFjY291bnRfbGltaXRzID0ge307XG5cbiAgICBAb2JzZXJ2YWJsZSBzZWxmX2V4Y2x1c2lvbiA9IHt9O1xuXG4gICAgQG9ic2VydmFibGUgbG9jYWxfY3VycmVuY3lfY29uZmlnID0ge1xuICAgICAgICBjdXJyZW5jeTogJycsXG4gICAgICAgIGRlY2ltYWxfcGxhY2VzOiB1bmRlZmluZWQsXG4gICAgfTtcbiAgICBAb2JzZXJ2YWJsZSBoYXNfY29va2llX2FjY291bnQgPSBmYWxzZTtcblxuICAgIEBvYnNlcnZhYmxlIGZpbmFuY2lhbF9hc3Nlc3NtZW50ID0gbnVsbDtcblxuICAgIEBvYnNlcnZhYmxlIG10NV90cmFkaW5nX3NlcnZlcnMgPSBbXTtcbiAgICBAb2JzZXJ2YWJsZSBkeHRyYWRlX3RyYWRpbmdfc2VydmVycyA9IFtdO1xuXG4gICAgaXNfbXQ1X2FjY291bnRfbGlzdF91cGRhdGVkID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3Rvcihyb290X3N0b3JlKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsX3N0b3JhZ2VfcHJvcGVydGllcyA9IFsnZGV2aWNlX2RhdGEnXTtcbiAgICAgICAgc3VwZXIoeyByb290X3N0b3JlLCBsb2NhbF9zdG9yYWdlX3Byb3BlcnRpZXMsIHN0b3JlX25hbWUgfSk7XG5cbiAgICAgICAgcmVhY3Rpb24oXG4gICAgICAgICAgICAoKSA9PiBbXG4gICAgICAgICAgICAgICAgdGhpcy5pc19sb2dnZWRfaW4sXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dpbmlkLFxuICAgICAgICAgICAgICAgIHRoaXMuZW1haWwsXG4gICAgICAgICAgICAgICAgdGhpcy5sYW5kaW5nX2NvbXBhbnksXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW5jeSxcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2lkZW5jZSxcbiAgICAgICAgICAgICAgICB0aGlzLmFjY291bnRfc2V0dGluZ3MsXG4gICAgICAgICAgICAgICAgdGhpcy5wcmVmZXJyZWRfbGFuZ3VhZ2UsXG4gICAgICAgICAgICBdLFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Q29va2llQWNjb3VudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICB3aGVuKFxuICAgICAgICAgICAgKCkgPT4gIXRoaXMuaXNfbG9nZ2VkX2luICYmIHRoaXMucm9vdF9zdG9yZS51aSAmJiB0aGlzLnJvb3Rfc3RvcmUudWkuaXNfcmVhbF9hY2Nfc2lnbnVwX29uLFxuICAgICAgICAgICAgKCkgPT4gdGhpcy5yb290X3N0b3JlLnVpLmNsb3NlUmVhbEFjY291bnRTaWdudXAoKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBiYWxhbmNlKCkge1xuICAgICAgICBpZiAoaXNFbXB0eU9iamVjdCh0aGlzLmFjY291bnRzKSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXSAmJiAnYmFsYW5jZScgaW4gdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdXG4gICAgICAgICAgICA/IHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5iYWxhbmNlLnRvU3RyaW5nKClcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc19yZWFsaXR5X2NoZWNrX3Zpc2libGUoKSB7XG4gICAgICAgIGlmICghdGhpcy5sb2dpbmlkIHx8ICF0aGlzLmxhbmRpbmdfY29tcGFueSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhISh0aGlzLmhhc19yZWFsaXR5X2NoZWNrICYmICF0aGlzLnJlYWxpdHlfY2hlY2tfZGlzbWlzc2VkKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfc3ZnKCkge1xuICAgICAgICBpZiAoIXRoaXMubGFuZGluZ19jb21wYW55X3Nob3J0Y29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmxhbmRpbmdfY29tcGFueV9zaG9ydGNvZGUgPT09ICdzdmcnIHx8IHRoaXMubGFuZGluZ19jb21wYW55X3Nob3J0Y29kZSA9PT0gJ2Nvc3RhcmljYSc7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IHJlYWxpdHlfY2hlY2tfZHVyYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc19yZWFsaXR5X2NoZWNrID8gdGhpcy5yZWFsaXR5X2NoZWNrX2R1ciB8fCArTG9jYWxTdG9yZS5nZXQoJ3JlYWxpdHlfY2hlY2tfZHVyYXRpb24nKSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgcmVhbGl0eV9jaGVja19kaXNtaXNzZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc19yZWFsaXR5X2NoZWNrXG4gICAgICAgICAgICA/IHRoaXMuaXNfcmVhbGl0eV9jaGVja19kaXNtaXNzZWQgfHwgSlNPTi5wYXJzZShMb2NhbFN0b3JlLmdldCgncmVhbGl0eV9jaGVja19kaXNtaXNzZWQnKSB8fCBmYWxzZSlcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBoYXNfYWN0aXZlX3JlYWxfYWNjb3VudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlX2FjY291bnRzLnNvbWUoYWNjID0+IGFjYy5pc192aXJ0dWFsID09PSAwKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX21hbHRhaW52ZXN0X2FjY291bnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZV9hY2NvdW50cy5zb21lKGFjYyA9PiBhY2MubGFuZGluZ19jb21wYW55X3Nob3J0Y29kZSA9PT0gJ21hbHRhaW52ZXN0Jyk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGhhc19tYWx0YV9hY2NvdW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVfYWNjb3VudHMuc29tZShhY2MgPT4gYWNjLmxhbmRpbmdfY29tcGFueV9zaG9ydGNvZGUgPT09ICdtYWx0YScpO1xuICAgIH1cblxuICAgIGhhc0FueVJlYWxBY2NvdW50ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50X2xpc3Quc29tZShhY2MgPT4gYWNjLmlzX3ZpcnR1YWwgPT09IDApO1xuICAgIH07XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX2FueV9yZWFsX2FjY291bnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0FueVJlYWxBY2NvdW50KCk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGZpcnN0X3N3aXRjaGFibGVfcmVhbF9sb2dpbmlkKCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmFjdGl2ZV9hY2NvdW50cy5maW5kKFxuICAgICAgICAgICAgYWNjID0+IGFjYy5pc192aXJ0dWFsID09PSAwICYmIGFjYy5sYW5kaW5nX2NvbXBhbnlfc2hvcnRjb2RlID09PSAnc3ZnJ1xuICAgICAgICApO1xuICAgICAgICByZXR1cm4gcmVzdWx0LmxvZ2luaWQgfHwgdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBjYW5fY2hhbmdlX2ZpYXRfY3VycmVuY3koKSB7XG4gICAgICAgIGNvbnN0IGhhc19ub19tdDUgPSAhdGhpcy5oYXNfcmVhbF9tdDVfbG9naW47XG4gICAgICAgIGNvbnN0IGhhc19ub19keHRyYWRlID0gIXRoaXMuaGFzX3JlYWxfZHh0cmFkZV9sb2dpbjtcbiAgICAgICAgY29uc3QgaGFzX25vX3RyYW5zYWN0aW9uID0gdGhpcy5zdGF0ZW1lbnQuY291bnQgPT09IDAgJiYgdGhpcy5zdGF0ZW1lbnQudHJhbnNhY3Rpb25zLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgY29uc3QgaGFzX2FjY291bnRfY3JpdGVyaWEgPSBoYXNfbm9fdHJhbnNhY3Rpb24gJiYgaGFzX25vX210NSAmJiBoYXNfbm9fZHh0cmFkZTtcbiAgICAgICAgcmV0dXJuICF0aGlzLmlzX3ZpcnR1YWwgJiYgaGFzX2FjY291bnRfY3JpdGVyaWEgJiYgdGhpcy5jdXJyZW50X2N1cnJlbmN5X3R5cGUgPT09ICdmaWF0JztcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgbGVnYWxfYWxsb3dlZF9jdXJyZW5jaWVzKCkge1xuICAgICAgICBjb25zdCBnZXREZWZhdWx0QWxsb3dlZEN1cnJlbmNpZXMgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5sYW5kaW5nX2NvbXBhbmllcy5nYW1pbmdfY29tcGFueSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmxhbmRpbmdfY29tcGFuaWVzLmdhbWluZ19jb21wYW55LmxlZ2FsX2FsbG93ZWRfY3VycmVuY2llcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmxhbmRpbmdfY29tcGFuaWVzLmZpbmFuY2lhbF9jb21wYW55KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFuZGluZ19jb21wYW5pZXMuZmluYW5jaWFsX2NvbXBhbnkubGVnYWxfYWxsb3dlZF9jdXJyZW5jaWVzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmICghdGhpcy5sYW5kaW5nX2NvbXBhbmllcyB8fCAhdGhpcy5yb290X3N0b3JlLnVpKSByZXR1cm4gW107XG4gICAgICAgIGlmICghdGhpcy5yb290X3N0b3JlLnVpLnJlYWxfYWNjb3VudF9zaWdudXBfdGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0RGVmYXVsdEFsbG93ZWRDdXJyZW5jaWVzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgWydzZXRfY3VycmVuY3knLCAnbWFuYWdlJ10uaW5jbHVkZXModGhpcy5yb290X3N0b3JlLnVpLnJlYWxfYWNjb3VudF9zaWdudXBfdGFyZ2V0KSAmJlxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2xhbmRpbmdfY29tcGFueVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRfbGFuZGluZ19jb21wYW55LmxlZ2FsX2FsbG93ZWRfY3VycmVuY2llcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLnJvb3Rfc3RvcmUudWkucmVhbF9hY2NvdW50X3NpZ251cF90YXJnZXQgPT09ICdtYWx0YWludmVzdCcgPyAnZmluYW5jaWFsJyA6ICdnYW1pbmcnO1xuXG4gICAgICAgIGlmICh0aGlzLmxhbmRpbmdfY29tcGFuaWVzW2Ake3RhcmdldH1fY29tcGFueWBdKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYW5kaW5nX2NvbXBhbmllc1tgJHt0YXJnZXR9X2NvbXBhbnlgXS5sZWdhbF9hbGxvd2VkX2N1cnJlbmNpZXM7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZ2V0RGVmYXVsdEFsbG93ZWRDdXJyZW5jaWVzKCk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IHVwZ3JhZGVhYmxlX2N1cnJlbmNpZXMoKSB7XG4gICAgICAgIGlmICghdGhpcy5sZWdhbF9hbGxvd2VkX2N1cnJlbmNpZXMgfHwgIXRoaXMud2Vic2l0ZV9zdGF0dXMuY3VycmVuY2llc19jb25maWcpIHJldHVybiBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVnYWxfYWxsb3dlZF9jdXJyZW5jaWVzLm1hcChjdXJyZW5jeSA9PiAoe1xuICAgICAgICAgICAgdmFsdWU6IGN1cnJlbmN5LFxuICAgICAgICAgICAgLi4udGhpcy53ZWJzaXRlX3N0YXR1cy5jdXJyZW5jaWVzX2NvbmZpZ1tjdXJyZW5jeV0sXG4gICAgICAgIH0pKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgY3VycmVudF9jdXJyZW5jeV90eXBlKCkge1xuICAgICAgICBpZiAodGhpcy5hY2NvdW50X3R5cGUgPT09ICd2aXJ0dWFsJykgcmV0dXJuICd2aXJ0dWFsJztcbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgdGhpcy53ZWJzaXRlX3N0YXR1cyAmJlxuICAgICAgICAgICAgdGhpcy53ZWJzaXRlX3N0YXR1cy5jdXJyZW5jaWVzX2NvbmZpZyAmJlxuICAgICAgICAgICAgdGhpcy53ZWJzaXRlX3N0YXR1cy5jdXJyZW5jaWVzX2NvbmZpZ1t0aGlzLmN1cnJlbmN5XVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndlYnNpdGVfc3RhdHVzLmN1cnJlbmNpZXNfY29uZmlnW3RoaXMuY3VycmVuY3ldLnR5cGU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBhdmFpbGFibGVfY3J5cHRvX2N1cnJlbmNpZXMoKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXModGhpcy5hY2NvdW50cykucmVkdWNlKChhY2MsIGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGFjYy5wdXNoKGl0ZW0uY3VycmVuY3kpO1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwgW10pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnVwZ3JhZGVhYmxlX2N1cnJlbmNpZXMuZmlsdGVyKGFjYyA9PiAhdmFsdWVzLmluY2x1ZGVzKGFjYy52YWx1ZSkgJiYgYWNjLnR5cGUgPT09ICdjcnlwdG8nKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX2lvbV9hY2NvdW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVfYWNjb3VudHMuc29tZShhY2MgPT4gYWNjLmxhbmRpbmdfY29tcGFueV9zaG9ydGNvZGUgPT09ICdpb20nKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX2ZpYXQoKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXModGhpcy5hY2NvdW50cykucmVkdWNlKChhY2MsIGl0ZW0pID0+IHtcbiAgICAgICAgICAgIGlmICghaXRlbS5pc192aXJ0dWFsKSB7XG4gICAgICAgICAgICAgICAgYWNjLnB1c2goaXRlbS5jdXJyZW5jeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICB9LCBbXSk7XG4gICAgICAgIHJldHVybiAhIXRoaXMudXBncmFkZWFibGVfY3VycmVuY2llcy5maWx0ZXIoYWNjID0+IHZhbHVlcy5pbmNsdWRlcyhhY2MudmFsdWUpICYmIGFjYy50eXBlID09PSAnZmlhdCcpLmxlbmd0aDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgY3VycmVudF9maWF0X2N1cnJlbmN5KCkge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QudmFsdWVzKHRoaXMuYWNjb3VudHMpLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWl0ZW0uaXNfdmlydHVhbCkge1xuICAgICAgICAgICAgICAgIGFjYy5wdXNoKGl0ZW0uY3VycmVuY3kpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwgW10pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmhhc19maWF0XG4gICAgICAgICAgICA/IHRoaXMudXBncmFkZWFibGVfY3VycmVuY2llcy5maWx0ZXIoYWNjID0+IHZhbHVlcy5pbmNsdWRlcyhhY2MudmFsdWUpICYmIGFjYy50eXBlID09PSAnZmlhdCcpWzBdLnZhbHVlXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvLyByZXR1cm4gdGhlIGxhbmRpbmcgY29tcGFueSBvYmplY3QgdGhhdCBiZWxvbmdzIHRvIHRoZSBjdXJyZW50IGNsaWVudCBieSBtYXRjaGluZyBzaG9ydGNvZGVcbiAgICAvLyBub3RlIHRoYXQgaXQgd2lsbCBiZSB1bmRlZmluZWQgZm9yIGxvZ2dlZCBvdXQgYW5kIHZpcnR1YWwgY2xpZW50c1xuICAgIEBjb21wdXRlZFxuICAgIGdldCBjdXJyZW50X2xhbmRpbmdfY29tcGFueSgpIHtcbiAgICAgICAgY29uc3QgbGFuZGluZ19jb21wYW55ID1cbiAgICAgICAgICAgIHRoaXMubGFuZGluZ19jb21wYW5pZXMgJiZcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMubGFuZGluZ19jb21wYW5pZXMpLmZpbmQoXG4gICAgICAgICAgICAgICAgY29tcGFueSA9PiB0aGlzLmxhbmRpbmdfY29tcGFuaWVzW2NvbXBhbnldPy5zaG9ydGNvZGUgPT09IHRoaXMubGFuZGluZ19jb21wYW55X3Nob3J0Y29kZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGxhbmRpbmdfY29tcGFueSA/IHRoaXMubGFuZGluZ19jb21wYW5pZXNbbGFuZGluZ19jb21wYW55XSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgYWNjb3VudF9saXN0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hbGxfbG9naW5pZHMubWFwKGlkID0+IHRoaXMuZ2V0QWNjb3VudEluZm8oaWQpKS5maWx0ZXIoYWNjb3VudCA9PiBhY2NvdW50KTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX3JlYWxfbXQ1X2xvZ2luKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdDVfbG9naW5fbGlzdC5zb21lKGFjY291bnQgPT4gYWNjb3VudC5hY2NvdW50X3R5cGUgPT09ICdyZWFsJyk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGhhc19yZWFsX2R4dHJhZGVfbG9naW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmR4dHJhZGVfYWNjb3VudHNfbGlzdC5zb21lKGFjY291bnQgPT4gYWNjb3VudC5hY2NvdW50X3R5cGUgPT09ICdyZWFsJyk7XG4gICAgfVxuXG4gICAgaGFzQWNjb3VudEVycm9ySW5DRkRMaXN0ID0gKHBsYXRmb3JtLCBhY2NvdW50X3R5cGUpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmlzX2xvZ2dlZF9pbikgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGxpc3QgPSBwbGF0Zm9ybSA9PT0gQ0ZEX1BMQVRGT1JNUy5NVDUgPyB0aGlzLm10NV9sb2dpbl9saXN0IDogdGhpcy5keHRyYWRlX2FjY291bnRzX2xpc3Q7XG4gICAgICAgIHJldHVybiBsaXN0Py5zb21lKGFjY291bnQgPT4gISFhY2NvdW50Lmhhc19lcnJvciAmJiBhY2NvdW50LmFjY291bnRfdHlwZSA9PT0gYWNjb3VudF90eXBlKTtcbiAgICB9O1xuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGhhc19hY2NvdW50X2Vycm9yX2luX210NV9yZWFsX2xpc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0FjY291bnRFcnJvckluQ0ZETGlzdChDRkRfUExBVEZPUk1TLk1UNSwgJ3JlYWwnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX2FjY291bnRfZXJyb3JfaW5fbXQ1X2RlbW9fbGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzQWNjb3VudEVycm9ySW5DRkRMaXN0KENGRF9QTEFURk9STVMuTVQ1LCAnZGVtbycpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBoYXNfYWNjb3VudF9lcnJvcl9pbl9keHRyYWRlX3JlYWxfbGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzQWNjb3VudEVycm9ySW5DRkRMaXN0KENGRF9QTEFURk9STVMuRFhUUkFERSwgJ3JlYWwnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX2FjY291bnRfZXJyb3JfaW5fZHh0cmFkZV9kZW1vX2xpc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0FjY291bnRFcnJvckluQ0ZETGlzdChDRkRfUExBVEZPUk1TLkRYVFJBREUsICdkZW1vJyk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGNhbl9oYXZlX21vcmVfcmVhbF9zeW50aGV0aWNfbXQ1KCkge1xuICAgICAgICBjb25zdCBudW1iZXJfb2ZfY3VycmVudF9hZGRlZF9zeW50aGV0aWNzID0gdGhpcy5tdDVfbG9naW5fbGlzdC5yZWR1Y2UoKGFjYywgY3VyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpc19pbmNsdWRlZCA9XG4gICAgICAgICAgICAgICAgY3VyLmFjY291bnRfdHlwZSA9PT0gJ3JlYWwnICYmIChjdXIubWFya2V0X3R5cGUgPT09ICdzeW50aGV0aWMnIHx8IGN1ci5tYXJrZXRfdHlwZSA9PT0gJ2dhbWluZycpO1xuICAgICAgICAgICAgcmV0dXJuIGlzX2luY2x1ZGVkID8gYWNjICsgMSA6IGFjYztcbiAgICAgICAgfSwgMCk7XG4gICAgICAgIGNvbnN0IG51bWJlcl9vZl9hdmFpbGFibGVfc3ludGhldGljID0gdGhpcy5tdDVfdHJhZGluZ19zZXJ2ZXJzLnJlZHVjZShcbiAgICAgICAgICAgIChhY2MsIGN1cikgPT4gKGN1ci5zdXBwb3J0ZWRfYWNjb3VudHMuaW5jbHVkZXMoJ2dhbWluZycpICYmICFjdXIuZGlzYWJsZWQgPyBhY2MgKyAxIDogYWNjKSxcbiAgICAgICAgICAgIDBcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIG51bWJlcl9vZl9jdXJyZW50X2FkZGVkX3N5bnRoZXRpY3MgPiAwICYmIG51bWJlcl9vZl9hdmFpbGFibGVfc3ludGhldGljID4gMDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgYWN0aXZlX2FjY291bnRzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50cyBpbnN0YW5jZW9mIE9iamVjdFxuICAgICAgICAgICAgPyBPYmplY3QudmFsdWVzKHRoaXMuYWNjb3VudHMpLmZpbHRlcihhY2NvdW50ID0+ICFhY2NvdW50LmlzX2Rpc2FibGVkKVxuICAgICAgICAgICAgOiBbXTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgYWxsX2xvZ2luaWRzKCkge1xuICAgICAgICByZXR1cm4gIWlzRW1wdHlPYmplY3QodGhpcy5hY2NvdW50cykgPyBPYmplY3Qua2V5cyh0aGlzLmFjY291bnRzKSA6IFtdO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBhY2NvdW50X3RpdGxlKCkge1xuICAgICAgICByZXR1cm4gZ2V0QWNjb3VudFRpdGxlKHRoaXMubG9naW5pZCk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGN1cnJlbmN5KCkge1xuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZF9jdXJyZW5jeS5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkX2N1cnJlbmN5O1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNfbG9nZ2VkX2luKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdLmN1cnJlbmN5O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdF9jdXJyZW5jeTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgZGVmYXVsdF9jdXJyZW5jeSgpIHtcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuY3VycmVuY2llc19saXN0KS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5jdXJyZW5jaWVzX2xpc3QpO1xuICAgICAgICAgICAgLy8gRml4IGZvciBlZGdlIGNhc2Ugd2hlbiBsb2dnaW5nIG91dCBmcm9tIGNyeXB0byBhY2NvdW50cyBjYXVzZXMgRmlhdCBsaXN0IHRvIGJlIGVtcHR5XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW5jaWVzX2xpc3RbbG9jYWxpemUoJ0ZpYXQnKV0ubGVuZ3RoIDwgMSkgcmV0dXJuICdVU0QnO1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5jdXJyZW5jaWVzX2xpc3RbYCR7a2V5c1swXX1gXSlbMF0udGV4dDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAnVVNEJztcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgc2hvdWxkX2FsbG93X2F1dGhlbnRpY2F0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50X3N0YXR1cz8uc3RhdHVzPy5zb21lKFxuICAgICAgICAgICAgc3RhdHVzID0+IHN0YXR1cyA9PT0gJ2FsbG93X2RvY3VtZW50X3VwbG9hZCcgfHwgc3RhdHVzID09PSAnYWxsb3dfcG9pX3Jlc3VibWlzc2lvbidcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfYXV0aGVudGljYXRpb25fbmVlZGVkKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuaXNfZnVsbHlfYXV0aGVudGljYXRlZCAmJiAhIXRoaXMuYWNjb3VudF9zdGF0dXM/LmF1dGhlbnRpY2F0aW9uPy5uZWVkc192ZXJpZmljYXRpb24/Lmxlbmd0aDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfdG5jX25lZWRlZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNfdmlydHVhbCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IHsgY2xpZW50X3RuY19zdGF0dXMgfSA9IHRoaXMuYWNjb3VudF9zZXR0aW5ncztcbiAgICAgICAgY29uc3QgeyB0ZXJtc19jb25kaXRpb25zX3ZlcnNpb24gfSA9IHRoaXMud2Vic2l0ZV9zdGF0dXM7XG5cbiAgICAgICAgcmV0dXJuIHR5cGVvZiBjbGllbnRfdG5jX3N0YXR1cyAhPT0gJ3VuZGVmaW5lZCcgJiYgY2xpZW50X3RuY19zdGF0dXMgIT09IHRlcm1zX2NvbmRpdGlvbnNfdmVyc2lvbjtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfc29jaWFsX3NpZ251cCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWNjb3VudF9zdGF0dXM/LnN0YXR1cz8uaW5jbHVkZXMoJ3NvY2lhbF9zaWdudXAnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfbXQ1X3Bhc3N3b3JkX25vdF9zZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfc3RhdHVzPy5zdGF0dXM/LmluY2x1ZGVzKCdtdDVfcGFzc3dvcmRfbm90X3NldCcpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc19keHRyYWRlX3Bhc3N3b3JkX25vdF9zZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfc3RhdHVzPy5zdGF0dXM/LmluY2x1ZGVzKCdkeHRyYWRlX3Bhc3N3b3JkX25vdF9zZXQnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfZmluYW5jaWFsX2luZm9ybWF0aW9uX2luY29tcGxldGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfc3RhdHVzPy5zdGF0dXM/LnNvbWUoc3RhdHVzID0+IHN0YXR1cyA9PT0gJ2ZpbmFuY2lhbF9pbmZvcm1hdGlvbl9ub3RfY29tcGxldGUnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfZGVwb3NpdF9sb2NrKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50X3N0YXR1cz8uc3RhdHVzPy5zb21lKHN0YXR1c19uYW1lID0+IHN0YXR1c19uYW1lID09PSAnZGVwb3NpdF9sb2NrZWQnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfd2l0aGRyYXdhbF9sb2NrKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50X3N0YXR1cz8uc3RhdHVzPy5zb21lKHN0YXR1c19uYW1lID0+IHN0YXR1c19uYW1lID09PSAnd2l0aGRyYXdhbF9sb2NrZWQnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfdHJhZGluZ19leHBlcmllbmNlX2luY29tcGxldGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfc3RhdHVzPy5zdGF0dXM/LnNvbWUoc3RhdHVzID0+IHN0YXR1cyA9PT0gJ3RyYWRpbmdfZXhwZXJpZW5jZV9ub3RfY29tcGxldGUnKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgYXV0aGVudGljYXRpb25fc3RhdHVzKCkge1xuICAgICAgICBjb25zdCBkb2N1bWVudF9zdGF0dXMgPSB0aGlzLmFjY291bnRfc3RhdHVzPy5hdXRoZW50aWNhdGlvbj8uZG9jdW1lbnQ/LnN0YXR1cztcbiAgICAgICAgY29uc3QgaWRlbnRpdHlfc3RhdHVzID0gdGhpcy5hY2NvdW50X3N0YXR1cz8uYXV0aGVudGljYXRpb24/LmlkZW50aXR5Py5zdGF0dXM7XG4gICAgICAgIHJldHVybiB7IGRvY3VtZW50X3N0YXR1cywgaWRlbnRpdHlfc3RhdHVzIH07XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IHNvY2lhbF9pZGVudGl0eV9wcm92aWRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWNjb3VudF9zdGF0dXM/LnNvY2lhbF9pZGVudGl0eV9wcm92aWRlcjtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfZnJvbV9yZXN0cmljdGVkX2NvdW50cnkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc2lkZW5jZV9saXN0LmZpbmQoaXRlbSA9PiBpdGVtLnZhbHVlID09PSB0aGlzLnJlc2lkZW5jZSk/LmRpc2FibGVkID09PSAnRElTQUJMRUQnO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc19mdWxseV9hdXRoZW50aWNhdGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50X3N0YXR1cz8uc3RhdHVzPy5zb21lKHN0YXR1cyA9PiBzdGF0dXMgPT09ICdhdXRoZW50aWNhdGVkJyk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGlzX3BlbmRpbmdfYXV0aGVudGljYXRpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfc3RhdHVzPy5zdGF0dXM/LnNvbWUoc3RhdHVzID0+IHN0YXR1cyA9PT0gJ2RvY3VtZW50X3VuZGVyX3JldmlldycpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc19maW5hbmNpYWxfYWNjb3VudCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmxhbmRpbmdfY29tcGFuaWVzKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfdHlwZSA9PT0gJ2ZpbmFuY2lhbCc7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGlzX2FnZV92ZXJpZmllZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWNjb3VudF9zdGF0dXM/LnN0YXR1cz8uc29tZShzdGF0dXMgPT4gc3RhdHVzID09PSAnYWdlX3ZlcmlmaWNhdGlvbicpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBsYW5kaW5nX2NvbXBhbnlfc2hvcnRjb2RlKCkge1xuICAgICAgICBpZiAodGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdLmxhbmRpbmdfY29tcGFueV9zaG9ydGNvZGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgbGFuZGluZ19jb21wYW55KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sYW5kaW5nX2NvbXBhbmllcztcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfdmFsaWRfbG9naW4oKSB7XG4gICAgICAgIGlmICghdGhpcy5pc19sb2dnZWRfaW4pIHJldHVybiB0cnVlO1xuICAgICAgICBjb25zdCB2YWxpZF9sb2dpbl9pZHNfcmVnZXggPSBuZXcgUmVnRXhwKCdeKE1YfE1GfFZSVEN8TUxUfENSfEZPRylbMC05XSskJywgJ2knKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsX2xvZ2luaWRzLmV2ZXJ5KGlkID0+IHZhbGlkX2xvZ2luX2lkc19yZWdleC50ZXN0KGlkKSk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGlzX2xvZ2dlZF9pbigpIHtcbiAgICAgICAgcmV0dXJuICEhKFxuICAgICAgICAgICAgIWlzRW1wdHlPYmplY3QodGhpcy5hY2NvdW50cykgJiZcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuYWNjb3VudHMpLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICAgIHRoaXMubG9naW5pZCAmJlxuICAgICAgICAgICAgdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdLnRva2VuXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGlzX3ZpcnR1YWwoKSB7XG4gICAgICAgIHJldHVybiAhaXNFbXB0eU9iamVjdCh0aGlzLmFjY291bnRzKSAmJiB0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0gJiYgISF0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0uaXNfdmlydHVhbDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfZXUoKSB7XG4gICAgICAgIGlmICghdGhpcy5sYW5kaW5nX2NvbXBhbmllcykgcmV0dXJuIGZhbHNlO1xuICAgICAgICBjb25zdCB7IGdhbWluZ19jb21wYW55LCBmaW5hbmNpYWxfY29tcGFueSB9ID0gdGhpcy5sYW5kaW5nX2NvbXBhbmllcztcbiAgICAgICAgY29uc3QgZmluYW5jaWFsX3Nob3J0Y29kZSA9IGZpbmFuY2lhbF9jb21wYW55Py5zaG9ydGNvZGU7XG4gICAgICAgIGNvbnN0IGdhbWluZ19zaG9ydGNvZGUgPSBnYW1pbmdfY29tcGFueT8uc2hvcnRjb2RlO1xuICAgICAgICByZXR1cm4gZmluYW5jaWFsX3Nob3J0Y29kZSB8fCBnYW1pbmdfc2hvcnRjb2RlXG4gICAgICAgICAgICA/IGV1X3Nob3J0Y29kZV9yZWdleC50ZXN0KGZpbmFuY2lhbF9zaG9ydGNvZGUpIHx8IGV1X3Nob3J0Y29kZV9yZWdleC50ZXN0KGdhbWluZ19zaG9ydGNvZGUpXG4gICAgICAgICAgICA6IGV1X2V4Y2x1ZGVkX3JlZ2V4LnRlc3QodGhpcy5yZXNpZGVuY2UpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc191aygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVzaWRlbmNlID09PSAnZ2InO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBjb3VudHJ5X3N0YW5kcG9pbnQoKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHtcbiAgICAgICAgICAgIGlzX3VuaXRlZF9raW5nZG9tOiB0aGlzLmlzX3VrLFxuICAgICAgICAgICAgaXNfaXNsZV9vZl9tYW46IHRoaXMucmVzaWRlbmNlID09PSAnaW0nLFxuICAgICAgICAgICAgaXNfZnJhbmNlOiB0aGlzLnJlc2lkZW5jZSA9PT0gJ2ZyJyxcbiAgICAgICAgICAgIGlzX2JlbGdpdW06IHRoaXMucmVzaWRlbmNlID09PSAnYmUnLFxuICAgICAgICAgICAgLy8gT3RoZXIgRVUgY291bnRyaWVzOiBHZXJtYW55LCBTcGFpbiwgSXRhbHksIEx1eGVtYm91cmcgYW5kIEdyZWVjZVxuICAgICAgICAgICAgaXNfb3RoZXJfZXU6XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpZGVuY2UgPT09ICdkZScgfHxcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2lkZW5jZSA9PT0gJ2VzJyB8fFxuICAgICAgICAgICAgICAgIHRoaXMucmVzaWRlbmNlID09PSAnaXQnIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNpZGVuY2UgPT09ICdsdScgfHxcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2lkZW5jZSA9PT0gJ2dyJyxcbiAgICAgICAgfTtcblxuICAgICAgICByZXN1bHQuaXNfcmVzdF9vZl9ldSA9XG4gICAgICAgICAgICB0aGlzLmlzX2V1ICYmICFyZXN1bHQuaXNfdWsgJiYgIXJlc3VsdC5pc19mcmFuY2UgJiYgIXJlc3VsdC5pc19iZWxnaXVtICYmICFyZXN1bHQuaXNfb3RoZXJfZXU7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgY3VzdG9tX25vdGlmaWNhdGlvbnMoKSB7XG4gICAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbl9jb250ZW50ID0ge1xuICAgICAgICAgICAgbXhfbWx0X25vdGlmaWNhdGlvbjoge1xuICAgICAgICAgICAgICAgIGhlYWRlcjogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNfbWFsdGFfYWNjb3VudCB8fCB0aGlzLmNhbl9oYXZlX21sdF9hY2NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoJ1lvdXIgT3B0aW9ucyBhY2NvdW50IGlzIHNjaGVkdWxlZCB0byBiZSBjbG9zZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzX3VrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoJ1lvdXIgR2FtaW5nIGFjY291bnQgaXMgc2NoZWR1bGVkIHRvIGJlIGNsb3NlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZSgnWW91ciBhY2NvdW50IGlzIHNjaGVkdWxlZCB0byBiZSBjbG9zZWQnKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG1haW46ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzX21hbHRhX2FjY291bnQgfHwgdGhpcy5jYW5faGF2ZV9tbHRfYWNjb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsaXplKCdXaXRoZHJhdyBhbGwgZnVuZHMgZnJvbSB5b3VyIE9wdGlvbnMgYWNjb3VudC4nKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzX3VrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxpemUoJ1BsZWFzZSB3aXRoZHJhdyBhbGwgeW91ciBmdW5kcyBhcyBzb29uIGFzIHBvc3NpYmxlLicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbGl6ZSgnUGxlYXNlIHByb2NlZWQgdG8gd2l0aGRyYXcgeW91ciBmdW5kcyBiZWZvcmUgMzAgTm92ZW1iZXIgMjAyMS4nKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIG5vdGlmaWNhdGlvbl9jb250ZW50O1xuICAgIH1cblxuICAgIC8vIE1hbnVhbCBsaXN0IG9mIE1MVCBjb3VudHJpZXMgZHVyaW5nIE1MVC9NWCBhY2NvdW50IHJlbW92YWwuXG4gICAgLy8gQWxzbyBuZWVkZWQgdG8gY2hlY2sgb25ib2FyZGluZyBtb2RhbCB0ZXh0IGZvciBzcGVjaWZpYyBjb3VudHJ5LlxuICAgIEBjb21wdXRlZFxuICAgIGdldCBjYW5faGF2ZV9tbHRfYWNjb3VudCgpIHtcbiAgICAgICAgY29uc3QgY291bnRyaWVzID0gW1xuICAgICAgICAgICAgJ25sJyxcbiAgICAgICAgICAgICdjeScsXG4gICAgICAgICAgICAnaWUnLFxuICAgICAgICAgICAgJ3JvJyxcbiAgICAgICAgICAgICdiZScsXG4gICAgICAgICAgICAnbHQnLFxuICAgICAgICAgICAgJ2JnJyxcbiAgICAgICAgICAgICdjeicsXG4gICAgICAgICAgICAnZGsnLFxuICAgICAgICAgICAgJ3NlJyxcbiAgICAgICAgICAgICdwbCcsXG4gICAgICAgICAgICAnZWUnLFxuICAgICAgICAgICAgJ2hyJyxcbiAgICAgICAgICAgICdhdCcsXG4gICAgICAgICAgICAnaHUnLFxuICAgICAgICAgICAgJ3NsJyxcbiAgICAgICAgICAgICdmaScsXG4gICAgICAgICAgICAnc2snLFxuICAgICAgICAgICAgJ3B0JyxcbiAgICAgICAgICAgICdsdicsXG4gICAgICAgIF0uaW5jbHVkZXModGhpcy5yZXNpZGVuY2UpO1xuICAgICAgICByZXR1cm4gY291bnRyaWVzO1xuICAgIH1cblxuICAgIC8vIE1hbnVhbCBsaXN0IG9mIE1YIGNvdW50cmllcyBkdXJpbmcgTUxUL01YIGFjY291bnQgcmVtb3ZhbC5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgY2FuX2hhdmVfbXhfYWNjb3VudCgpIHtcbiAgICAgICAgY29uc3QgY291bnRyaWVzID0gWydnYicsICdpbSddLmluY2x1ZGVzKHRoaXMucmVzaWRlbmNlKTtcbiAgICAgICAgcmV0dXJuIGNvdW50cmllcztcbiAgICB9XG5cbiAgICAvLyBNYW51YWwgbGlzdCBvZiBNRiBjb3VudHJpZXMgZHVyaW5nIE1MVC9NWCBhY2NvdW50IHJlbW92YWwuXG4gICAgLy8gQWxzbyBuZWVkZWQgdG8gY2hlY2sgb25ib2FyZGluZyBtb2RhbCB0ZXh0IGZvciBzcGVjaWZpYyBjb3VudHJ5LlxuICAgIEBjb21wdXRlZFxuICAgIGdldCBjYW5faGF2ZV9tZl9hY2NvdW50KCkge1xuICAgICAgICBjb25zdCBjb3VudHJpZXMgPSBbXG4gICAgICAgICAgICAnaXQnLFxuICAgICAgICAgICAgJ2ZyJyxcbiAgICAgICAgICAgICdkZScsXG4gICAgICAgICAgICAnbHUnLFxuICAgICAgICAgICAgJ2VzJyxcbiAgICAgICAgICAgICdncicsXG4gICAgICAgICAgICAnbmwnLFxuICAgICAgICAgICAgJ2N5JyxcbiAgICAgICAgICAgICdpZScsXG4gICAgICAgICAgICAncm8nLFxuICAgICAgICAgICAgJ2x0JyxcbiAgICAgICAgICAgICdiZycsXG4gICAgICAgICAgICAnY3onLFxuICAgICAgICAgICAgJ2RrJyxcbiAgICAgICAgICAgICdzZScsXG4gICAgICAgICAgICAncGwnLFxuICAgICAgICAgICAgJ2VlJyxcbiAgICAgICAgICAgICdocicsXG4gICAgICAgICAgICAnYXQnLFxuICAgICAgICAgICAgJ2h1JyxcbiAgICAgICAgICAgICdzbCcsXG4gICAgICAgICAgICAnZmknLFxuICAgICAgICAgICAgJ3NrJyxcbiAgICAgICAgICAgICdwdCcsXG4gICAgICAgICAgICAnbHYnLFxuICAgICAgICBdLmluY2x1ZGVzKHRoaXMucmVzaWRlbmNlKTtcbiAgICAgICAgcmV0dXJuIGNvdW50cmllcztcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgY2FuX3VwZ3JhZGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVwZ3JhZGVfaW5mbyAmJiAodGhpcy51cGdyYWRlX2luZm8uY2FuX3VwZ3JhZGUgfHwgdGhpcy51cGdyYWRlX2luZm8uY2FuX29wZW5fbXVsdGkpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBjYW5fdXBncmFkZV90bygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXBncmFkZV9pbmZvICYmIHRoaXMudXBncmFkZV9pbmZvLmNhbl91cGdyYWRlX3RvO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCB2aXJ0dWFsX2FjY291bnRfbG9naW5pZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWxsX2xvZ2luaWRzLmZpbmQobG9naW5pZCA9PiAhIXRoaXMuYWNjb3VudHNbbG9naW5pZF0uaXNfdmlydHVhbCk7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGlzX3NpbmdsZV9jdXJyZW5jeSgpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuY3VycmVuY2llc19saXN0KVxuICAgICAgICAgICAgICAgIC5tYXAodHlwZSA9PiBPYmplY3QudmFsdWVzKHRoaXMuY3VycmVuY2llc19saXN0W3R5cGVdKS5sZW5ndGgpXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoYWNjLCBjdXIpID0+IGFjYyArIGN1ciwgMCkgPT09IDFcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgYWNjb3VudF90eXBlKCkge1xuICAgICAgICByZXR1cm4gZ2V0Q2xpZW50QWNjb3VudFR5cGUodGhpcy5sb2dpbmlkKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfbXQ1X2FsbG93ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzTVQ1QWxsb3dlZCh0aGlzLmxhbmRpbmdfY29tcGFuaWVzKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfZHh0cmFkZV9hbGxvd2VkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0R4dHJhZGVBbGxvd2VkKHRoaXMubGFuZGluZ19jb21wYW5pZXMpO1xuICAgIH1cblxuICAgIGlzTVQ1QWxsb3dlZCA9IGxhbmRpbmdfY29tcGFuaWVzID0+IHtcbiAgICAgICAgLy8gZGVmYXVsdCBhbGxvd2luZyBtdDUgdG8gdHJ1ZSBiZWZvcmUgbGFuZGluZ19jb21wYW5pZXMgZ2V0cyBwb3B1bGF0ZWRcbiAgICAgICAgLy8gc2luY2UgbW9zdCBjbGllbnRzIGFyZSBhbGxvd2VkIHRvIHVzZSBtdDVcbiAgICAgICAgaWYgKCFsYW5kaW5nX2NvbXBhbmllcyB8fCAhT2JqZWN0LmtleXMobGFuZGluZ19jb21wYW5pZXMpLmxlbmd0aCkgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgaWYgKCF0aGlzLm10NV9sb2dpbl9saXN0LnNvbWUoYWNjID0+IGFjYy5tYXJrZXRfdHlwZSA9PT0gJ3N5bnRoZXRpYycpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jb3VudHJ5X3N0YW5kcG9pbnQuaXNfYmVsZ2l1bSB8fCB0aGlzLmNvdW50cnlfc3RhbmRwb2ludC5pc19mcmFuY2UpIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAnbXRfZmluYW5jaWFsX2NvbXBhbnknIGluIGxhbmRpbmdfY29tcGFuaWVzIHx8ICdtdF9nYW1pbmdfY29tcGFueScgaW4gbGFuZGluZ19jb21wYW5pZXM7XG4gICAgfTtcblxuICAgIGlzRHh0cmFkZUFsbG93ZWQgPSBsYW5kaW5nX2NvbXBhbmllcyA9PiB7XG4gICAgICAgIC8vIFN0b3Agc2hvd2luZyBEZXJpdlggZm9yIG5vbi1sb2dnZWQgaW4gRVUgdXNlcnNcbiAgICAgICAgaWYgKCF0aGlzLmlzX2xvZ2dlZF9pbiAmJiB0aGlzLmlzX2V1X2NvdW50cnkpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBpZiAoIXRoaXMud2Vic2l0ZV9zdGF0dXM/LmNsaWVudHNfY291bnRyeSB8fCAhbGFuZGluZ19jb21wYW5pZXMgfHwgIU9iamVjdC5rZXlzKGxhbmRpbmdfY29tcGFuaWVzKS5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgJ2R4dHJhZGVfZmluYW5jaWFsX2NvbXBhbnknIGluIGxhbmRpbmdfY29tcGFuaWVzIHx8XG4gICAgICAgICAgICAnZHh0cmFkZV9nYW1pbmdfY29tcGFueScgaW4gbGFuZGluZ19jb21wYW5pZXMgfHxcbiAgICAgICAgICAgICghdGhpcy5pc19sb2dnZWRfaW4gJiYgIXRoaXMuaXNfZXUgJiYgIXRoaXMuaXNfZXVfY291bnRyeSlcbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGNsaWVudHNfY291bnRyeSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMud2Vic2l0ZV9zdGF0dXM/LmNsaWVudHNfY291bnRyeTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfZXVfY291bnRyeSgpIHtcbiAgICAgICAgY29uc3QgY291bnRyeSA9IHRoaXMud2Vic2l0ZV9zdGF0dXMuY2xpZW50c19jb3VudHJ5O1xuICAgICAgICBpZiAoY291bnRyeSkgcmV0dXJuIGlzRXVDb3VudHJ5KGNvdW50cnkpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGlzX29wdGlvbnNfYmxvY2tlZCgpIHtcbiAgICAgICAgcmV0dXJuIGlzT3B0aW9uc0Jsb2NrZWQodGhpcy5yZXNpZGVuY2UpO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc19tdWx0aXBsaWVyc19vbmx5KCkge1xuICAgICAgICByZXR1cm4gaXNNdWx0aXBsaWVyc09ubHkodGhpcy5yZXNpZGVuY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0b3JlIFZhbHVlcyByZWxldmFudCB0byB0aGUgbG9naW5pZCB0byBsb2NhbCBzdG9yYWdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGxvZ2luaWRcbiAgICAgKi9cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzZXRMb2NhbFN0b3JhZ2VWYWx1ZXMobG9naW5pZCkge1xuICAgICAgICB0aGlzLmFjY291bnRzW2xvZ2luaWRdLmFjY2VwdGVkX2JjaCA9IDA7XG4gICAgICAgIExvY2FsU3RvcmUuc2V0T2JqZWN0KHN0b3JhZ2Vfa2V5LCB0aGlzLmFjY291bnRzKTtcbiAgICAgICAgTG9jYWxTdG9yZS5zZXQoJ2FjdGl2ZV9sb2dpbmlkJywgbG9naW5pZCk7XG4gICAgICAgIHRoaXMuc3luY1dpdGhMZWdhY3lQbGF0Zm9ybXMobG9naW5pZCwgdG9KUyh0aGlzLmFjY291bnRzKSk7XG4gICAgICAgIHRoaXMubG9naW5pZCA9IGxvZ2luaWQ7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGdldEJhc2ljVXBncmFkZUluZm8oKSB7XG4gICAgICAgIGNvbnN0IHVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzID0gW1xuICAgICAgICAgICAgLi4ubmV3IFNldChTdGF0ZS5nZXRSZXNwb25zZSgnYXV0aG9yaXplLnVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzJykpLFxuICAgICAgICBdO1xuICAgICAgICBsZXQgY2FuX29wZW5fbXVsdGkgPSBmYWxzZTtcbiAgICAgICAgbGV0IHR5cGUsIGNhbl91cGdyYWRlX3RvO1xuICAgICAgICBpZiAoKHVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzIHx8IFtdKS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNhbl9vcGVuX211bHRpID1cbiAgICAgICAgICAgICAgICB1cGdyYWRlYWJsZV9sYW5kaW5nX2NvbXBhbmllcy5pbmRleE9mKHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5sYW5kaW5nX2NvbXBhbnlfc2hvcnRjb2RlKSAhPT0gLTE7XG4gICAgICAgICAgICBjb25zdCBjYW5VcGdyYWRlID0gKC4uLmxhbmRpbmdfY29tcGFuaWVzKSA9PlxuICAgICAgICAgICAgICAgIGxhbmRpbmdfY29tcGFuaWVzLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgIGxhbmRpbmdfY29tcGFueSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZGluZ19jb21wYW55ICE9PSB0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0ubGFuZGluZ19jb21wYW55X3Nob3J0Y29kZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgdXBncmFkZWFibGVfbGFuZGluZ19jb21wYW5pZXMuaW5kZXhPZihsYW5kaW5nX2NvbXBhbnkpICE9PSAtMVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjYW5fdXBncmFkZV90byA9IGNhblVwZ3JhZGUoJ3N2ZycsICdpb20nLCAnbWFsdGEnLCAnbWFsdGFpbnZlc3QnKTtcbiAgICAgICAgICAgIGlmIChjYW5fdXBncmFkZV90bykge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBjYW5fdXBncmFkZV90byA9PT0gJ21hbHRhaW52ZXN0JyA/ICdmaW5hbmNpYWwnIDogJ3JlYWwnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGUsXG4gICAgICAgICAgICBjYW5fdXBncmFkZTogISFjYW5fdXBncmFkZV90byxcbiAgICAgICAgICAgIGNhbl91cGdyYWRlX3RvLFxuICAgICAgICAgICAgY2FuX29wZW5fbXVsdGksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldE1UNURpc2FibGVkU2lnbnVwVHlwZXMoZGlzYWJsZWRfdHlwZXNfb2JqKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRfbGlzdCA9IHRoaXMubXQ1X2Rpc2FibGVkX3NpZ251cF90eXBlcztcbiAgICAgICAgdGhpcy5tdDVfZGlzYWJsZWRfc2lnbnVwX3R5cGVzID0geyAuLi5jdXJyZW50X2xpc3QsIC4uLmRpc2FibGVkX3R5cGVzX29iaiB9O1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRDRkREaXNhYmxlZFNpZ251cFR5cGVzKHBsYXRmb3JtLCBkaXNhYmxlZF90eXBlc19vYmopIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtID09PSBDRkRfUExBVEZPUk1TLkRYVFJBREUpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGlzdCA9IHRoaXMuZHh0cmFkZV9kaXNhYmxlZF9zaWdudXBfdHlwZXM7XG4gICAgICAgICAgICB0aGlzLmR4dHJhZGVfZGlzYWJsZWRfc2lnbnVwX3R5cGVzID0geyBjdXJyZW50X2xpc3QsIC4uLmRpc2FibGVkX3R5cGVzX29iaiB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGdldExpbWl0cygpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgV1MuYXV0aG9yaXplZC5zdG9yYWdlLmdldExpbWl0cygpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgcnVuSW5BY3Rpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY2NvdW50X2xpbWl0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcGlfaW5pdGlhbF9sb2FkX2Vycm9yOiBkYXRhLmVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWNjb3VudF9saW1pdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4uZGF0YS5nZXRfbGltaXRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX2xvYWRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0UHJlZmVycmVkTGFuZ3VhZ2UgPSBsYW5nID0+IHtcbiAgICAgICAgdGhpcy5wcmVmZXJyZWRfbGFuZ3VhZ2UgPSBsYW5nO1xuICAgICAgICBMb2NhbFN0b3JlLnNldE9iamVjdChMQU5HVUFHRV9LRVksIGxhbmcpO1xuICAgIH07XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0Q29va2llQWNjb3VudCgpIHtcbiAgICAgICAgY29uc3QgZG9tYWluID0gL2Rlcml2XFwuKGNvbXxtZSkvLnRlc3Qod2luZG93LmxvY2F0aW9uLmhvc3RuYW1lKSA/IGRlcml2X3VybHMuREVSSVZfSE9TVF9OQU1FIDogJ2JpbmFyeS5zeCc7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuXG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGxvZ2luaWQsXG4gICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgIGxhbmRpbmdfY29tcGFueV9zaG9ydGNvZGUsXG4gICAgICAgICAgICBjdXJyZW5jeSxcbiAgICAgICAgICAgIHJlc2lkZW5jZSxcbiAgICAgICAgICAgIGFjY291bnRfc2V0dGluZ3MsXG4gICAgICAgICAgICBwcmVmZXJyZWRfbGFuZ3VhZ2UsXG4gICAgICAgICAgICB1c2VyX2lkLFxuICAgICAgICB9ID0gdGhpcztcbiAgICAgICAgY29uc3QgeyBmaXJzdF9uYW1lLCBsYXN0X25hbWUsIG5hbWUgfSA9IGFjY291bnRfc2V0dGluZ3M7XG4gICAgICAgIGlmIChsb2dpbmlkICYmIGVtYWlsKSB7XG4gICAgICAgICAgICBjb25zdCBjbGllbnRfaW5mb3JtYXRpb24gPSB7XG4gICAgICAgICAgICAgICAgbG9naW5pZCxcbiAgICAgICAgICAgICAgICBlbWFpbCxcbiAgICAgICAgICAgICAgICBsYW5kaW5nX2NvbXBhbnlfc2hvcnRjb2RlLFxuICAgICAgICAgICAgICAgIGN1cnJlbmN5LFxuICAgICAgICAgICAgICAgIHJlc2lkZW5jZSxcbiAgICAgICAgICAgICAgICBmaXJzdF9uYW1lLFxuICAgICAgICAgICAgICAgIGxhc3RfbmFtZSxcbiAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgIHByZWZlcnJlZF9sYW5ndWFnZSxcbiAgICAgICAgICAgICAgICB1c2VyX2lkLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIENvb2tpZXMuc2V0KCdjbGllbnRfaW5mb3JtYXRpb24nLCBjbGllbnRfaW5mb3JtYXRpb24sIHsgZG9tYWluIH0pO1xuICAgICAgICAgICAgdGhpcy5oYXNfY29va2llX2FjY291bnQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgQ29va2llcy5yZW1vdmUoJ2NsaWVudF9pbmZvcm1hdGlvbicsIHsgZG9tYWluIH0pO1xuICAgICAgICAgICAgdGhpcy5oYXNfY29va2llX2FjY291bnQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXRTZWxmRXhjbHVzaW9uKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICBXUy5hdXRob3JpemVkLnN0b3JhZ2UuZ2V0U2VsZkV4Y2x1c2lvbigpLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgcnVuSW5BY3Rpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5nZXRfc2VsZl9leGNsdXNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZl9leGNsdXNpb24gPSBkYXRhLmdldF9zZWxmX2V4Y2x1c2lvbjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZl9leGNsdXNpb24gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgdXBkYXRlU2VsZkV4Y2x1c2lvbih2YWx1ZXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgV1MuYXV0aG9yaXplZC5zdG9yYWdlLnNldFNlbGZFeGNsdXNpb24odmFsdWVzKS50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFNlbGZFeGNsdXNpb24oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzcG9uc2VQYXlvdXRDdXJyZW5jaWVzKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnN0IGxpc3QgPSByZXNwb25zZS5wYXlvdXRfY3VycmVuY2llcyB8fCByZXNwb25zZTtcbiAgICAgICAgdGhpcy5jdXJyZW5jaWVzX2xpc3QgPSBidWlsZEN1cnJlbmNpZXNMaXN0KGxpc3QpO1xuICAgICAgICB0aGlzLnNlbGVjdEN1cnJlbmN5KCcnKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzcG9uc2VBdXRob3JpemUocmVzcG9uc2UpIHtcbiAgICAgICAgdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdLmVtYWlsID0gcmVzcG9uc2UuYXV0aG9yaXplLmVtYWlsO1xuICAgICAgICB0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0uY3VycmVuY3kgPSByZXNwb25zZS5hdXRob3JpemUuY3VycmVuY3k7XG4gICAgICAgIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5pc192aXJ0dWFsID0gK3Jlc3BvbnNlLmF1dGhvcml6ZS5pc192aXJ0dWFsO1xuICAgICAgICB0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0uc2Vzc2lvbl9zdGFydCA9IHBhcnNlSW50KG1vbWVudCgpLnV0YygpLnZhbHVlT2YoKSAvIDEwMDApO1xuICAgICAgICB0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0ubGFuZGluZ19jb21wYW55X3Nob3J0Y29kZSA9IHJlc3BvbnNlLmF1dGhvcml6ZS5sYW5kaW5nX2NvbXBhbnlfbmFtZTtcbiAgICAgICAgdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdLmNvdW50cnkgPSByZXNwb25zZS5jb3VudHJ5O1xuICAgICAgICB0aGlzLnVwZGF0ZUFjY291bnRMaXN0KHJlc3BvbnNlLmF1dGhvcml6ZS5hY2NvdW50X2xpc3QpO1xuICAgICAgICB0aGlzLnVwZ3JhZGVfaW5mbyA9IHRoaXMuZ2V0QmFzaWNVcGdyYWRlSW5mbygpO1xuICAgICAgICB0aGlzLnVzZXJfaWQgPSByZXNwb25zZS5hdXRob3JpemUudXNlcl9pZDtcbiAgICAgICAgdGhpcy51cGdyYWRlYWJsZV9sYW5kaW5nX2NvbXBhbmllcyA9IFsuLi5uZXcgU2V0KHJlc3BvbnNlLmF1dGhvcml6ZS51cGdyYWRlYWJsZV9sYW5kaW5nX2NvbXBhbmllcyldO1xuICAgICAgICB0aGlzLmxvY2FsX2N1cnJlbmN5X2NvbmZpZy5jdXJyZW5jeSA9IE9iamVjdC5rZXlzKHJlc3BvbnNlLmF1dGhvcml6ZS5sb2NhbF9jdXJyZW5jaWVzKVswXTtcblxuICAgICAgICAvLyBGb3IgcmVzaWRlbmNlcyB3aXRob3V0IGxvY2FsIGN1cnJlbmN5IChlLmcuIGF4KVxuICAgICAgICBjb25zdCBkZWZhdWx0X2ZyYWN0aW9uYWxfZGlnaXRzID0gMjtcbiAgICAgICAgdGhpcy5sb2NhbF9jdXJyZW5jeV9jb25maWcuZGVjaW1hbF9wbGFjZXMgPSBpc0VtcHR5T2JqZWN0KHJlc3BvbnNlLmF1dGhvcml6ZS5sb2NhbF9jdXJyZW5jaWVzKVxuICAgICAgICAgICAgPyBkZWZhdWx0X2ZyYWN0aW9uYWxfZGlnaXRzXG4gICAgICAgICAgICA6ICtyZXNwb25zZS5hdXRob3JpemUubG9jYWxfY3VycmVuY2llc1t0aGlzLmxvY2FsX2N1cnJlbmN5X2NvbmZpZy5jdXJyZW5jeV0uZnJhY3Rpb25hbF9kaWdpdHM7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFdlYnNpdGVTdGF0dXMocmVzcG9uc2UpIHtcbiAgICAgICAgdGhpcy53ZWJzaXRlX3N0YXR1cyA9IHJlc3BvbnNlLndlYnNpdGVfc3RhdHVzO1xuICAgICAgICB0aGlzLnJlc3BvbnNlV2Vic2l0ZVN0YXR1cyhyZXNwb25zZSk7XG4gICAgICAgIHNldEN1cnJlbmNpZXModGhpcy53ZWJzaXRlX3N0YXR1cyk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGFzeW5jIGFjY291bnRSZWFsUmVhY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgcnVuSW5BY3Rpb24oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNfcG9wdWxhdGluZ19hY2NvdW50X2xpc3QgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBjbGllbnRfYWNjb3VudHMgPSBKU09OLnBhcnNlKExvY2FsU3RvcmUuZ2V0KHN0b3JhZ2Vfa2V5KSk7XG4gICAgICAgICAgICBjb25zdCB7IG9hdXRoX3Rva2VuLCBjbGllbnRfaWQgfSA9IHJlc3BvbnNlLm5ld19hY2NvdW50X3JlYWwgPz8gcmVzcG9uc2UubmV3X2FjY291bnRfbWFsdGFpbnZlc3Q7XG4gICAgICAgICAgICBCaW5hcnlTb2NrZXQuYXV0aG9yaXplKG9hdXRoX3Rva2VuKS50aGVuKGF1dGhvcml6ZV9yZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3X2RhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICBuZXdfZGF0YS50b2tlbiA9IG9hdXRoX3Rva2VuO1xuICAgICAgICAgICAgICAgIG5ld19kYXRhLnJlc2lkZW5jZSA9IGF1dGhvcml6ZV9yZXNwb25zZS5hdXRob3JpemUuY291bnRyeTtcbiAgICAgICAgICAgICAgICBuZXdfZGF0YS5jdXJyZW5jeSA9IGF1dGhvcml6ZV9yZXNwb25zZS5hdXRob3JpemUuY3VycmVuY3k7XG4gICAgICAgICAgICAgICAgbmV3X2RhdGEuaXNfdmlydHVhbCA9IGF1dGhvcml6ZV9yZXNwb25zZS5hdXRob3JpemUuaXNfdmlydHVhbDtcbiAgICAgICAgICAgICAgICBuZXdfZGF0YS5sYW5kaW5nX2NvbXBhbnlfbmFtZSA9IGF1dGhvcml6ZV9yZXNwb25zZS5hdXRob3JpemUubGFuZGluZ19jb21wYW55X2Z1bGxuYW1lO1xuICAgICAgICAgICAgICAgIG5ld19kYXRhLmxhbmRpbmdfY29tcGFueV9zaG9ydGNvZGUgPSBhdXRob3JpemVfcmVzcG9uc2UuYXV0aG9yaXplLmxhbmRpbmdfY29tcGFueV9uYW1lO1xuXG4gICAgICAgICAgICAgICAgcnVuSW5BY3Rpb24oKCkgPT4gKGNsaWVudF9hY2NvdW50c1tjbGllbnRfaWRdID0gbmV3X2RhdGEpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldExvZ2luSW5mb3JtYXRpb24oY2xpZW50X2FjY291bnRzLCBjbGllbnRfaWQpO1xuICAgICAgICAgICAgICAgIFdTLmF1dGhvcml6ZWQuc3RvcmFnZS5nZXRTZXR0aW5ncygpLnRoZW4oZ2V0X3NldHRpbmdzX3Jlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRBY2NvdW50U2V0dGluZ3MoZ2V0X3NldHRpbmdzX3Jlc3BvbnNlLmdldF9zZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0TG9naW5JbmZvcm1hdGlvbihjbGllbnRfYWNjb3VudHMsIGNsaWVudF9pZCkge1xuICAgICAgICB0aGlzLnNldEFjY291bnRzKGNsaWVudF9hY2NvdW50cyk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHN0b3JhZ2Vfa2V5LCBKU09OLnN0cmluZ2lmeShjbGllbnRfYWNjb3VudHMpKTtcbiAgICAgICAgTG9jYWxTdG9yZS5zZXQoc3RvcmFnZV9rZXksIEpTT04uc3RyaW5naWZ5KGNsaWVudF9hY2NvdW50cykpO1xuICAgICAgICB0aGlzLmlzX3BvcHVsYXRpbmdfYWNjb3VudF9saXN0ID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXBncmFkZV9pbmZvID0gdGhpcy5nZXRCYXNpY1VwZ3JhZGVJbmZvKCk7XG4gICAgICAgIHRoaXMuc2V0U3dpdGNoZWQoY2xpZW50X2lkKTtcbiAgICAgICAgdGhpcy5zeW5jV2l0aExlZ2FjeVBsYXRmb3JtcyhjbGllbnRfaWQsIGNsaWVudF9hY2NvdW50cyk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGFzeW5jIHJlYWxBY2NvdW50U2lnbnVwKGZvcm1fdmFsdWVzKSB7XG4gICAgICAgIGNvbnN0IERFRkFVTFRfQ1JZUFRPX0FDQ09VTlRfQ1VSUkVOQ1kgPSAnQlRDJztcbiAgICAgICAgY29uc3QgaXNfbWFsdGFpbnZlc3RfYWNjb3VudCA9IHRoaXMucm9vdF9zdG9yZS51aS5yZWFsX2FjY291bnRfc2lnbnVwX3RhcmdldCA9PT0gJ21hbHRhaW52ZXN0JztcbiAgICAgICAgY29uc3QgaXNfc2Ftb2FfYWNjb3VudCA9IHRoaXMucm9vdF9zdG9yZS51aS5yZWFsX2FjY291bnRfc2lnbnVwX3RhcmdldCA9PT0gJ3NhbW9hJztcbiAgICAgICAgbGV0IGN1cnJlbmN5ID0gJyc7XG4gICAgICAgIGZvcm1fdmFsdWVzLnJlc2lkZW5jZSA9IHRoaXMucmVzaWRlbmNlO1xuICAgICAgICBpZiAoaXNfbWFsdGFpbnZlc3RfYWNjb3VudCkge1xuICAgICAgICAgICAgY3VycmVuY3kgPSBmb3JtX3ZhbHVlcy5jdXJyZW5jeTtcbiAgICAgICAgICAgIGZvcm1fdmFsdWVzLmFjY2VwdF9yaXNrID0gZm9ybV92YWx1ZXMuYWNjZXB0X3Jpc2sgfHwgMDtcbiAgICAgICAgICAgIGRlbGV0ZSBmb3JtX3ZhbHVlcy5jdXJyZW5jeTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGlzX21hbHRhaW52ZXN0X2FjY291bnRcbiAgICAgICAgICAgID8gYXdhaXQgV1MubmV3QWNjb3VudFJlYWxNYWx0YUludmVzdChmb3JtX3ZhbHVlcylcbiAgICAgICAgICAgIDogYXdhaXQgV1MubmV3QWNjb3VudFJlYWwoZm9ybV92YWx1ZXMpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmVycm9yKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFjY291bnRSZWFsUmVhY3Rpb24ocmVzcG9uc2UpO1xuICAgICAgICAgICAgLy8gU2V0IGN1cnJlbmN5IGFmdGVyIGFjY291bnQgaXMgY3JlYXRlZFxuICAgICAgICAgICAgLy8gTWFsdGFpbnZlc3Qgb25seVxuICAgICAgICAgICAgaWYgKGlzX21hbHRhaW52ZXN0X2FjY291bnQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNldEFjY291bnRDdXJyZW5jeShjdXJyZW5jeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNfc2Ftb2FfYWNjb3VudCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0QWNjb3VudEN1cnJlbmN5KERFRkFVTFRfQ1JZUFRPX0FDQ09VTlRfQ1VSUkVOQ1kpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3JlYWxfYWNjb3VudF9zaWdudXBfd2l6YXJkJyk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJvb3Rfc3RvcmUuZ3RtLnB1c2hEYXRhTGF5ZXIoeyBldmVudDogJ3JlYWxfc2lnbnVwJyB9KTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xuICAgICAgICAgICAgICAgIC4uLnJlc3BvbnNlLFxuICAgICAgICAgICAgICAgIC4uLihpc19tYWx0YWludmVzdF9hY2NvdW50XG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfYWNjb3VudF9tYWx0YWludmVzdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ucmVzcG9uc2UubmV3X2FjY291bnRfbWFsdGFpbnZlc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW5jeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDoge30pLFxuICAgICAgICAgICAgICAgIC4uLihpc19zYW1vYV9hY2NvdW50XG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdfYWNjb3VudF9zYW1vYToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVuY3ksXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICA6IHt9KSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlc3BvbnNlLmVycm9yKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgYXN5bmMgc2V0QWNjb3VudEN1cnJlbmN5KGN1cnJlbmN5KSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgV1Muc2V0QWNjb3VudEN1cnJlbmN5KGN1cnJlbmN5LCB7XG4gICAgICAgICAgICBwcmV2aW91c19jdXJyZW5jeTogdGhpcy5jdXJyZW5jeSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudXBkYXRlQWNjb3VudEN1cnJlbmN5KGN1cnJlbmN5KTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZS5lcnJvcik7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGFzeW5jIHVwZGF0ZUFjY291bnRDdXJyZW5jeShjdXJyZW5jeSwgaXNfc2V0X3N0b3JhZ2UgPSB0cnVlKSB7XG4gICAgICAgIHJ1bkluQWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld19hY2NvdW50ID0geyAuLi50aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0gfTtcbiAgICAgICAgICAgIG5ld19hY2NvdW50LmN1cnJlbmN5ID0gY3VycmVuY3k7XG4gICAgICAgICAgICBpZiAoISgnYmFsYW5jZScgaW4gbmV3X2FjY291bnQpKSBuZXdfYWNjb3VudC5iYWxhbmNlID0gMDtcbiAgICAgICAgICAgIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXSA9IG5ld19hY2NvdW50O1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGlzX3NldF9zdG9yYWdlKSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlX2tleSwgSlNPTi5zdHJpbmdpZnkodGhpcy5hY2NvdW50cykpO1xuICAgICAgICAgICAgTG9jYWxTdG9yZS5zZXRPYmplY3Qoc3RvcmFnZV9rZXksIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5hY2NvdW50cykpKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdEN1cnJlbmN5KGN1cnJlbmN5KTtcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZU5vdGlmaWNhdGlvbk1lc3NhZ2Uoe1xuICAgICAgICAgICAga2V5OiAnY3VycmVuY3knLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZU5vdGlmaWNhdGlvbkJ5S2V5KHtcbiAgICAgICAgICAgIGtleTogJ2N1cnJlbmN5JyxcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuaW5pdCgpO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBjcmVhdGVDcnlwdG9BY2NvdW50KGN1cnJlbmN5KSB7XG4gICAgICAgIGNvbnN0IHJlc2lkZW5jZSA9IHRoaXMucmVzaWRlbmNlO1xuICAgICAgICBjb25zdCB7IGRhdGVfb2ZfYmlydGgsIGZpcnN0X25hbWUsIGxhc3RfbmFtZSB9ID0gdGhpcy5hY2NvdW50X3NldHRpbmdzO1xuICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgcmVzaWRlbmNlLFxuICAgICAgICAgICAgY3VycmVuY3ksXG4gICAgICAgICAgICBmaXJzdF9uYW1lLFxuICAgICAgICAgICAgbGFzdF9uYW1lLFxuICAgICAgICAgICAgZGF0ZV9vZl9iaXJ0aDogdG9Nb21lbnQoZGF0ZV9vZl9iaXJ0aCkuZm9ybWF0KCdZWVlZLU1NLUREJyksXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBXUy5uZXdBY2NvdW50UmVhbChkYXRhKTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5lcnJvcikge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hY2NvdW50UmVhbFJlYWN0aW9uKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXNwb25zZS5lcnJvcik7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IHJlc2lkZW5jZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNfbG9nZ2VkX2luKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50X3NldHRpbmdzLmNvdW50cnlfY29kZSA/PyAnJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGVtYWlsX2FkZHJlc3MoKSB7XG4gICAgICAgIGlmICh0aGlzLmFjY291bnRzICYmIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5lbWFpbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaXNfd2Vic2l0ZV9zdGF0dXNfcmVhZHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLndlYnNpdGVfc3RhdHVzICYmICFCaW5hcnlTb2NrZXQuZ2V0QXZhaWxhYmlsaXR5KCkuaXNfZG93bjtcbiAgICB9XG5cbiAgICBpc0V1Q291bnRyeVNlbGVjdGVkID0gc2VsZWN0ZWRfY291bnRyeSA9PiB7XG4gICAgICAgIGlmIChzZWxlY3RlZF9jb3VudHJ5KSByZXR1cm4gaXNFdUNvdW50cnkoc2VsZWN0ZWRfY291bnRyeSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgaXNBY2NvdW50T2ZUeXBlID0gdHlwZSA9PiB7XG4gICAgICAgIGNvbnN0IGNsaWVudF9hY2NvdW50X3R5cGUgPSBnZXRDbGllbnRBY2NvdW50VHlwZSh0aGlzLmxvZ2luaWQpO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAoKHR5cGUgPT09ICd2aXJ0dWFsJyAmJiBjbGllbnRfYWNjb3VudF90eXBlID09PSAndmlydHVhbCcpIHx8XG4gICAgICAgICAgICAgICAgKHR5cGUgPT09ICdyZWFsJyAmJiBjbGllbnRfYWNjb3VudF90eXBlICE9PSAndmlydHVhbCcpIHx8XG4gICAgICAgICAgICAgICAgdHlwZSA9PT0gY2xpZW50X2FjY291bnRfdHlwZSkgJiZcbiAgICAgICAgICAgICF0aGlzLmlzRGlzYWJsZWQoKVxuICAgICAgICApO1xuICAgIH07XG5cbiAgICBpc0FjY291bnRPZlR5cGVEaXNhYmxlZCA9IHR5cGUgPT4ge1xuICAgICAgICBjb25zdCBmaWx0ZXJlZF9saXN0ID0gdGhpcy5hY2NvdW50X2xpc3QuZmlsdGVyKGFjYyA9PiBnZXRDbGllbnRBY2NvdW50VHlwZShhY2MubG9naW5pZCkgPT09IHR5cGUpO1xuICAgICAgICByZXR1cm4gZmlsdGVyZWRfbGlzdC5sZW5ndGggPiAwICYmIGZpbHRlcmVkX2xpc3QuZXZlcnkoYWNjID0+IGFjYy5pc19kaXNhYmxlZCk7XG4gICAgfTtcblxuICAgIGdldFJpc2tBc3Nlc3NtZW50ID0gKCkgPT4ge1xuICAgICAgICBpZiAoIXRoaXMuYWNjb3VudF9zdGF0dXMpIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBzdGF0dXMgPSB0aGlzLmFjY291bnRfc3RhdHVzPy5zdGF0dXM7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuaXNBY2NvdW50T2ZUeXBlKCdmaW5hbmNpYWwnKVxuICAgICAgICAgICAgPyAvKGZpbmFuY2lhbF9hc3Nlc3NtZW50fHRyYWRpbmdfZXhwZXJpZW5jZSlfbm90X2NvbXBsZXRlLy50ZXN0KHN0YXR1cylcbiAgICAgICAgICAgIDogL2ZpbmFuY2lhbF9hc3Nlc3NtZW50X25vdF9jb21wbGV0ZS8udGVzdChzdGF0dXMpO1xuICAgIH07XG5cbiAgICBzaG91bGRDb21wbGV0ZVRheCA9ICgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmlzQWNjb3VudE9mVHlwZSgnZmluYW5jaWFsJykpIHJldHVybiBmYWxzZTtcblxuICAgICAgICByZXR1cm4gIS9jcnNfdGluX2luZm9ybWF0aW9uLy50ZXN0KCh0aGlzLmFjY291bnRfc3RhdHVzIHx8IHt9KT8uc3RhdHVzKTtcbiAgICB9O1xuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHVwZGF0ZUFjY291bnRMaXN0KGFjY291bnRfbGlzdCkge1xuICAgICAgICBhY2NvdW50X2xpc3QuZm9yRWFjaChhY2NvdW50ID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjY291bnRzW2FjY291bnQubG9naW5pZF0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjY291bnRzW2FjY291bnQubG9naW5pZF0uZXhjbHVkZWRfdW50aWwgPSBhY2NvdW50LmV4Y2x1ZGVkX3VudGlsIHx8ICcnO1xuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGFjY291bnQpLmZvckVhY2gocGFyYW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbV90b19zZXQgPSBwYXJhbSA9PT0gJ2NvdW50cnknID8gJ3Jlc2lkZW5jZScgOiBwYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVfdG9fc2V0ID0gdHlwZW9mIGFjY291bnRbcGFyYW1dID09PSAndW5kZWZpbmVkJyA/ICcnIDogYWNjb3VudFtwYXJhbV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbV90b19zZXQgIT09ICdsb2dpbmlkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY2NvdW50c1thY2NvdW50LmxvZ2luaWRdW3BhcmFtX3RvX3NldF0gPSB2YWx1ZV90b19zZXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3dpdGNoIHRvIHRoZSBnaXZlbiBsb2dpbmlkIGFjY291bnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbG9naW5pZFxuICAgICAqL1xuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBzd2l0Y2hBY2NvdW50KGxvZ2luaWQpIHtcbiAgICAgICAgdGhpcy5zZXRQcmVTd2l0Y2hBY2NvdW50KHRydWUpO1xuICAgICAgICB0aGlzLnNldElzTG9nZ2luZ0luKHRydWUpO1xuICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkucmVtb3ZlTm90aWZpY2F0aW9ucyh0cnVlKTtcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZUFsbE5vdGlmaWNhdGlvbk1lc3NhZ2VzKHRydWUpO1xuICAgICAgICB0aGlzLnNldFN3aXRjaGVkKGxvZ2luaWQpO1xuICAgICAgICB0aGlzLnJlc3BvbnNlUGF5b3V0Q3VycmVuY2llcyhhd2FpdCBXUy5hdXRob3JpemVkLnBheW91dEN1cnJlbmNpZXMoKSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGFzeW5jIHJlc2V0VmlydHVhbEJhbGFuY2UoKSB7XG4gICAgICAgIHRoaXMucm9vdF9zdG9yZS51aS5yZW1vdmVOb3RpZmljYXRpb25CeUtleSh7IGtleTogJ3Jlc2V0X3ZpcnR1YWxfYmFsYW5jZScgfSk7XG4gICAgICAgIHRoaXMucm9vdF9zdG9yZS51aS5yZW1vdmVOb3RpZmljYXRpb25NZXNzYWdlKHsga2V5OiAncmVzZXRfdmlydHVhbF9iYWxhbmNlJywgc2hvdWxkX3Nob3dfYWdhaW46IHRydWUgfSk7XG4gICAgICAgIGF3YWl0IFdTLmF1dGhvcml6ZWQudG9wdXBWaXJ0dWFsKCk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHN3aXRjaEVuZFNpZ25hbCgpIHtcbiAgICAgICAgdGhpcy5zd2l0Y2hfYnJvYWRjYXN0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHJlZnJlc2hOb3RpZmljYXRpb25zKCkge1xuICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkucmVtb3ZlTm90aWZpY2F0aW9ucyh0cnVlKTtcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZUFsbE5vdGlmaWNhdGlvbk1lc3NhZ2VzKCk7XG4gICAgICAgIGNvbnN0IGNsaWVudCA9IHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXTtcbiAgICAgICAgY29uc3QgeyBoYXNfbWlzc2luZ19yZXF1aXJlZF9maWVsZCB9ID0gaGFuZGxlQ2xpZW50Tm90aWZpY2F0aW9ucyhcbiAgICAgICAgICAgIGNsaWVudCxcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWksXG4gICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUubW9kdWxlcy5jYXNoaWVyLFxuICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLmNvbW1vblxuICAgICAgICApO1xuICAgICAgICB0aGlzLnNldEhhc01pc3NpbmdSZXF1aXJlZEZpZWxkKGhhc19taXNzaW5nX3JlcXVpcmVkX2ZpZWxkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXZSBpbml0aWFsbHkgZmV0Y2ggdGhpbmdzIGZyb20gbG9jYWwgc3RvcmFnZSwgYW5kIHRoZW4gZG8gZXZlcnl0aGluZyBpbnNpZGUgdGhlIHN0b3JlLlxuICAgICAqL1xuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBpbml0KGxvZ2luX25ld191c2VyKSB7XG4gICAgICAgIGNvbnN0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIGNvbnN0IHNlYXJjaF9wYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHNlYXJjaCk7XG4gICAgICAgIGNvbnN0IHJlZGlyZWN0X3VybCA9IHNlYXJjaF9wYXJhbXM/LmdldCgncmVkaXJlY3RfdXJsJyk7XG5cbiAgICAgICAgdGhpcy5zZXRJc0xvZ2dpbmdJbih0cnVlKTtcbiAgICAgICAgY29uc3QgYXV0aG9yaXplX3Jlc3BvbnNlID0gYXdhaXQgdGhpcy5zZXRVc2VyTG9naW4obG9naW5fbmV3X3VzZXIpO1xuICAgICAgICB0aGlzLnNldERldmljZURhdGEoKTtcblxuICAgICAgICAvLyBPbiBjYXNlIG9mIGludmFsaWQgdG9rZW4sIG5vIG5lZWQgdG8gY29udGludWUgd2l0aCBhZGRpdGlvbmFsIGFwaSBjYWxscy5cbiAgICAgICAgaWYgKGF1dGhvcml6ZV9yZXNwb25zZT8uZXJyb3IpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubG9nb3V0KCk7XG4gICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUuY29tbW9uLnNldEVycm9yKHRydWUsIHtcbiAgICAgICAgICAgICAgICBoZWFkZXI6IGF1dGhvcml6ZV9yZXNwb25zZS5lcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGxvY2FsaXplKCdQbGVhc2UgTG9nIGluJyksXG4gICAgICAgICAgICAgICAgc2hvdWxkX3Nob3dfcmVmcmVzaDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RfbGFiZWw6IGxvY2FsaXplKCdMb2cgaW4nKSxcbiAgICAgICAgICAgICAgICByZWRpcmVjdE9uQ2xpY2s6ICgpID0+IHJlZGlyZWN0VG9Mb2dpbihmYWxzZSwgZ2V0TGFuZ3VhZ2UoKSksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuc2V0SXNMb2dnaW5nSW4oZmFsc2UpO1xuICAgICAgICAgICAgdGhpcy5zZXRJbml0aWFsaXplZChmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLnNldFN3aXRjaGVkKCcnKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuc2V0TG9naW5JZChMb2NhbFN0b3JlLmdldCgnYWN0aXZlX2xvZ2luaWQnKSk7XG4gICAgICAgIHRoaXMuc2V0QWNjb3VudHMoTG9jYWxTdG9yZS5nZXRPYmplY3Qoc3RvcmFnZV9rZXkpKTtcbiAgICAgICAgdGhpcy5zZXRTd2l0Y2hlZCgnJyk7XG4gICAgICAgIGxldCBjbGllbnQgPSB0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF07XG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGF1dGhvcml6ZV9yZXNwb25zZSwgaXQgbWVhbnMgaXQgd2FzIHRoZSBmaXJzdCBsb2dpblxuICAgICAgICBpZiAoYXV0aG9yaXplX3Jlc3BvbnNlKSB7XG4gICAgICAgICAgICAvLyBJZiB0aGlzIGZhaWxzLCBpdCBtZWFucyB0aGUgbGFuZGluZyBjb21wYW55IGNoZWNrIGZhaWxlZFxuICAgICAgICAgICAgaWYgKHRoaXMubG9naW5pZCA9PT0gYXV0aG9yaXplX3Jlc3BvbnNlLmF1dGhvcml6ZS5sb2dpbmlkKSB7XG4gICAgICAgICAgICAgICAgQmluYXJ5U29ja2V0R2VuZXJhbC5hdXRob3JpemVBY2NvdW50KGF1dGhvcml6ZV9yZXNwb25zZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBDbGllbnQgY29tZXMgYmFjayBmcm9tIG9hdXRoIGFuZCBsb2dzIGluXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yb290X3N0b3JlLnJ1ZGRlcnN0YWNrLmlkZW50aWZ5RXZlbnQoKTtcblxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucm9vdF9zdG9yZS5ndG0ucHVzaERhdGFMYXllcih7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50OiAnbG9naW4nLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBTbyBpdCB3aWxsIHNlbmQgYW4gYXV0aG9yaXplIHdpdGggdGhlIGFjY2VwdGVkIHRva2VuLCB0byBiZSBoYW5kbGVkIGJ5IHNvY2tldC1nZW5lcmFsXG4gICAgICAgICAgICAgICAgYXdhaXQgQmluYXJ5U29ja2V0LmF1dGhvcml6ZShjbGllbnQudG9rZW4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlZGlyZWN0X3VybCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHVybEZvcihyb3V0ZXNbcmVkaXJlY3RfdXJsXSwgeyBxdWVyeV9zdHJpbmc6IHNlYXJjaCB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBydW5JbkFjdGlvbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc19wb3B1bGF0aW5nX2FjY291bnRfbGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBsYW5ndWFnZSA9IGF1dGhvcml6ZV9yZXNwb25zZS5hdXRob3JpemUucHJlZmVycmVkX2xhbmd1YWdlO1xuICAgICAgICAgICAgaWYgKGxhbmd1YWdlICE9PSAnRU4nICYmIGxhbmd1YWdlICE9PSBMb2NhbFN0b3JlLmdldChMQU5HVUFHRV9LRVkpKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UodXJsRm9yTGFuZ3VhZ2UoYXV0aG9yaXplX3Jlc3BvbnNlLmF1dGhvcml6ZS5wcmVmZXJyZWRfbGFuZ3VhZ2UpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgdXAgcmVhY3Rpb24gZm9yIGFjY291bnRfc2V0dGluZ3MsIGFjY291bnRfc3RhdHVzLCBpc19wMnBfdmlzaWJsZVxuICAgICAgICAgKi9cbiAgICAgICAgcmVhY3Rpb24oXG4gICAgICAgICAgICAoKSA9PiBbXG4gICAgICAgICAgICAgICAgdGhpcy5hY2NvdW50X3NldHRpbmdzLFxuICAgICAgICAgICAgICAgIHRoaXMuYWNjb3VudF9zdGF0dXMsXG4gICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLm1vZHVsZXM/LmNhc2hpZXI/LmlzX3AycF92aXNpYmxlLFxuICAgICAgICAgICAgICAgIHRoaXMucm9vdF9zdG9yZS5jb21tb24/LnNlbGVjdGVkX2NvbnRyYWN0X3R5cGUsXG4gICAgICAgICAgICAgICAgdGhpcy5pc19ldSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY2xpZW50ID0gdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdO1xuICAgICAgICAgICAgICAgIEJpbmFyeVNvY2tldC53YWl0KCdsYW5kaW5nX2NvbXBhbnknKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZU5vdGlmaWNhdGlvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZUFsbE5vdGlmaWNhdGlvbk1lc3NhZ2VzKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgaGFzX21pc3NpbmdfcmVxdWlyZWRfZmllbGQgfSA9IGhhbmRsZUNsaWVudE5vdGlmaWNhdGlvbnMoXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLm1vZHVsZXMuY2FzaGllcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdF9zdG9yZS5jb21tb25cbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsaWVudCAmJiAhY2xpZW50LmlzX3ZpcnR1YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SGFzTWlzc2luZ1JlcXVpcmVkRmllbGQoaGFzX21pc3NpbmdfcmVxdWlyZWRfZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RDdXJyZW5jeSgnJyk7XG5cbiAgICAgICAgdGhpcy5yZXNwb25zZVBheW91dEN1cnJlbmNpZXMoYXdhaXQgV1MuYXV0aG9yaXplZC5wYXlvdXRDdXJyZW5jaWVzKCkpO1xuICAgICAgICBpZiAodGhpcy5pc19sb2dnZWRfaW4pIHtcbiAgICAgICAgICAgIFdTLnN0b3JhZ2UubXQ1TG9naW5MaXN0KCkudGhlbih0aGlzLnJlc3BvbnNlTXQ1TG9naW5MaXN0KTtcbiAgICAgICAgICAgIFdTLnRyYWRpbmdTZXJ2ZXJzKENGRF9QTEFURk9STVMuTVQ1KS50aGVuKHRoaXMucmVzcG9uc2VNVDVUcmFkaW5nU2VydmVycyk7XG5cbiAgICAgICAgICAgIFdTLnRyYWRpbmdQbGF0Zm9ybUFjY291bnRzTGlzdChDRkRfUExBVEZPUk1TLkRYVFJBREUpLnRoZW4odGhpcy5yZXNwb25zZVRyYWRpbmdQbGF0Zm9ybUFjY291bnRzTGlzdCk7XG4gICAgICAgICAgICBXUy50cmFkaW5nU2VydmVycyhDRkRfUExBVEZPUk1TLkRYVFJBREUpLnRoZW4odGhpcy5yZXNwb25zZUR4dHJhZGVUcmFkaW5nU2VydmVycyk7XG5cbiAgICAgICAgICAgIHRoaXMucmVzcG9uc2VTdGF0ZW1lbnQoXG4gICAgICAgICAgICAgICAgYXdhaXQgQmluYXJ5U29ja2V0LnNlbmQoe1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZW1lbnQ6IDEsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBhY2NvdW50X3NldHRpbmdzID0gKGF3YWl0IFdTLmF1dGhvcml6ZWQuY2FjaGUuZ2V0U2V0dGluZ3MoKSkuZ2V0X3NldHRpbmdzO1xuICAgICAgICAgICAgaWYgKGFjY291bnRfc2V0dGluZ3MpIHRoaXMuc2V0UHJlZmVycmVkTGFuZ3VhZ2UoYWNjb3VudF9zZXR0aW5ncy5wcmVmZXJyZWRfbGFuZ3VhZ2UpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5mZXRjaFJlc2lkZW5jZUxpc3QoKTtcblxuICAgICAgICAgICAgaWYgKGFjY291bnRfc2V0dGluZ3MgJiYgIWFjY291bnRfc2V0dGluZ3MucmVzaWRlbmNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnRvZ2dsZVNldFJlc2lkZW5jZU1vZGFsKHRydWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhd2FpdCBXUy5hdXRob3JpemVkLmNhY2hlLmxhbmRpbmdDb21wYW55KHRoaXMucmVzaWRlbmNlKS50aGVuKHRoaXMucmVzcG9uc2VMYW5kaW5nQ29tcGFueSk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNfdmlydHVhbCkgYXdhaXQgdGhpcy5nZXRMaW1pdHMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXRNdDVBY2NvdW50TGlzdFBvcHVsYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc3BvbnNlV2Vic2l0ZVN0YXR1cyhhd2FpdCBXUy53YWl0KCd3ZWJzaXRlX3N0YXR1cycpKTtcblxuICAgICAgICB0aGlzLnJlZ2lzdGVyUmVhY3Rpb25zKCk7XG4gICAgICAgIHRoaXMuc2V0SXNMb2dnaW5nSW4oZmFsc2UpO1xuICAgICAgICB0aGlzLnNldEluaXRpYWxpemVkKHRydWUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzZXRNdDVBY2NvdW50TGlzdFBvcHVsYXRpb24oKSB7XG4gICAgICAgIHRoaXMuaXNfcG9wdWxhdGluZ19tdDVfYWNjb3VudF9saXN0ID0gZmFsc2U7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHJlc3BvbnNlV2Vic2l0ZVN0YXR1cyhyZXNwb25zZSkge1xuICAgICAgICB0aGlzLndlYnNpdGVfc3RhdHVzID0gcmVzcG9uc2Uud2Vic2l0ZV9zdGF0dXM7XG4gICAgICAgIGlmICh0aGlzLndlYnNpdGVfc3RhdHVzLm1lc3NhZ2UgJiYgdGhpcy53ZWJzaXRlX3N0YXR1cy5tZXNzYWdlLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLmFkZE5vdGlmaWNhdGlvbk1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIGtleTogJ21haW50ZW5hbmNlJyxcbiAgICAgICAgICAgICAgICBoZWFkZXI6IGxvY2FsaXplKCdTaXRlIGlzIGJlaW5nIHVwZGF0ZWQnKSxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBsb2NhbGl6ZSh0aGlzLndlYnNpdGVfc3RhdHVzLm1lc3NhZ2UpLFxuICAgICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJyxcbiAgICAgICAgICAgICAgICBpc19wZXJzaXN0ZW50OiB0cnVlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkucmVtb3ZlTm90aWZpY2F0aW9uTWVzc2FnZSh7XG4gICAgICAgICAgICAgICAga2V5OiAnbWFpbnRlbmFuY2UnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzcG9uc2VMYW5kaW5nQ29tcGFueShyZXNwb25zZSkge1xuICAgICAgICB0aGlzLmlzX2xhbmRpbmdfY29tcGFueV9sb2FkZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmxhbmRpbmdfY29tcGFuaWVzID0gcmVzcG9uc2UubGFuZGluZ19jb21wYW55O1xuICAgICAgICB0aGlzLnNldFN0YW5kcG9pbnQodGhpcy5sYW5kaW5nX2NvbXBhbmllcyk7XG4gICAgICAgIHRoaXMuc2V0UmVhbGl0eUNoZWNrKCk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFN0YW5kcG9pbnQobGFuZGluZ19jb21wYW5pZXMpIHtcbiAgICAgICAgaWYgKCFsYW5kaW5nX2NvbXBhbmllcykgcmV0dXJuO1xuICAgICAgICBjb25zdCB7IGdhbWluZ19jb21wYW55LCBmaW5hbmNpYWxfY29tcGFueSB9ID0gbGFuZGluZ19jb21wYW5pZXM7XG4gICAgICAgIGlmIChnYW1pbmdfY29tcGFueT8uc2hvcnRjb2RlKSB7XG4gICAgICAgICAgICB0aGlzLnN0YW5kcG9pbnQgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy5zdGFuZHBvaW50LFxuICAgICAgICAgICAgICAgIFtnYW1pbmdfY29tcGFueS5zaG9ydGNvZGVdOiAhIWdhbWluZ19jb21wYW55Py5zaG9ydGNvZGUsXG4gICAgICAgICAgICAgICAgZ2FtaW5nX2NvbXBhbnk6IGdhbWluZ19jb21wYW55Py5zaG9ydGNvZGUgPz8gZmFsc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaW5hbmNpYWxfY29tcGFueT8uc2hvcnRjb2RlKSB7XG4gICAgICAgICAgICB0aGlzLnN0YW5kcG9pbnQgPSB7XG4gICAgICAgICAgICAgICAgLi4udGhpcy5zdGFuZHBvaW50LFxuICAgICAgICAgICAgICAgIFtmaW5hbmNpYWxfY29tcGFueS5zaG9ydGNvZGVdOiAhIWZpbmFuY2lhbF9jb21wYW55Py5zaG9ydGNvZGUsXG4gICAgICAgICAgICAgICAgZmluYW5jaWFsX2NvbXBhbnk6IGZpbmFuY2lhbF9jb21wYW55Py5zaG9ydGNvZGUgPz8gZmFsc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFJlYWxpdHlDaGVjaygpIHtcbiAgICAgICAgdGhpcy5oYXNfcmVhbGl0eV9jaGVjayA9IHRoaXMuY3VycmVudF9sYW5kaW5nX2NvbXBhbnk/Lmhhc19yZWFsaXR5X2NoZWNrO1xuICAgICAgICAvLyBpZiBwYWdlIHJlbG9hZGVkIGFmdGVyIHJlYWxpdHkgY2hlY2sgd2FzIHN1Ym1pdHRlZFxuICAgICAgICAvLyB1c2UgdGhlIHN1Ym1pdHRlZCB2YWx1ZXMgdG8gaW5pdGlhdGUgcmF0aGVyIHRoYW4gYXNraW5nIGFnYWluXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMuaGFzX3JlYWxpdHlfY2hlY2sgJiZcbiAgICAgICAgICAgIHRoaXMucmVhbGl0eV9jaGVja19kdXJhdGlvbiAmJlxuICAgICAgICAgICAgdHlwZW9mIHRoaXMucmVhbGl0eV9jaGVja190aW1lb3V0ID09PSAndW5kZWZpbmVkJ1xuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMuc2V0UmVhbGl0eUNoZWNrRHVyYXRpb24odGhpcy5yZWFsaXR5X2NoZWNrX2R1cmF0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRMb2dpbklkKGxvZ2luaWQpIHtcbiAgICAgICAgdGhpcy5sb2dpbmlkID0gbG9naW5pZDtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0QWNjb3VudHMoYWNjb3VudHMpIHtcbiAgICAgICAgdGhpcy5hY2NvdW50cyA9IGFjY291bnRzO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRTd2l0Y2hlZChzd2l0Y2hlZCkge1xuICAgICAgICB0aGlzLnN3aXRjaGVkID0gc3dpdGNoZWQ7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldEhhc01pc3NpbmdSZXF1aXJlZEZpZWxkKGhhc19taXNzaW5nX3JlcXVpcmVkX2ZpZWxkKSB7XG4gICAgICAgIHRoaXMuaGFzX21pc3NpbmdfcmVxdWlyZWRfZmllbGQgPSBoYXNfbWlzc2luZ19yZXF1aXJlZF9maWVsZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiBhY2NvdW50IGlzIGRpc2FibGVkIG9yIG5vdFxuICAgICAqXG4gICAgICogQHBhcmFtIGxvZ2luaWRcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIGlzRGlzYWJsZWQobG9naW5pZCA9IHRoaXMubG9naW5pZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBY2NvdW50KGxvZ2luaWQpLmlzX2Rpc2FibGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhY2NvdW50cyB0b2tlbiBmcm9tIGdpdmVuIGxvZ2luIGlkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGxvZ2luaWRcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIGdldFRva2VuKGxvZ2luaWQgPSB0aGlzLmxvZ2luaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWNjb3VudChsb2dpbmlkKS50b2tlbjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYWNjb3VudCBvYmplY3QgZnJvbSBnaXZlbiBsb2dpbiBpZFxuICAgICAqXG4gICAgICogQHBhcmFtIGxvZ2luaWRcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fVxuICAgICAqL1xuICAgIGdldEFjY291bnQobG9naW5pZCA9IHRoaXMubG9naW5pZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50c1tsb2dpbmlkXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgaW5mb3JtYXRpb24gcmVxdWlyZWQgYnkgYWNjb3VudCBzd2l0Y2hlclxuICAgICAqXG4gICAgICogQHBhcmFtIGxvZ2luaWRcbiAgICAgKiBAcmV0dXJucyB7e2xvZ2luaWQ6ICosIGlzX3ZpcnR1YWw6IChudW1iZXJ8bnVtYmVyfCopLCBpY29uOiBzdHJpbmcsIHRpdGxlOiAqfX1cbiAgICAgKi9cbiAgICBnZXRBY2NvdW50SW5mbyhsb2dpbmlkID0gdGhpcy5sb2dpbmlkKSB7XG4gICAgICAgIGNvbnN0IGFjY291bnQgPSB0aGlzLmdldEFjY291bnQobG9naW5pZCk7XG4gICAgICAgIGNvbnN0IGN1cnJlbmN5ID0gYWNjb3VudC5jdXJyZW5jeTtcbiAgICAgICAgY29uc3QgaXNfZGlzYWJsZWQgPSBhY2NvdW50LmlzX2Rpc2FibGVkO1xuICAgICAgICBjb25zdCBpc192aXJ0dWFsID0gYWNjb3VudC5pc192aXJ0dWFsO1xuICAgICAgICBjb25zdCBhY2NvdW50X3R5cGUgPSAhaXNfdmlydHVhbCAmJiBjdXJyZW5jeSA/IGN1cnJlbmN5IDogdGhpcy5hY2NvdW50X3RpdGxlO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsb2dpbmlkLFxuICAgICAgICAgICAgaXNfZGlzYWJsZWQsXG4gICAgICAgICAgICBpc192aXJ0dWFsLFxuICAgICAgICAgICAgaWNvbjogYWNjb3VudF90eXBlLnRvTG93ZXJDYXNlKCksIC8vIFRPRE86IGRpc3BsYXkgdGhlIGljb25cbiAgICAgICAgICAgIHRpdGxlOiBhY2NvdW50X3R5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ3ZpcnR1YWwnID8gbG9jYWxpemUoJ0RFTU8nKSA6IGFjY291bnRfdHlwZSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0SXNMb2dnaW5nSW4oYm9vbCkge1xuICAgICAgICB0aGlzLmlzX2xvZ2dpbmdfaW4gPSBib29sO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRQcmVTd2l0Y2hBY2NvdW50KGlzX3ByZV9zd2l0Y2gpIHtcbiAgICAgICAgdGhpcy5wcmVfc3dpdGNoX2Jyb2FkY2FzdCA9IGlzX3ByZV9zd2l0Y2g7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGJyb2FkY2FzdEFjY291bnRDaGFuZ2UoKSB7XG4gICAgICAgIHRoaXMuc3dpdGNoX2Jyb2FkY2FzdCA9IHRydWU7XG4gICAgfVxuXG4gICAgYnJvYWRjYXN0QWNjb3VudENoYW5nZUFmdGVyQXV0aG9yaXplKCkge1xuICAgICAgICByZXR1cm4gQmluYXJ5U29ja2V0LndhaXQoJ2F1dGhvcml6ZScpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5icm9hZGNhc3RBY2NvdW50Q2hhbmdlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGhhbmRsZU5vdEZvdW5kTG9naW5JZCgpIHtcbiAgICAgICAgLy8gTG9nb3V0IGlmIHRoZSBzd2l0Y2hlZF9hY2NvdW50IGRvZXNuJ3QgYmVsb25nIHRvIGFueSBsb2dpbmlkLlxuICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkuYWRkTm90aWZpY2F0aW9uTWVzc2FnZSh7XG4gICAgICAgICAgICBtZXNzYWdlOiBsb2NhbGl6ZSgnQ291bGQgbm90IHN3aXRjaCB0byBkZWZhdWx0IGFjY291bnQuJyksXG4gICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJyxcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHJlcXVlc3QgYSBsb2dvdXRcbiAgICAgICAgdGhpcy5sb2dvdXQoKTtcbiAgICB9XG5cbiAgICBpc1VuYWJsZVRvRmluZExvZ2luSWQoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5hbGxfbG9naW5pZHMuc29tZShpZCA9PiBpZCAhPT0gdGhpcy5zd2l0Y2hlZCkgfHwgdGhpcy5zd2l0Y2hlZCA9PT0gdGhpcy5sb2dpbmlkO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBzd2l0Y2hBY2NvdW50SGFuZGxlcigpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN3aXRjaGVkIHx8ICF0aGlzLnN3aXRjaGVkLmxlbmd0aCB8fCAhdGhpcy5nZXRBY2NvdW50KHRoaXMuc3dpdGNoZWQpPy50b2tlbikge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNVbmFibGVUb0ZpbmRMb2dpbklkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZU5vdEZvdW5kTG9naW5JZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU2VuZCBhIHRvYXN0IG1lc3NhZ2UgdG8gbGV0IHRoZSB1c2VyIGtub3cgd2UgY2FuJ3Qgc3dpdGNoIGhpcyBhY2NvdW50LlxuICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLmFkZE5vdGlmaWNhdGlvbk1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGxvY2FsaXplKCdTd2l0Y2hpbmcgdG8gZGVmYXVsdCBhY2NvdW50LicpLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJyxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBzd2l0Y2ggdG8gZGVmYXVsdCBhY2NvdW50LlxuICAgICAgICAgICAgdGhpcy5zd2l0Y2hBY2NvdW50KHRoaXMuYWxsX2xvZ2luaWRzWzBdKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc3dpdGNoQWNjb3VudEhhbmRsZXIoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bkluQWN0aW9uKCgpID0+ICh0aGlzLmlzX3N3aXRjaGluZyA9IHRydWUpKTtcbiAgICAgICAgY29uc3QgZnJvbV9sb2dpbl9pZCA9IHRoaXMubG9naW5pZDtcbiAgICAgICAgdGhpcy5yZXNldExvY2FsU3RvcmFnZVZhbHVlcyh0aGlzLnN3aXRjaGVkKTtcbiAgICAgICAgU29ja2V0Q2FjaGUuY2xlYXIoKTtcblxuICAgICAgICAvLyBpZiByZWFsIHRvIHZpcnR1YWwgLS0+IHN3aXRjaCB0byBibHVlXG4gICAgICAgIC8vIGlmIHZpcnR1YWwgdG8gcmVhbCAtLT4gc3dpdGNoIHRvIGdyZWVuXG4gICAgICAgIC8vIGVsc2Uga2VlcCB0aGUgZXhpc3RpbmcgY29ubmVjdGlvblxuICAgICAgICBjb25zdCBzaG91bGRfc3dpdGNoX3NvY2tldF9jb25uZWN0aW9uID0gdGhpcy5pc192aXJ0dWFsIHx8IC9WUlRDLy50ZXN0KGZyb21fbG9naW5faWQpO1xuXG4gICAgICAgIGlmIChzaG91bGRfc3dpdGNoX3NvY2tldF9jb25uZWN0aW9uKSB7XG4gICAgICAgICAgICBCaW5hcnlTb2NrZXQuY2xvc2VBbmRPcGVuTmV3Q29ubmVjdGlvbigpO1xuICAgICAgICAgICAgYXdhaXQgQmluYXJ5U29ja2V0LndhaXQoJ2F1dGhvcml6ZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgV1MuZm9yZ2V0QWxsKCdiYWxhbmNlJyk7XG4gICAgICAgICAgICBhd2FpdCBCaW5hcnlTb2NrZXQuYXV0aG9yaXplKHRoaXMuZ2V0VG9rZW4oKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucm9vdF9zdG9yZS5jb21tb24uaGFzX2Vycm9yKSB0aGlzLnJvb3Rfc3RvcmUuY29tbW9uLnNldEVycm9yKGZhbHNlLCBudWxsKTtcbiAgICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnYWN0aXZlX3RhYicsICcxJyk7XG5cbiAgICAgICAgLy8gc2V0IGxvY2FsIHN0b3JhZ2VcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLmd0bS5zZXRMb2dpbkZsYWcoKTtcblxuICAgICAgICBhd2FpdCB0aGlzLmluaXQoKTtcblxuICAgICAgICAvLyBicm9hZGNhc3RBY2NvdW50Q2hhbmdlIGlzIGFscmVhZHkgY2FsbGVkIGFmdGVyIG5ldyBjb25uZWN0aW9uIGlzIGF1dGhvcml6ZWRcbiAgICAgICAgaWYgKCFzaG91bGRfc3dpdGNoX3NvY2tldF9jb25uZWN0aW9uKSB0aGlzLmJyb2FkY2FzdEFjY291bnRDaGFuZ2UoKTtcblxuICAgICAgICBpZiAoIXRoaXMuaXNfdmlydHVhbCkgdGhpcy5nZXRMaW1pdHMoKTtcblxuICAgICAgICBydW5JbkFjdGlvbigoKSA9PiAodGhpcy5pc19zd2l0Y2hpbmcgPSBmYWxzZSkpO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICByZWdpc3RlclJlYWN0aW9ucygpIHtcbiAgICAgICAgLy8gU3dpdGNoIGFjY291bnQgcmVhY3Rpb25zLlxuICAgICAgICB3aGVuKFxuICAgICAgICAgICAgKCkgPT4gdGhpcy5zd2l0Y2hlZCxcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcmVhbCBhY2NvdW50IG5vdGlmaWNhdGlvbnMgdXBvbiBzd2l0Y2hpbmcgdG8gdmlydHVhbFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjY291bnRzW3RoaXMuc3dpdGNoZWRdPy5pc192aXJ0dWFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdF9zdG9yZS51aS5yZW1vdmVOb3RpZmljYXRpb25zKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkucmVtb3ZlQWxsTm90aWZpY2F0aW9uTWVzc2FnZXMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnN3aXRjaEFjY291bnRIYW5kbGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHJlc2V0VmlydHVhbEJhbGFuY2VOb3RpZmljYXRpb24obG9naW5pZCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNfbG9nZ2VkX2luKSByZXR1cm47XG4gICAgICAgIGlmICghdGhpcy5hY2NvdW50c1tsb2dpbmlkXS5pc192aXJ0dWFsKSByZXR1cm47XG4gICAgICAgIGNvbnN0IG1pbl9yZXNldF9saW1pdCA9IDEwMDA7XG4gICAgICAgIGNvbnN0IG1heF9yZXNldF9saW1pdCA9IDk5OTAwMDtcbiAgICAgICAgY29uc3QgYmFsYW5jZSA9IHBhcnNlSW50KHRoaXMuYWNjb3VudHNbbG9naW5pZF0uYmFsYW5jZSk7XG5cbiAgICAgICAgLy8gRGlzcGxheSBub3RpZmljYXRpb24gbWVzc2FnZSB0byB1c2VyIHdpdGggdmlydHVhbCBhY2NvdW50IHRvIHJlc2V0IHRoZWlyIGJhbGFuY2VcbiAgICAgICAgLy8gaWYgdGhlIGJhbGFuY2UgaXMgbGVzcyB0aGFuIGVxdWFscyB0byAxMDAwIG9yIG1vcmUgdGhhbiBlcXVhbHMgdG8gOTk5MDAwXG4gICAgICAgIGlmIChiYWxhbmNlIDw9IG1pbl9yZXNldF9saW1pdCB8fCBiYWxhbmNlID49IG1heF9yZXNldF9saW1pdCkge1xuICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSBsb2NhbGl6ZShcbiAgICAgICAgICAgICAgICAnWW91ciBkZW1vIGFjY291bnQgYmFsYW5jZSBpcyBsb3cuIFJlc2V0IHlvdXIgYmFsYW5jZSB0byBjb250aW51ZSB0cmFkaW5nIGZyb20geW91ciBkZW1vIGFjY291bnQuJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmIChiYWxhbmNlID49IG1heF9yZXNldF9saW1pdClcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gbG9jYWxpemUoXG4gICAgICAgICAgICAgICAgICAgICdZb3VyIGRlbW8gYWNjb3VudCBiYWxhbmNlIGhhcyByZWFjaGVkIHRoZSBtYXhpbXVtIGxpbWl0LCBhbmQgeW91IHdpbGwgbm90IGJlIGFibGUgdG8gcGxhY2UgbmV3IHRyYWRlcy4gUmVzZXQgeW91ciBiYWxhbmNlIHRvIGNvbnRpbnVlIHRyYWRpbmcgZnJvbSB5b3VyIGRlbW8gYWNjb3VudC4nXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRoaXMucm9vdF9zdG9yZS51aS5hZGROb3RpZmljYXRpb25NZXNzYWdlKFxuICAgICAgICAgICAgICAgIGNsaWVudE5vdGlmaWNhdGlvbnMoe30sIHsgcmVzZXRWaXJ0dWFsQmFsYW5jZTogdGhpcy5yZXNldFZpcnR1YWxCYWxhbmNlLCBtZXNzYWdlIH0pXG4gICAgICAgICAgICAgICAgICAgIC5yZXNldF92aXJ0dWFsX2JhbGFuY2VcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkucmVtb3ZlTm90aWZpY2F0aW9uQnlLZXkoeyBrZXk6ICdyZXNldF92aXJ0dWFsX2JhbGFuY2UnIH0pO1xuICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZU5vdGlmaWNhdGlvbk1lc3NhZ2UoeyBrZXk6ICdyZXNldF92aXJ0dWFsX2JhbGFuY2UnLCBzaG91bGRfc2hvd19hZ2FpbjogdHJ1ZSB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRCYWxhbmNlQWN0aXZlQWNjb3VudChvYmpfYmFsYW5jZSkge1xuICAgICAgICBpZiAodGhpcy5hY2NvdW50c1tvYmpfYmFsYW5jZT8ubG9naW5pZF0gJiYgb2JqX2JhbGFuY2UubG9naW5pZCA9PT0gdGhpcy5sb2dpbmlkKSB7XG4gICAgICAgICAgICB0aGlzLmFjY291bnRzW29ial9iYWxhbmNlLmxvZ2luaWRdLmJhbGFuY2UgPSBvYmpfYmFsYW5jZS5iYWxhbmNlO1xuICAgICAgICAgICAgaWYgKHRoaXMuYWNjb3VudHNbb2JqX2JhbGFuY2UubG9naW5pZF0uaXNfdmlydHVhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRWaXJ0dWFsQmFsYW5jZU5vdGlmaWNhdGlvbihvYmpfYmFsYW5jZS5sb2dpbmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVzZXRMb2NhbFN0b3JhZ2VWYWx1ZXModGhpcy5sb2dpbmlkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRoaXMgY2FsbGJhY2sgaXMgdXNlZCBmb3IgYmFsYW5jZTogYWxsXG4gICAgLy8gQmFsYW5jZTogYWxsIGlzIHZlcnkgc2xvd1xuICAgIC8vIC0tPiBzbyB3ZSBrZWVwIGEgc2VwYXJhdGUgYmFsYW5jZSBzdWJzY3JpcHRpb24gZm9yIHRoZSBhY3RpdmUgYWNjb3VudFxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRCYWxhbmNlT3RoZXJBY2NvdW50cyhvYmpfYmFsYW5jZSkge1xuICAgICAgICAvLyBCYWxhbmNlIHN1YnNjcmlwdGlvbiByZXNwb25zZSByZWNlaXZlZCB3aGVuIG10NSB0cmFuc2ZlciBpcyBpbiBwcm9ncmVzcyBzaG91bGQgYmUgaWdub3JlZC5cbiAgICAgICAgLy8gQWZ0ZXIgbXQ1IHRyYW5zZmVyIGlzIGRvbmUsIGBiYWxhbmNlQWxsYCBpcyByZXF1ZXN0ZWQgYWxvbmcgd2l0aCBgbXQ1TG9naW5MaXN0YCBpbiBvcmRlciB0byB1cGRhdGUgdGhlIGNvcnJlY3QgYmFsYW5jZS5cbiAgICAgICAgaWYgKHRoaXMucm9vdF9zdG9yZS5tb2R1bGVzPy5jYXNoaWVyPy5pc01UNVRyYW5zZmVySW5Qcm9ncmVzcygpKSByZXR1cm47XG5cbiAgICAgICAgLy8gT25seSB0aGUgZmlyc3QgcmVzcG9uc2Ugb2YgYmFsYW5jZTphbGwgd2lsbCBpbmNsdWRlIGFsbCBhY2NvdW50c1xuICAgICAgICAvLyBzdWJzZXF1ZW50IHJlcXVlc3RzIHdpbGwgYmUgc2luZ2xlIGFjY291bnQgYmFsYW5jZSB1cGRhdGVzXG4gICAgICAgIGlmICh0aGlzLmFjY291bnRzW29ial9iYWxhbmNlPy5sb2dpbmlkXSAmJiAhb2JqX2JhbGFuY2UuYWNjb3VudHMgJiYgb2JqX2JhbGFuY2UubG9naW5pZCAhPT0gdGhpcy5sb2dpbmlkKSB7XG4gICAgICAgICAgICB0aGlzLmFjY291bnRzW29ial9iYWxhbmNlLmxvZ2luaWRdLmJhbGFuY2UgPSBvYmpfYmFsYW5jZS5iYWxhbmNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuYWNjb3VudHNbb2JqX2JhbGFuY2U/LmxvZ2luaWRdICYmIG9ial9iYWxhbmNlLmFjY291bnRzKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhvYmpfYmFsYW5jZS5hY2NvdW50cykuZm9yRWFjaChhY2NvdW50X2lkID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc19hY3RpdmVfYWNjb3VudF9pZCA9IGFjY291bnRfaWQgPT09IHRoaXMubG9naW5pZDtcblxuICAgICAgICAgICAgICAgIGlmICghaXNfYWN0aXZlX2FjY291bnRfaWQgJiYgdGhpcy5hY2NvdW50c1thY2NvdW50X2lkXSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjY291bnRzW2FjY291bnRfaWRdLmJhbGFuY2UgPSArb2JqX2JhbGFuY2UuYWNjb3VudHNbYWNjb3VudF9pZF0uYmFsYW5jZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvYmpfYmFsYW5jZS50b3RhbCkge1xuICAgICAgICAgICAgY29uc3QgdG90YWxfcmVhbCA9IGdldFByb3BlcnR5VmFsdWUob2JqX2JhbGFuY2UsIFsndG90YWwnLCAnZGVyaXYnXSk7XG4gICAgICAgICAgICBjb25zdCB0b3RhbF9tdDUgPSBnZXRQcm9wZXJ0eVZhbHVlKG9ial9iYWxhbmNlLCBbJ3RvdGFsJywgQ0ZEX1BMQVRGT1JNUy5NVDVdKTtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsX2R4dHJhZGUgPSBnZXRQcm9wZXJ0eVZhbHVlKG9ial9iYWxhbmNlLCBbJ3RvdGFsJywgQ0ZEX1BMQVRGT1JNUy5EWFRSQURFXSk7XG4gICAgICAgICAgICAvLyBpbiBBUEkgc3RyZWFtaW5nIHJlc3BvbnNlcyBNVDUgYmFsYW5jZSBpcyBub3QgcmUtc2VudCwgc28gd2UgbmVlZCB0byByZXVzZSB0aGUgZmlyc3QgbXQ1IHRvdGFsIHNlbnRcbiAgICAgICAgICAgIGNvbnN0IGhhc19tdDUgPSAhaXNFbXB0eU9iamVjdCh0b3RhbF9tdDUpO1xuICAgICAgICAgICAgY29uc3QgaGFzX2R4dHJhZGUgPSAhaXNFbXB0eU9iamVjdCh0b3RhbF9keHRyYWRlKTtcbiAgICAgICAgICAgIHRoaXMub2JqX3RvdGFsX2JhbGFuY2UgPSB7XG4gICAgICAgICAgICAgICAgYW1vdW50X3JlYWw6ICt0b3RhbF9yZWFsLmFtb3VudCxcbiAgICAgICAgICAgICAgICBhbW91bnRfbXQ1OiBoYXNfbXQ1ID8gK3RvdGFsX210NS5hbW91bnQgOiB0aGlzLm9ial90b3RhbF9iYWxhbmNlLmFtb3VudF9tdDUsXG4gICAgICAgICAgICAgICAgYW1vdW50X2R4dHJhZGU6IGhhc19keHRyYWRlID8gK3RvdGFsX2R4dHJhZGUuYW1vdW50IDogdGhpcy5vYmpfdG90YWxfYmFsYW5jZS5hbW91bnRfZHh0cmFkZSxcbiAgICAgICAgICAgICAgICBjdXJyZW5jeTogdG90YWxfcmVhbC5jdXJyZW5jeSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2VsZWN0Q3VycmVuY3kodmFsdWUpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZF9jdXJyZW5jeSA9IHZhbHVlO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRSZXNpZGVuY2UocmVzaWRlbmNlKSB7XG4gICAgICAgIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5yZXNpZGVuY2UgPSByZXNpZGVuY2U7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldEVtYWlsKGVtYWlsKSB7XG4gICAgICAgIHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5lbWFpbCA9IGVtYWlsO1xuICAgICAgICB0aGlzLmVtYWlsID0gZW1haWw7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldEFjY291bnRTZXR0aW5ncyhzZXR0aW5ncykge1xuICAgICAgICB0aGlzLmFjY291bnRfc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgdGhpcy5pc19hY2NvdW50X3NldHRpbmdfbG9hZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0QWNjb3VudFN0YXR1cyhzdGF0dXMpIHtcbiAgICAgICAgdGhpcy5hY2NvdW50X3N0YXR1cyA9IHN0YXR1cztcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0SW5pdGlhbGl6ZWQoaXNfaW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgdGhpcy5pbml0aWFsaXplZF9icm9hZGNhc3QgPSBpc19pbml0aWFsaXplZDtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgY2xlYW5VcCgpIHtcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLmd0bS5wdXNoRGF0YUxheWVyKHtcbiAgICAgICAgICAgIGV2ZW50OiAnbG9nX291dCcsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmxvZ2luaWQgPSBudWxsO1xuICAgICAgICB0aGlzLnVzZXJfaWQgPSBudWxsO1xuICAgICAgICB0aGlzLnVwZ3JhZGVfaW5mbyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5hY2NvdW50cyA9IHt9O1xuICAgICAgICB0aGlzLm10NV9sb2dpbl9saXN0ID0gW107XG4gICAgICAgIHRoaXMubGFuZGluZ19jb21wYW5pZXMgPSB7fTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZV9sb2dpbmlkJywgdGhpcy5sb2dpbmlkKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NsaWVudC5hY2NvdW50cycsIEpTT04uc3RyaW5naWZ5KHRoaXMuYWNjb3VudHMpKTtcblxuICAgICAgICBydW5JbkFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlUGF5b3V0Q3VycmVuY2llcyhhd2FpdCBXUy5wYXlvdXRDdXJyZW5jaWVzKCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLnJlbW92ZUFsbE5vdGlmaWNhdGlvbk1lc3NhZ2VzKHRydWUpO1xuICAgICAgICB0aGlzLnN5bmNXaXRoTGVnYWN5UGxhdGZvcm1zKHRoaXMubG9naW5pZCwgdGhpcy5hY2NvdW50cyk7XG4gICAgICAgIHRoaXMuY2xlYW51cFJlYWxpdHlDaGVjaygpO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBsb2dvdXQoKSB7XG4gICAgICAgIC8vIFRPRE86IFthZGQtY2xpZW50LWFjdGlvbl0gLSBNb3ZlIGxvZ291dCBmdW5jdGlvbmFsaXR5IHRvIGNsaWVudCBzdG9yZVxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RMb2dvdXQoKTtcblxuICAgICAgICBpZiAocmVzcG9uc2UubG9nb3V0ID09PSAxKSB7XG4gICAgICAgICAgICB0aGlzLmNsZWFuVXAoKTtcblxuICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnJ1ZGRlcnN0YWNrLnJlc2V0KCk7XG4gICAgICAgICAgICB0aGlzLnNldExvZ291dCh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0TG9nb3V0KGlzX2xvZ2dlZF9vdXQpIHtcbiAgICAgICAgdGhpcy5oYXNfbG9nZ2VkX291dCA9IGlzX2xvZ2dlZF9vdXQ7XG4gICAgICAgIGlmICh0aGlzLnJvb3Rfc3RvcmUuY29tbW9uLmhhc19lcnJvcikgdGhpcy5yb290X3N0b3JlLmNvbW1vbi5zZXRFcnJvcihmYWxzZSwgbnVsbCk7XG4gICAgfVxuXG4gICAgLyogZXNsaW50LWRpc2FibGUgKi9cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc3RvcmVDbGllbnRBY2NvdW50cyhvYmpfcGFyYW1zLCBhY2NvdW50X2xpc3QpIHtcbiAgICAgICAgLy8gc3RvcmUgY29uc2lzdGVudCBuYW1lcyB3aXRoIG90aGVyIEFQSSBjYWxsc1xuICAgICAgICAvLyBBUElfVjQ6IHNlbmQgY29uc2lzdGVudCBuYW1lc1xuICAgICAgICBjb25zdCBtYXBfbmFtZXMgPSB7XG4gICAgICAgICAgICBjb3VudHJ5OiAncmVzaWRlbmNlJyxcbiAgICAgICAgICAgIGxhbmRpbmdfY29tcGFueV9uYW1lOiAnbGFuZGluZ19jb21wYW55X3Nob3J0Y29kZScsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNsaWVudF9vYmplY3QgPSB7fTtcbiAgICAgICAgbGV0IGFjdGl2ZV9sb2dpbmlkO1xuXG4gICAgICAgIGlmIChvYmpfcGFyYW1zLnNlbGVjdGVkX2FjY3QpIHtcbiAgICAgICAgICAgIGFjdGl2ZV9sb2dpbmlkID0gb2JqX3BhcmFtcy5zZWxlY3RlZF9hY2N0O1xuICAgICAgICB9XG5cbiAgICAgICAgYWNjb3VudF9saXN0LmZvckVhY2goZnVuY3Rpb24gKGFjY291bnQpIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGFjY291bnQpLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtID09PSAnbG9naW5pZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3RpdmVfbG9naW5pZCAmJiAhYWNjb3VudC5pc19kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY2NvdW50LmlzX3ZpcnR1YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVfbG9naW5pZCA9IGFjY291bnRbcGFyYW1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY2NvdW50LmlzX3ZpcnR1YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBbb25seV92aXJ0dWFsXSByZW1vdmUgdGhpcyB0byBzdG9wIGxvZ2dpbmcgbm9uLVNWRyBjbGllbnRzIGludG8gdmlydHVhbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZV9sb2dpbmlkID0gYWNjb3VudFtwYXJhbV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJhbV90b19zZXQgPSBtYXBfbmFtZXNbcGFyYW1dIHx8IHBhcmFtO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZV90b19zZXQgPSB0eXBlb2YgYWNjb3VudFtwYXJhbV0gPT09ICd1bmRlZmluZWQnID8gJycgOiBhY2NvdW50W3BhcmFtXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEoYWNjb3VudC5sb2dpbmlkIGluIGNsaWVudF9vYmplY3QpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfb2JqZWN0W2FjY291bnQubG9naW5pZF0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjbGllbnRfb2JqZWN0W2FjY291bnQubG9naW5pZF1bcGFyYW1fdG9fc2V0XSA9IHZhbHVlX3RvX3NldDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGkgPSAxO1xuICAgICAgICB3aGlsZSAob2JqX3BhcmFtc1tgYWNjdCR7aX1gXSkge1xuICAgICAgICAgICAgY29uc3QgbG9naW5pZCA9IG9ial9wYXJhbXNbYGFjY3Qke2l9YF07XG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IG9ial9wYXJhbXNbYHRva2VuJHtpfWBdO1xuICAgICAgICAgICAgaWYgKGxvZ2luaWQgJiYgdG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjbGllbnRfb2JqZWN0W2xvZ2luaWRdLnRva2VuID0gdG9rZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiBkaWRuJ3QgZmluZCBhbnkgbG9naW4gSUQgdGhhdCBtYXRjaGVkIHRoZSBhYm92ZSBjb25kaXRpb25cbiAgICAgICAgLy8gb3IgdGhlIHNlbGVjdGVkIG9uZSBkb2Vzbid0IGhhdmUgYSB0b2tlbiwgc2V0IHRoZSBmaXJzdCBvbmVcbiAgICAgICAgaWYgKCFhY3RpdmVfbG9naW5pZCB8fCAhY2xpZW50X29iamVjdFthY3RpdmVfbG9naW5pZF0udG9rZW4pIHtcbiAgICAgICAgICAgIGFjdGl2ZV9sb2dpbmlkID0gb2JqX3BhcmFtcy5hY2N0MTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRPRE86IHNlbmQgbG9naW4gZmxhZyB0byBHVE0gaWYgbmVlZGVkXG4gICAgICAgIGlmIChhY3RpdmVfbG9naW5pZCAmJiBPYmplY3Qua2V5cyhjbGllbnRfb2JqZWN0KS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVfbG9naW5pZCcsIGFjdGl2ZV9sb2dpbmlkKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjbGllbnQuYWNjb3VudHMnLCBKU09OLnN0cmluZ2lmeShjbGllbnRfb2JqZWN0KSk7XG4gICAgICAgICAgICB0aGlzLnN5bmNXaXRoTGVnYWN5UGxhdGZvcm1zKGFjdGl2ZV9sb2dpbmlkLCB0aGlzLmFjY291bnRzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBzZXRVc2VyTG9naW4obG9naW5fbmV3X3VzZXIpIHtcbiAgICAgICAgLy8gbG9naW5fbmV3X3VzZXIgaXMgcG9wdWxhdGVkIG9ubHkgb24gdmlydHVhbCBzaWduLXVwXG4gICAgICAgIGxldCBvYmpfcGFyYW1zID0ge307XG4gICAgICAgIGNvbnN0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG5cbiAgICAgICAgaWYgKHNlYXJjaCkge1xuICAgICAgICAgICAgbGV0IHNlYXJjaF9wYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuXG4gICAgICAgICAgICBzZWFyY2hfcGFyYW1zLmZvckVhY2goKHZhbHVlLCBrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhY2NvdW50X2tleXMgPSBbJ2FjY3QnLCAndG9rZW4nLCAnY3VyJ107XG4gICAgICAgICAgICAgICAgY29uc3QgaXNfYWNjb3VudF9wYXJhbSA9IGFjY291bnRfa2V5cy5zb21lKFxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50X2tleSA9PiBrZXk/LmluY2x1ZGVzKGFjY291bnRfa2V5KSAmJiBrZXkgIT09ICdhZmZpbGlhdGVfdG9rZW4nXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmIChpc19hY2NvdW50X3BhcmFtKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ial9wYXJhbXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBkZWxldGUgYWNjb3VudCBxdWVyeSBwYXJhbXMgLSBidXQga2VlcCBvdGhlciBxdWVyeSBwYXJhbXMgKGUuZy4gdXRtKVxuICAgICAgICAgICAgT2JqZWN0LmtleXMob2JqX3BhcmFtcykuZm9yRWFjaChrZXkgPT4gc2VhcmNoX3BhcmFtcy5kZWxldGUoa2V5KSk7XG4gICAgICAgICAgICBzZWFyY2hfcGFyYW1zLmRlbGV0ZSgnc3RhdGUnKTsgLy8gcmVtb3ZlIHVudXNlZCBzdGF0ZT0gcXVlcnkgc3RyaW5nXG4gICAgICAgICAgICBzZWFyY2hfcGFyYW1zID0gc2VhcmNoX3BhcmFtcz8udG9TdHJpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IHNlYXJjaF9wYXJhbV93aXRob3V0X2FjY291bnQgPSBzZWFyY2hfcGFyYW1zID8gYD8ke3NlYXJjaF9wYXJhbXN9YCA6ICcvJztcbiAgICAgICAgICAgIGhpc3RvcnkucmVwbGFjZVN0YXRlKG51bGwsIG51bGwsIGAke3NlYXJjaF9wYXJhbV93aXRob3V0X2FjY291bnR9JHt3aW5kb3cubG9jYXRpb24uaGFzaH1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzX2NsaWVudF9sb2dnaW5nX2luID0gbG9naW5fbmV3X3VzZXIgPyBsb2dpbl9uZXdfdXNlci50b2tlbjEgOiBvYmpfcGFyYW1zLnRva2VuMTtcbiAgICAgICAgaWYgKGlzX2NsaWVudF9sb2dnaW5nX2luKSB7XG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sIGRvY3VtZW50LnRpdGxlLCBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdyZWRpcmVjdF91cmwnKSk7XG4gICAgICAgICAgICBTb2NrZXRDYWNoZS5jbGVhcigpO1xuICAgICAgICAgICAgLy8gaXNfcG9wdWxhdGluZ19hY2NvdW50X2xpc3QgaXMgdXNlZCBmb3Igc29ja2V0IGdlbmVyYWwgdG8ga25vdyBub3QgdG8gZmlsdGVyIHRoZSBmaXJzdC10aW1lIGxvZ2luc1xuICAgICAgICAgICAgdGhpcy5pc19wb3B1bGF0aW5nX2FjY291bnRfbGlzdCA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBhdXRob3JpemVfcmVzcG9uc2UgPSBhd2FpdCBCaW5hcnlTb2NrZXQuYXV0aG9yaXplKGlzX2NsaWVudF9sb2dnaW5nX2luKTtcblxuICAgICAgICAgICAgaWYgKGxvZ2luX25ld191c2VyKSB7XG4gICAgICAgICAgICAgICAgLy8gb3ZlcndyaXRlIG9ial9wYXJhbXMgaWYgbG9naW4gaXMgZm9yIG5ldyB2aXJ0dWFsIGFjY291bnRcbiAgICAgICAgICAgICAgICBvYmpfcGFyYW1zID0gbG9naW5fbmV3X3VzZXI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhdXRob3JpemVfcmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXV0aG9yaXplX3Jlc3BvbnNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBydW5JbkFjdGlvbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgYWNjb3VudF9saXN0ID0gKGF1dGhvcml6ZV9yZXNwb25zZS5hdXRob3JpemUgfHwge30pLmFjY291bnRfbGlzdDtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzID0gWy4uLm5ldyBTZXQoYXV0aG9yaXplX3Jlc3BvbnNlLnVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzKV07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW5TdG9yZUNsaWVudEFjY291bnRzKG9ial9wYXJhbXMsIGFjY291bnRfbGlzdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9yZUNsaWVudEFjY291bnRzKG9ial9wYXJhbXMsIGFjY291bnRfbGlzdCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2luY2UgdGhlcmUgaXMgbm8gQVBJIGVycm9yLCB3ZSBoYXZlIHRvIGFkZCB0aGlzIHRvIG1hbnVhbGx5IHRyaWdnZXIgY2hlY2tzIGluIG90aGVyIHBhcnRzIG9mIHRoZSBjb2RlLlxuICAgICAgICAgICAgICAgICAgICBhdXRob3JpemVfcmVzcG9uc2UuZXJyb3IgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiAnTWlzbWF0Y2hlZEFjY3QnLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbG9jYWxpemUoJ0ludmFsaWQgdG9rZW4nKSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBhdXRob3JpemVfcmVzcG9uc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgY2FuU3RvcmVDbGllbnRBY2NvdW50cyhvYmpfcGFyYW1zLCBhY2NvdW50X2xpc3QpIHtcbiAgICAgICAgY29uc3QgaXNfcmVhZHlfdG9fcHJvY2VzcyA9IGFjY291bnRfbGlzdCAmJiBpc0VtcHR5T2JqZWN0KHRoaXMuYWNjb3VudHMpO1xuICAgICAgICBjb25zdCBhY2N0cyA9IE9iamVjdC5rZXlzKG9ial9wYXJhbXMpLmZpbHRlcih2YWx1ZSA9PiAvXmFjY3QuLy50ZXN0KHZhbHVlKSk7XG5cbiAgICAgICAgY29uc3QgaXNfY3Jvc3NfY2hlY2tlZCA9IGFjY3RzLmV2ZXJ5KGFjY3QgPT5cbiAgICAgICAgICAgIGFjY291bnRfbGlzdC5zb21lKGFjY291bnQgPT4gYWNjb3VudC5sb2dpbmlkID09PSBvYmpfcGFyYW1zW2FjY3RdKVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBpc19yZWFkeV90b19wcm9jZXNzICYmIGlzX2Nyb3NzX2NoZWNrZWQ7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFZlcmlmaWNhdGlvbkNvZGUoY29kZSwgYWN0aW9uKSB7XG4gICAgICAgIHRoaXMudmVyaWZpY2F0aW9uX2NvZGVbYWN0aW9uXSA9IGNvZGU7XG4gICAgICAgIGlmIChjb2RlKSB7XG4gICAgICAgICAgICBMb2NhbFN0b3JlLnNldChgdmVyaWZpY2F0aW9uX2NvZGUuJHthY3Rpb259YCwgY29kZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBMb2NhbFN0b3JlLnJlbW92ZShgdmVyaWZpY2F0aW9uX2NvZGUuJHthY3Rpb259YCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3NpZ251cCcpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IGFkZCBhd2FpdCBpZiBlcnJvciBoYW5kbGluZyBuZWVkcyB0byBoYXBwZW4gYmVmb3JlIEFjY291bnRTaWdudXAgaXMgaW5pdGlhbGlzZWRcbiAgICAgICAgICAgIHRoaXMuZmV0Y2hSZXNpZGVuY2VMaXN0KCk7IC8vIFByZWZldGNoIGZvciB1c2UgaW4gYWNjb3VudCBzaWdudXAgcHJvY2Vzc1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldERldmljZURhdGEoKSB7XG4gICAgICAgIHNldERldmljZURhdGFDb29raWUoJ3NpZ251cF9kZXZpY2UnLCBpc0Rlc2t0b3BPcygpID8gJ2Rlc2t0b3AnIDogJ21vYmlsZScpO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBnZXRTaWdudXBQYXJhbXMoKSB7XG4gICAgICAgIGNvbnN0IHBhcmFtX2xpc3QgPSBbXG4gICAgICAgICAgICAnZGF0ZV9maXJzdF9jb250YWN0JyxcbiAgICAgICAgICAgICdzaWdudXBfZGV2aWNlJyxcbiAgICAgICAgICAgICdnY2xpZF91cmwnLFxuICAgICAgICAgICAgJ3V0bV9zb3VyY2UnLFxuICAgICAgICAgICAgJ3V0bV9hZF9pZCcsXG4gICAgICAgICAgICAndXRtX2FkZ3JvdXBfaWQnLFxuICAgICAgICAgICAgJ3V0bV9hZHJvbGxjbGtfaWQnLFxuICAgICAgICAgICAgJ3V0bV9jYW1wYWlnbl9pZCcsXG4gICAgICAgICAgICAndXRtX2NhbXBhaWduJyxcbiAgICAgICAgICAgICd1dG1fZmJjbF9pZCcsXG4gICAgICAgICAgICAndXRtX2dsX2NsaWVudF9pZCcsXG4gICAgICAgICAgICAndXRtX21zY2xrX2lkJyxcbiAgICAgICAgICAgICd1dG1fbWVkaXVtJyxcbiAgICAgICAgICAgICd1dG1fdGVybScsXG4gICAgICAgICAgICAndXRtX2NvbnRlbnQnLFxuICAgICAgICAgICAgJ2FmZmlsaWF0ZV90b2tlbicsXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IHNpZ251cF9wYXJhbXMgPSB7fTtcbiAgICAgICAgY29uc3QgdXJsX3BhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XG5cbiAgICAgICAgcGFyYW1fbGlzdC5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAodXJsX3BhcmFtcy5nZXQoa2V5KSkge1xuICAgICAgICAgICAgICAgIHNpZ251cF9wYXJhbXNba2V5XSA9IHVybF9wYXJhbXMuZ2V0KGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBzaWdudXBfcGFyYW1zO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBvblNldFJlc2lkZW5jZSh7IHJlc2lkZW5jZSB9LCBjYikge1xuICAgICAgICBpZiAoIXJlc2lkZW5jZSkgcmV0dXJuO1xuICAgICAgICBXUy5zZXRTZXR0aW5ncyh7XG4gICAgICAgICAgICByZXNpZGVuY2UsXG4gICAgICAgIH0pLnRoZW4oYXN5bmMgcmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgY2IocmVzcG9uc2UuZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0UmVzaWRlbmNlKHJlc2lkZW5jZSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgV1MuYXV0aG9yaXplZC5zdG9yYWdlXG4gICAgICAgICAgICAgICAgICAgIC5sYW5kaW5nQ29tcGFueSh0aGlzLmFjY291bnRzW3RoaXMubG9naW5pZF0ucmVzaWRlbmNlKVxuICAgICAgICAgICAgICAgICAgICAudGhlbih0aGlzLnJlc3BvbnNlTGFuZGluZ0NvbXBhbnkpO1xuICAgICAgICAgICAgICAgIGF3YWl0IFdTLmF1dGhvcml6ZWQuc3RvcmFnZS5nZXRTZXR0aW5ncygpLnRoZW4oYXN5bmMgcmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEFjY291bnRTZXR0aW5ncyhyZXNwb25zZS5nZXRfc2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJ1bkluQWN0aW9uKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgQmluYXJ5U29ja2V0LmF1dGhvcml6ZSh0aGlzLmdldFRva2VuKCkpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcnVuSW5BY3Rpb24oKCkgPT4gKHRoaXMudXBncmFkZV9pbmZvID0gdGhpcy5nZXRCYXNpY1VwZ3JhZGVJbmZvKCkpKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY2IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIG9uU2lnbnVwKHsgcGFzc3dvcmQsIHJlc2lkZW5jZSwgZW1haWxfY29uc2VudCB9LCBjYikge1xuICAgICAgICBpZiAoIXRoaXMudmVyaWZpY2F0aW9uX2NvZGUuc2lnbnVwIHx8ICFwYXNzd29yZCB8fCAhcmVzaWRlbmNlKSByZXR1cm47XG4gICAgICAgIGlmIChlbWFpbF9jb25zZW50ID09PSB1bmRlZmluZWQpIHJldHVybjtcbiAgICAgICAgZW1haWxfY29uc2VudCA9IGVtYWlsX2NvbnNlbnQgPyAxIDogMDtcbiAgICAgICAgV1MubmV3QWNjb3VudFZpcnR1YWwoXG4gICAgICAgICAgICB0aGlzLnZlcmlmaWNhdGlvbl9jb2RlLnNpZ251cCxcbiAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgcmVzaWRlbmNlLFxuICAgICAgICAgICAgZW1haWxfY29uc2VudCxcbiAgICAgICAgICAgIHRoaXMuZ2V0U2lnbnVwUGFyYW1zKClcbiAgICAgICAgKS50aGVuKGFzeW5jIHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvcikge1xuICAgICAgICAgICAgICAgIGNiKHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYigpO1xuICAgICAgICAgICAgICAgIC8vIEluaXRpYWxpemUgY2xpZW50IHN0b3JlIHdpdGggbmV3IHVzZXIgbG9naW5cbiAgICAgICAgICAgICAgICBjb25zdCB7IGNsaWVudF9pZCwgY3VycmVuY3ksIG9hdXRoX3Rva2VuIH0gPSByZXNwb25zZS5uZXdfYWNjb3VudF92aXJ0dWFsO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc3dpdGNoVG9OZXdseUNyZWF0ZWRBY2NvdW50KGNsaWVudF9pZCwgb2F1dGhfdG9rZW4sIGN1cnJlbmN5KTtcblxuICAgICAgICAgICAgICAgIC8vIEdUTSBTaWdudXAgZXZlbnRcbiAgICAgICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUuZ3RtLnB1c2hEYXRhTGF5ZXIoe1xuICAgICAgICAgICAgICAgICAgICBldmVudDogJ3ZpcnR1YWxfc2lnbnVwJyxcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jb3VudHJ5X3N0YW5kcG9pbnQuaXNfZnJhbmNlICYmICF0aGlzLmNvdW50cnlfc3RhbmRwb2ludC5pc19iZWxnaXVtICYmIHJlc2lkZW5jZSAhPT0gJ2ltJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUudWkudG9nZ2xlV2VsY29tZU1vZGFsKHsgaXNfdmlzaWJsZTogdHJ1ZSwgc2hvdWxkX3BlcnNpc3Q6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhc3luYyBzd2l0Y2hUb05ld2x5Q3JlYXRlZEFjY291bnQoY2xpZW50X2lkLCBvYXV0aF90b2tlbiwgY3VycmVuY3kpIHtcbiAgICAgICAgdGhpcy5zZXRQcmVTd2l0Y2hBY2NvdW50KHRydWUpO1xuICAgICAgICBjb25zdCBuZXdfdXNlcl9sb2dpbiA9IHtcbiAgICAgICAgICAgIGFjY3QxOiBjbGllbnRfaWQsXG4gICAgICAgICAgICB0b2tlbjE6IG9hdXRoX3Rva2VuLFxuICAgICAgICAgICAgY3VycjE6IGN1cnJlbmN5LFxuICAgICAgICB9O1xuICAgICAgICBhd2FpdCB0aGlzLmluaXQobmV3X3VzZXJfbG9naW4pO1xuICAgICAgICB0aGlzLmJyb2FkY2FzdEFjY291bnRDaGFuZ2UoKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgZmV0Y2hBY2NvdW50U2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgIFdTLmF1dGhvcml6ZWQuc3RvcmFnZS5nZXRTZXR0aW5ncygpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QWNjb3VudFNldHRpbmdzKHJlc3BvbnNlLmdldF9zZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGZldGNoUmVzaWRlbmNlTGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICAgICAgV1Muc3RvcmFnZS5yZXNpZGVuY2VMaXN0KCkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRSZXNpZGVuY2VMaXN0KHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0UmVzaWRlbmNlTGlzdChyZXNpZGVuY2VfbGlzdF9yZXNwb25zZSkge1xuICAgICAgICB0aGlzLnJlc2lkZW5jZV9saXN0ID0gcmVzaWRlbmNlX2xpc3RfcmVzcG9uc2UucmVzaWRlbmNlX2xpc3QgfHwgW107XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGZldGNoU3RhdGVzTGlzdCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIFdTLmF1dGhvcml6ZWQuc3RvcmFnZVxuICAgICAgICAgICAgICAgIC5zdGF0ZXNMaXN0KHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVzX2xpc3Q6IHRoaXMuYWNjb3VudHNbdGhpcy5sb2dpbmlkXS5yZXNpZGVuY2UsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlLmVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bkluQWN0aW9uKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlc19saXN0ID0gcmVzcG9uc2Uuc3RhdGVzX2xpc3QgfHwgW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHJlc2V0TXQ1TGlzdFBvcHVsYXRlZFN0YXRlKCkge1xuICAgICAgICB0aGlzLmlzX210NV9hY2NvdW50X2xpc3RfdXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzX3BvcHVsYXRpbmdfbXQ1X2FjY291bnRfbGlzdCA9IHRydWU7XG4gICAgICAgIHRoaXMubXQ1X2xvZ2luX2xpc3RfZXJyb3IgPSBudWxsO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyB1cGRhdGVNdDVMb2dpbkxpc3QoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzX2xvZ2dlZF9pbiAmJiAhdGhpcy5pc19tdDVfYWNjb3VudF9saXN0X3VwZGF0ZWQgJiYgIXRoaXMuaXNfcG9wdWxhdGluZ19tdDVfYWNjb3VudF9saXN0KSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IFdTLm10NUxvZ2luTGlzdCgpO1xuICAgICAgICAgICAgdGhpcy5yZXNwb25zZU10NUxvZ2luTGlzdChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzcG9uc2VNVDVUcmFkaW5nU2VydmVycyhyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMubXQ1X3RyYWRpbmdfc2VydmVycyA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubXQ1X3RyYWRpbmdfc2VydmVycyA9IHJlc3BvbnNlLnRyYWRpbmdfc2VydmVycztcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzcG9uc2VNdDVMb2dpbkxpc3QocmVzcG9uc2UpIHtcbiAgICAgICAgdGhpcy5pc19wb3B1bGF0aW5nX210NV9hY2NvdW50X2xpc3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5pc19tdDVfYWNjb3VudF9saXN0X3VwZGF0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm10NV9sb2dpbl9saXN0X2Vycm9yID0gbnVsbDtcbiAgICAgICAgLyoqIHdlIG5lZWQgdG8gdXBkYXRlIG10NV9sb2dpbl9saXN0IG9uIG1vdW50IG9mIGFjY291bnQgc3dpdGNoZXJcbiAgICAgICAgICogIHRvIGdldCB0aGUgbmV3IE1UNSBiYWxhbmNlcyAoYmFsYW5jZSBkb2VzIG5vdCBzdHJlYW0gZm9yIE1UNSBhY2NvdW50cyBkdWUgdG8gQVBJIHJlc3RyaWN0aW9uKVxuICAgICAgICAgKiAgYnV0IHRvIGF2b2lkIHNwYW1taW5nIHRoaXMgY2FsbCBzaW5jZSB0aGUgcmF0ZSBsaW1pdCBpcyBzdHJpY3RcbiAgICAgICAgICogIGtlZXAgdGhlIGN1cnJlbnQgbXQ1X2xvZ2luX2xpc3QgcmVzcG9uc2UgY2FjaGVkIGZvciBvbmUgbWludXRlXG4gICAgICAgICAqICBhZnRlciBvbmUgbWludXRlIGNvbnNpZGVyIGl0IG91dGRhdGVkIGFuZCBhbGxvdyByZS1yZXF1ZXN0aW5nIGl0ICovXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pc19tdDVfYWNjb3VudF9saXN0X3VwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgfSwgNjAwMDApO1xuXG4gICAgICAgIGlmICghcmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXMubXQ1X2xvZ2luX2xpc3QgPSByZXNwb25zZS5tdDVfbG9naW5fbGlzdC5tYXAoYWNjb3VudCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGlzcGxheV9sb2dpbiA9IChhY2NvdW50LmVycm9yID8gYWNjb3VudC5lcnJvci5kZXRhaWxzLmxvZ2luIDogYWNjb3VudC5sb2dpbikucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgL14oTVRbRFJdPykvaSxcbiAgICAgICAgICAgICAgICAgICAgJydcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGlmIChhY2NvdW50LmVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgYWNjb3VudF90eXBlLCBzZXJ2ZXIgfSA9IGFjY291bnQuZXJyb3IuZGV0YWlscztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRNVDVEaXNhYmxlZFNpZ251cFR5cGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFthY2NvdW50X3R5cGVdOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRfdHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlfbG9naW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNfZXJyb3I6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXIsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLmFjY291bnQsXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlfbG9naW4sXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tdDVfbG9naW5fbGlzdF9lcnJvciA9IHJlc3BvbnNlLmVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHJlc3BvbnNlRHh0cmFkZVRyYWRpbmdTZXJ2ZXJzKHJlc3BvbnNlKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5lcnJvcikge1xuICAgICAgICAgICAgdGhpcy5keHRyYWRlX3RyYWRpbmdfc2VydmVycyA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZHh0cmFkZV90cmFkaW5nX3NlcnZlcnMgPSByZXNwb25zZS50cmFkaW5nX3NlcnZlcnM7XG5cbiAgICAgICAgdGhpcy5keHRyYWRlX3RyYWRpbmdfc2VydmVycy5mb3JFYWNoKHRyYWRpbmdfc2VydmVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgYWNjb3VudF90eXBlLCBkaXNhYmxlZCB9ID0gdHJhZGluZ19zZXJ2ZXI7XG4gICAgICAgICAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldENGRERpc2FibGVkU2lnbnVwVHlwZXMoQ0ZEX1BMQVRGT1JNUy5EWFRSQURFLCB7XG4gICAgICAgICAgICAgICAgICAgIFthY2NvdW50X3R5cGVdOiB0cnVlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcmVzcG9uc2VUcmFkaW5nUGxhdGZvcm1BY2NvdW50c0xpc3QocmVzcG9uc2UpIHtcbiAgICAgICAgY29uc3QgeyBwbGF0Zm9ybSB9ID0gcmVzcG9uc2UuZWNob19yZXEgfHwge307XG5cbiAgICAgICAgdGhpc1tgaXNfcG9wdWxhdGluZ18ke3BsYXRmb3JtfV9hY2NvdW50X2xpc3RgXSA9IGZhbHNlO1xuICAgICAgICB0aGlzW2Ake3BsYXRmb3JtfV9hY2NvdW50c19saXN0X2Vycm9yYF0gPSBudWxsO1xuXG4gICAgICAgIGlmICghcmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgIHRoaXNbYCR7cGxhdGZvcm19X2FjY291bnRzX2xpc3RgXSA9IHJlc3BvbnNlLnRyYWRpbmdfcGxhdGZvcm1fYWNjb3VudHMubWFwKGFjY291bnQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlfbG9naW4gPSBhY2NvdW50LmVycm9yID8gYWNjb3VudC5lcnJvci5kZXRhaWxzLmFjY291bnRfaWQgOiBhY2NvdW50LmFjY291bnRfaWQ7XG4gICAgICAgICAgICAgICAgaWYgKGFjY291bnQuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBhY2NvdW50X3R5cGUsIHNlcnZlciB9ID0gYWNjb3VudC5lcnJvci5kZXRhaWxzO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGxhdGZvcm0gPT09IENGRF9QTEFURk9STVMuRFhUUkFERSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRDRkREaXNhYmxlZFNpZ251cFR5cGVzKHBsYXRmb3JtLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgW2FjY291bnRfdHlwZV06IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudF90eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheV9sb2dpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc19lcnJvcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlcixcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgLi4uYWNjb3VudCxcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheV9sb2dpbixcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzW2Ake3BsYXRmb3JtfV9hY2NvdW50c19saXN0X2Vycm9yYF0gPSByZXNwb25zZS5lcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICByZXNwb25zZVN0YXRlbWVudChyZXNwb25zZSkge1xuICAgICAgICBpZiAoIXJlc3BvbnNlLmVycm9yKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlbWVudCA9IHJlc3BvbnNlLnN0YXRlbWVudDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBnZXRDaGFuZ2VhYmxlRmllbGRzKCkge1xuICAgICAgICBjb25zdCBnZXRfc2V0dGluZ3MgPVxuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5hY2NvdW50X3NldHRpbmdzKS5sZW5ndGggPT09IDBcbiAgICAgICAgICAgICAgICA/IFdTLmF1dGhvcml6ZWQuc3RvcmFnZS5nZXRTZXR0aW5ncygpXG4gICAgICAgICAgICAgICAgOiB0aGlzLmFjY291bnRfc2V0dGluZ3M7XG5cbiAgICAgICAgY29uc3QgcmVhZG9ubHlfZmllbGRzID0gWy4uLmdldF9zZXR0aW5ncy5pbW11dGFibGVfZmllbGRzLCAuLi5bJ2ltbXV0YWJsZV9maWVsZHMnLCAnZW1haWwnLCAncGFzc3dvcmQnXV07XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhnZXRfc2V0dGluZ3MpLmZpbHRlcihmaWVsZCA9PiAhcmVhZG9ubHlfZmllbGRzLmluY2x1ZGVzKGZpZWxkKSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHN5bmNXaXRoTGVnYWN5UGxhdGZvcm1zKGFjdGl2ZV9sb2dpbmlkLCBjbGllbnRfYWNjb3VudHMpIHtcbiAgICAgICAgY29uc3Qgc21hcnRUcmFkZXIgPSB7fTtcbiAgICAgICAgY29uc3QgYmluYXJ5Qm90ID0ge307XG5cbiAgICAgICAgc21hcnRUcmFkZXIuaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvY2Fsc3RvcmFnZS1zeW5jJyk7XG4gICAgICAgIGJpbmFyeUJvdC5pZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9jYWxzdG9yYWdlLXN5bmNfX2JvdCcpO1xuICAgICAgICBzbWFydFRyYWRlci5vcmlnaW4gPSBnZXRVcmxTbWFydFRyYWRlcigpO1xuICAgICAgICBiaW5hcnlCb3Qub3JpZ2luID0gZ2V0VXJsQmluYXJ5Qm90KCk7XG5cbiAgICAgICAgW3NtYXJ0VHJhZGVyLCBiaW5hcnlCb3RdLmZvckVhY2gocGxhdGZvcm0gPT4ge1xuICAgICAgICAgICAgaWYgKHBsYXRmb3JtLmlmcmFtZSkge1xuICAgICAgICAgICAgICAgIC8vIEtlZXAgY2xpZW50LmFjY291bnRzIGluIHN5bmMgKGluIGNhc2UgdXNlciB3YXNuJ3QgbG9nZ2VkIGluKS5cbiAgICAgICAgICAgICAgICBwbGF0Zm9ybS5pZnJhbWUuY29udGVudFdpbmRvdy5wb3N0TWVzc2FnZShcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5OiAnY2xpZW50LmFjY291bnRzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBKU09OLnN0cmluZ2lmeShjbGllbnRfYWNjb3VudHMpLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybS5vcmlnaW5cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHBsYXRmb3JtLmlmcmFtZS5jb250ZW50V2luZG93LnBvc3RNZXNzYWdlKFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk6ICdhY3RpdmVfbG9naW5pZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogYWN0aXZlX2xvZ2luaWQsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtLm9yaWdpblxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIEBjb21wdXRlZFxuICAgIGdldCBpc19oaWdoX3Jpc2soKSB7XG4gICAgICAgIGlmIChpc0VtcHR5T2JqZWN0KHRoaXMuYWNjb3VudF9zdGF0dXMpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiB0aGlzLmFjY291bnRfc3RhdHVzLnJpc2tfY2xhc3NpZmljYXRpb24gPT09ICdoaWdoJztcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgaGFzX3Jlc2lkZW5jZSgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5hY2NvdW50c1t0aGlzLmxvZ2luaWRdPy5yZXNpZGVuY2U7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFZpc2liaWxpdHlSZWFsaXR5Q2hlY2soaXNfdmlzaWJsZSkge1xuICAgICAgICAvLyBpZiByZWFsaXR5IGNoZWNrIHRpbWVvdXQgaGFzIGJlZW4gc2V0LCBkb24ndCBtYWtlIGl0IHZpc2libGUgdW50aWwgaXQgcnVucyBvdXRcbiAgICAgICAgaWYgKGlzX3Zpc2libGUgJiYgdHlwZW9mIHRoaXMucmVhbGl0eV9jaGVja190aW1lb3V0ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNfcmVhbGl0eV9jaGVja19kaXNtaXNzZWQgPSAhaXNfdmlzaWJsZTtcbiAgICAgICAgLy8gc3RvcmUgaW4gbG9jYWxzdG9yYWdlIHRvIGtlZXAgdHJhY2sgb2YgYWNyb3NzIHRhYnMvb24gcmVmcmVzaFxuICAgICAgICBMb2NhbFN0b3JlLnNldCgncmVhbGl0eV9jaGVja19kaXNtaXNzZWQnLCAhaXNfdmlzaWJsZSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGNsZWFyUmVhbGl0eUNoZWNrVGltZW91dCgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucmVhbGl0eV9jaGVja190aW1lb3V0KTtcbiAgICAgICAgdGhpcy5yZWFsaXR5X2NoZWNrX3RpbWVvdXQgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFJlYWxpdHlDaGVja0R1cmF0aW9uKGR1cmF0aW9uKSB7XG4gICAgICAgIHRoaXMucmVhbGl0eV9jaGVja19kdXIgPSArZHVyYXRpb247XG4gICAgICAgIHRoaXMuY2xlYXJSZWFsaXR5Q2hlY2tUaW1lb3V0KCk7XG4gICAgICAgIC8vIHN0b3JlIGluIGxvY2Fsc3RvcmFnZSB0byBrZWVwIHRyYWNrIG9mIGFjcm9zcyB0YWJzL29uIHJlZnJlc2hcbiAgICAgICAgTG9jYWxTdG9yZS5zZXQoJ3JlYWxpdHlfY2hlY2tfZHVyYXRpb24nLCArZHVyYXRpb24pO1xuICAgICAgICB0aGlzLnJlYWxpdHlfY2hlY2tfdGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgLy8gc2V0IHJlYWxpdHlfY2hlY2tfdGltZW91dCB0byB1bmRlZmluZWRcbiAgICAgICAgICAgIHRoaXMuY2xlYXJSZWFsaXR5Q2hlY2tUaW1lb3V0KCk7XG4gICAgICAgICAgICAvLyBhZnRlciB0aGlzIGR1cmF0aW9uIHBhc3Nlcywgc2hvdyB0aGUgc3VtbWFyeSBwb3AgdXBcbiAgICAgICAgICAgIHRoaXMuc2V0VmlzaWJpbGl0eVJlYWxpdHlDaGVjaygxKTtcbiAgICAgICAgfSwgK2R1cmF0aW9uICogNjAgKiAxMDAwKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgY2xlYW51cFJlYWxpdHlDaGVjaygpIHtcbiAgICAgICAgdGhpcy5oYXNfcmVhbGl0eV9jaGVjayA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzX3JlYWxpdHlfY2hlY2tfZGlzbWlzc2VkID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLnJlYWxpdHlfY2hlY2tfZHVyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmNsZWFyUmVhbGl0eUNoZWNrVGltZW91dCgpO1xuICAgICAgICBMb2NhbFN0b3JlLnJlbW92ZSgncmVhbGl0eV9jaGVja19kdXJhdGlvbicpO1xuICAgICAgICBMb2NhbFN0b3JlLnJlbW92ZSgncmVhbGl0eV9jaGVja19kaXNtaXNzZWQnKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgZmV0Y2hGaW5hbmNpYWxBc3Nlc3NtZW50KCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgcmVzb2x2ZSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGdldF9maW5hbmNpYWxfYXNzZXNzbWVudCB9ID0gYXdhaXQgV1MuZ2V0RmluYW5jaWFsQXNzZXNzbWVudCgpO1xuXG4gICAgICAgICAgICBydW5JbkFjdGlvbigoKSA9PiAodGhpcy5maW5hbmNpYWxfYXNzZXNzbWVudCA9IGdldF9maW5hbmNpYWxfYXNzZXNzbWVudCkpO1xuICAgICAgICAgICAgcmVzb2x2ZShnZXRfZmluYW5jaWFsX2Fzc2Vzc21lbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4vKiBlc2xpbnQtZW5hYmxlICovXG4iXSwibmFtZXMiOlsiQ29va2llcyIsImFjdGlvbiIsImNvbXB1dGVkIiwib2JzZXJ2YWJsZSIsInJlYWN0aW9uIiwicnVuSW5BY3Rpb24iLCJ0b0pTIiwid2hlbiIsIm1vbWVudCIsInJlZGlyZWN0VG9Mb2dpbiIsImdldFByb3BlcnR5VmFsdWUiLCJnZXRVcmxTbWFydFRyYWRlciIsImdldFVybEJpbmFyeUJvdCIsImlzRGVza3RvcE9zIiwiaXNFbXB0eU9iamVjdCIsIkxvY2FsU3RvcmUiLCJzZXRDdXJyZW5jaWVzIiwiU3RhdGUiLCJ0b01vbWVudCIsImRlcml2X3VybHMiLCJ1cmxGb3IiLCJ1cmxGb3JMYW5ndWFnZSIsIkNGRF9QTEFURk9STVMiLCJyb3V0ZXMiLCJnZXRMYW5ndWFnZSIsImxvY2FsaXplIiwicmVxdWVzdExvZ291dCIsIldTIiwiQmluYXJ5U29ja2V0R2VuZXJhbCIsIkJpbmFyeVNvY2tldCIsIlNvY2tldENhY2hlIiwiaXNFdUNvdW50cnkiLCJpc011bHRpcGxpZXJzT25seSIsImlzT3B0aW9uc0Jsb2NrZWQiLCJCYXNlU3RvcmUiLCJnZXRDbGllbnRBY2NvdW50VHlwZSIsImdldEFjY291bnRUaXRsZSIsInNldERldmljZURhdGFDb29raWUiLCJoYW5kbGVDbGllbnROb3RpZmljYXRpb25zIiwiY2xpZW50Tm90aWZpY2F0aW9ucyIsImJ1aWxkQ3VycmVuY2llc0xpc3QiLCJMQU5HVUFHRV9LRVkiLCJzdG9yYWdlX2tleSIsInN0b3JlX25hbWUiLCJldV9zaG9ydGNvZGVfcmVnZXgiLCJSZWdFeHAiLCJldV9leGNsdWRlZF9yZWdleCIsIkNsaWVudFN0b3JlIiwiYm91bmQiLCJyb290X3N0b3JlIiwibG9jYWxfc3RvcmFnZV9wcm9wZXJ0aWVzIiwiaXNfbXQ1X2FjY291bnRfbGlzdF91cGRhdGVkIiwiaGFzQW55UmVhbEFjY291bnQiLCJhY2NvdW50X2xpc3QiLCJzb21lIiwiYWNjIiwiaXNfdmlydHVhbCIsImhhc0FjY291bnRFcnJvckluQ0ZETGlzdCIsInBsYXRmb3JtIiwiYWNjb3VudF90eXBlIiwiaXNfbG9nZ2VkX2luIiwibGlzdCIsIk1UNSIsIm10NV9sb2dpbl9saXN0IiwiZHh0cmFkZV9hY2NvdW50c19saXN0IiwiYWNjb3VudCIsImhhc19lcnJvciIsImlzTVQ1QWxsb3dlZCIsImxhbmRpbmdfY29tcGFuaWVzIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsIm1hcmtldF90eXBlIiwiY291bnRyeV9zdGFuZHBvaW50IiwiaXNfYmVsZ2l1bSIsImlzX2ZyYW5jZSIsImlzRHh0cmFkZUFsbG93ZWQiLCJpc19ldV9jb3VudHJ5Iiwid2Vic2l0ZV9zdGF0dXMiLCJjbGllbnRzX2NvdW50cnkiLCJpc19ldSIsImlzRXVDb3VudHJ5U2VsZWN0ZWQiLCJzZWxlY3RlZF9jb3VudHJ5IiwiaXNBY2NvdW50T2ZUeXBlIiwidHlwZSIsImNsaWVudF9hY2NvdW50X3R5cGUiLCJsb2dpbmlkIiwiaXNEaXNhYmxlZCIsImlzQWNjb3VudE9mVHlwZURpc2FibGVkIiwiZmlsdGVyZWRfbGlzdCIsImZpbHRlciIsImV2ZXJ5IiwiaXNfZGlzYWJsZWQiLCJnZXRSaXNrQXNzZXNzbWVudCIsImFjY291bnRfc3RhdHVzIiwic3RhdHVzIiwidGVzdCIsInNob3VsZENvbXBsZXRlVGF4IiwiZW1haWwiLCJsYW5kaW5nX2NvbXBhbnkiLCJjdXJyZW5jeSIsInJlc2lkZW5jZSIsImFjY291bnRfc2V0dGluZ3MiLCJwcmVmZXJyZWRfbGFuZ3VhZ2UiLCJzZXRDb29raWVBY2NvdW50IiwidWkiLCJpc19yZWFsX2FjY19zaWdudXBfb24iLCJjbG9zZVJlYWxBY2NvdW50U2lnbnVwIiwiYWNjb3VudHMiLCJ1bmRlZmluZWQiLCJiYWxhbmNlIiwidG9TdHJpbmciLCJoYXNfcmVhbGl0eV9jaGVjayIsInJlYWxpdHlfY2hlY2tfZGlzbWlzc2VkIiwibGFuZGluZ19jb21wYW55X3Nob3J0Y29kZSIsInJlYWxpdHlfY2hlY2tfZHVyIiwiZ2V0IiwiaXNfcmVhbGl0eV9jaGVja19kaXNtaXNzZWQiLCJKU09OIiwicGFyc2UiLCJhY3RpdmVfYWNjb3VudHMiLCJyZXN1bHQiLCJmaW5kIiwiaGFzX25vX210NSIsImhhc19yZWFsX210NV9sb2dpbiIsImhhc19ub19keHRyYWRlIiwiaGFzX3JlYWxfZHh0cmFkZV9sb2dpbiIsImhhc19ub190cmFuc2FjdGlvbiIsInN0YXRlbWVudCIsImNvdW50IiwidHJhbnNhY3Rpb25zIiwiaGFzX2FjY291bnRfY3JpdGVyaWEiLCJjdXJyZW50X2N1cnJlbmN5X3R5cGUiLCJnZXREZWZhdWx0QWxsb3dlZEN1cnJlbmNpZXMiLCJnYW1pbmdfY29tcGFueSIsImxlZ2FsX2FsbG93ZWRfY3VycmVuY2llcyIsImZpbmFuY2lhbF9jb21wYW55IiwicmVhbF9hY2NvdW50X3NpZ251cF90YXJnZXQiLCJpbmNsdWRlcyIsImN1cnJlbnRfbGFuZGluZ19jb21wYW55IiwidGFyZ2V0IiwiY3VycmVuY2llc19jb25maWciLCJtYXAiLCJ2YWx1ZSIsInZhbHVlcyIsInJlZHVjZSIsIml0ZW0iLCJwdXNoIiwidXBncmFkZWFibGVfY3VycmVuY2llcyIsImhhc19maWF0IiwiY29tcGFueSIsInNob3J0Y29kZSIsImFsbF9sb2dpbmlkcyIsImlkIiwiZ2V0QWNjb3VudEluZm8iLCJEWFRSQURFIiwibnVtYmVyX29mX2N1cnJlbnRfYWRkZWRfc3ludGhldGljcyIsImN1ciIsImlzX2luY2x1ZGVkIiwibnVtYmVyX29mX2F2YWlsYWJsZV9zeW50aGV0aWMiLCJtdDVfdHJhZGluZ19zZXJ2ZXJzIiwic3VwcG9ydGVkX2FjY291bnRzIiwiZGlzYWJsZWQiLCJzZWxlY3RlZF9jdXJyZW5jeSIsImRlZmF1bHRfY3VycmVuY3kiLCJjdXJyZW5jaWVzX2xpc3QiLCJ0ZXh0IiwiaXNfZnVsbHlfYXV0aGVudGljYXRlZCIsImF1dGhlbnRpY2F0aW9uIiwibmVlZHNfdmVyaWZpY2F0aW9uIiwiY2xpZW50X3RuY19zdGF0dXMiLCJ0ZXJtc19jb25kaXRpb25zX3ZlcnNpb24iLCJzdGF0dXNfbmFtZSIsImRvY3VtZW50X3N0YXR1cyIsImRvY3VtZW50IiwiaWRlbnRpdHlfc3RhdHVzIiwiaWRlbnRpdHkiLCJzb2NpYWxfaWRlbnRpdHlfcHJvdmlkZXIiLCJyZXNpZGVuY2VfbGlzdCIsInZhbGlkX2xvZ2luX2lkc19yZWdleCIsInRva2VuIiwiZmluYW5jaWFsX3Nob3J0Y29kZSIsImdhbWluZ19zaG9ydGNvZGUiLCJpc191bml0ZWRfa2luZ2RvbSIsImlzX3VrIiwiaXNfaXNsZV9vZl9tYW4iLCJpc19vdGhlcl9ldSIsImlzX3Jlc3Rfb2ZfZXUiLCJub3RpZmljYXRpb25fY29udGVudCIsIm14X21sdF9ub3RpZmljYXRpb24iLCJoZWFkZXIiLCJoYXNfbWFsdGFfYWNjb3VudCIsImNhbl9oYXZlX21sdF9hY2NvdW50IiwibWFpbiIsImNvdW50cmllcyIsInVwZ3JhZGVfaW5mbyIsImNhbl91cGdyYWRlIiwiY2FuX29wZW5fbXVsdGkiLCJjYW5fdXBncmFkZV90byIsImNvdW50cnkiLCJhY2NlcHRlZF9iY2giLCJzZXRPYmplY3QiLCJzZXQiLCJzeW5jV2l0aExlZ2FjeVBsYXRmb3JtcyIsInVwZ3JhZGVhYmxlX2xhbmRpbmdfY29tcGFuaWVzIiwiU2V0IiwiZ2V0UmVzcG9uc2UiLCJpbmRleE9mIiwiY2FuVXBncmFkZSIsImRpc2FibGVkX3R5cGVzX29iaiIsImN1cnJlbnRfbGlzdCIsIm10NV9kaXNhYmxlZF9zaWdudXBfdHlwZXMiLCJkeHRyYWRlX2Rpc2FibGVkX3NpZ251cF90eXBlcyIsIlByb21pc2UiLCJyZXNvbHZlIiwiYXV0aG9yaXplZCIsInN0b3JhZ2UiLCJnZXRMaW1pdHMiLCJ0aGVuIiwiZGF0YSIsImVycm9yIiwiYWNjb3VudF9saW1pdHMiLCJhcGlfaW5pdGlhbF9sb2FkX2Vycm9yIiwibWVzc2FnZSIsImdldF9saW1pdHMiLCJpc19sb2FkaW5nIiwiZG9tYWluIiwid2luZG93IiwibG9jYXRpb24iLCJob3N0bmFtZSIsIkRFUklWX0hPU1RfTkFNRSIsInVzZXJfaWQiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwibmFtZSIsImNsaWVudF9pbmZvcm1hdGlvbiIsImhhc19jb29raWVfYWNjb3VudCIsInJlbW92ZSIsImdldFNlbGZFeGNsdXNpb24iLCJnZXRfc2VsZl9leGNsdXNpb24iLCJzZWxmX2V4Y2x1c2lvbiIsInNldFNlbGZFeGNsdXNpb24iLCJyZXNwb25zZSIsInBheW91dF9jdXJyZW5jaWVzIiwic2VsZWN0Q3VycmVuY3kiLCJhdXRob3JpemUiLCJzZXNzaW9uX3N0YXJ0IiwicGFyc2VJbnQiLCJ1dGMiLCJ2YWx1ZU9mIiwibGFuZGluZ19jb21wYW55X25hbWUiLCJ1cGRhdGVBY2NvdW50TGlzdCIsImdldEJhc2ljVXBncmFkZUluZm8iLCJsb2NhbF9jdXJyZW5jeV9jb25maWciLCJsb2NhbF9jdXJyZW5jaWVzIiwiZGVmYXVsdF9mcmFjdGlvbmFsX2RpZ2l0cyIsImRlY2ltYWxfcGxhY2VzIiwiZnJhY3Rpb25hbF9kaWdpdHMiLCJyZXNwb25zZVdlYnNpdGVTdGF0dXMiLCJpc19wb3B1bGF0aW5nX2FjY291bnRfbGlzdCIsImNsaWVudF9hY2NvdW50cyIsIm5ld19hY2NvdW50X3JlYWwiLCJuZXdfYWNjb3VudF9tYWx0YWludmVzdCIsIm9hdXRoX3Rva2VuIiwiY2xpZW50X2lkIiwiYXV0aG9yaXplX3Jlc3BvbnNlIiwibmV3X2RhdGEiLCJsYW5kaW5nX2NvbXBhbnlfZnVsbG5hbWUiLCJzZXRMb2dpbkluZm9ybWF0aW9uIiwiZ2V0U2V0dGluZ3MiLCJnZXRfc2V0dGluZ3NfcmVzcG9uc2UiLCJzZXRBY2NvdW50U2V0dGluZ3MiLCJnZXRfc2V0dGluZ3MiLCJzZXRBY2NvdW50cyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJzZXRTd2l0Y2hlZCIsImZvcm1fdmFsdWVzIiwiREVGQVVMVF9DUllQVE9fQUNDT1VOVF9DVVJSRU5DWSIsImlzX21hbHRhaW52ZXN0X2FjY291bnQiLCJpc19zYW1vYV9hY2NvdW50IiwiYWNjZXB0X3Jpc2siLCJuZXdBY2NvdW50UmVhbE1hbHRhSW52ZXN0IiwibmV3QWNjb3VudFJlYWwiLCJhY2NvdW50UmVhbFJlYWN0aW9uIiwic2V0QWNjb3VudEN1cnJlbmN5IiwicmVtb3ZlSXRlbSIsImd0bSIsInB1c2hEYXRhTGF5ZXIiLCJldmVudCIsIm5ld19hY2NvdW50X3NhbW9hIiwicmVqZWN0IiwicHJldmlvdXNfY3VycmVuY3kiLCJ1cGRhdGVBY2NvdW50Q3VycmVuY3kiLCJpc19zZXRfc3RvcmFnZSIsIm5ld19hY2NvdW50IiwicmVtb3ZlTm90aWZpY2F0aW9uTWVzc2FnZSIsImtleSIsInJlbW92ZU5vdGlmaWNhdGlvbkJ5S2V5IiwiaW5pdCIsImRhdGVfb2ZfYmlydGgiLCJmb3JtYXQiLCJjb3VudHJ5X2NvZGUiLCJnZXRBdmFpbGFiaWxpdHkiLCJpc19kb3duIiwiZm9yRWFjaCIsImV4Y2x1ZGVkX3VudGlsIiwicGFyYW0iLCJwYXJhbV90b19zZXQiLCJ2YWx1ZV90b19zZXQiLCJzZXRQcmVTd2l0Y2hBY2NvdW50Iiwic2V0SXNMb2dnaW5nSW4iLCJyZW1vdmVOb3RpZmljYXRpb25zIiwicmVtb3ZlQWxsTm90aWZpY2F0aW9uTWVzc2FnZXMiLCJwYXlvdXRDdXJyZW5jaWVzIiwicmVzcG9uc2VQYXlvdXRDdXJyZW5jaWVzIiwic2hvdWxkX3Nob3dfYWdhaW4iLCJ0b3B1cFZpcnR1YWwiLCJzd2l0Y2hfYnJvYWRjYXN0IiwiY2xpZW50IiwibW9kdWxlcyIsImNhc2hpZXIiLCJjb21tb24iLCJoYXNfbWlzc2luZ19yZXF1aXJlZF9maWVsZCIsInNldEhhc01pc3NpbmdSZXF1aXJlZEZpZWxkIiwibG9naW5fbmV3X3VzZXIiLCJzZWFyY2giLCJzZWFyY2hfcGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwicmVkaXJlY3RfdXJsIiwic2V0VXNlckxvZ2luIiwic2V0RGV2aWNlRGF0YSIsImxvZ291dCIsInNldEVycm9yIiwic2hvdWxkX3Nob3dfcmVmcmVzaCIsInJlZGlyZWN0X2xhYmVsIiwicmVkaXJlY3RPbkNsaWNrIiwic2V0SW5pdGlhbGl6ZWQiLCJzZXRMb2dpbklkIiwiZ2V0T2JqZWN0IiwiYXV0aG9yaXplQWNjb3VudCIsInJ1ZGRlcnN0YWNrIiwiaWRlbnRpZnlFdmVudCIsInJlcGxhY2UiLCJxdWVyeV9zdHJpbmciLCJsYW5ndWFnZSIsImlzX3AycF92aXNpYmxlIiwic2VsZWN0ZWRfY29udHJhY3RfdHlwZSIsIndhaXQiLCJtdDVMb2dpbkxpc3QiLCJyZXNwb25zZU10NUxvZ2luTGlzdCIsInRyYWRpbmdTZXJ2ZXJzIiwicmVzcG9uc2VNVDVUcmFkaW5nU2VydmVycyIsInRyYWRpbmdQbGF0Zm9ybUFjY291bnRzTGlzdCIsInJlc3BvbnNlVHJhZGluZ1BsYXRmb3JtQWNjb3VudHNMaXN0IiwicmVzcG9uc2VEeHRyYWRlVHJhZGluZ1NlcnZlcnMiLCJzZW5kIiwicmVzcG9uc2VTdGF0ZW1lbnQiLCJjYWNoZSIsInNldFByZWZlcnJlZExhbmd1YWdlIiwiZmV0Y2hSZXNpZGVuY2VMaXN0IiwidG9nZ2xlU2V0UmVzaWRlbmNlTW9kYWwiLCJsYW5kaW5nQ29tcGFueSIsInJlc3BvbnNlTGFuZGluZ0NvbXBhbnkiLCJyZXNldE10NUFjY291bnRMaXN0UG9wdWxhdGlvbiIsInJlZ2lzdGVyUmVhY3Rpb25zIiwiaXNfcG9wdWxhdGluZ19tdDVfYWNjb3VudF9saXN0IiwiYWRkTm90aWZpY2F0aW9uTWVzc2FnZSIsImlzX3BlcnNpc3RlbnQiLCJpc19sYW5kaW5nX2NvbXBhbnlfbG9hZGVkIiwic2V0U3RhbmRwb2ludCIsInNldFJlYWxpdHlDaGVjayIsInN0YW5kcG9pbnQiLCJyZWFsaXR5X2NoZWNrX2R1cmF0aW9uIiwicmVhbGl0eV9jaGVja190aW1lb3V0Iiwic2V0UmVhbGl0eUNoZWNrRHVyYXRpb24iLCJzd2l0Y2hlZCIsImdldEFjY291bnQiLCJhY2NvdW50X3RpdGxlIiwiaWNvbiIsInRvTG93ZXJDYXNlIiwidGl0bGUiLCJib29sIiwiaXNfbG9nZ2luZ19pbiIsImlzX3ByZV9zd2l0Y2giLCJwcmVfc3dpdGNoX2Jyb2FkY2FzdCIsImJyb2FkY2FzdEFjY291bnRDaGFuZ2UiLCJpc1VuYWJsZVRvRmluZExvZ2luSWQiLCJoYW5kbGVOb3RGb3VuZExvZ2luSWQiLCJzd2l0Y2hBY2NvdW50Iiwic3dpdGNoQWNjb3VudEhhbmRsZXIiLCJpc19zd2l0Y2hpbmciLCJmcm9tX2xvZ2luX2lkIiwicmVzZXRMb2NhbFN0b3JhZ2VWYWx1ZXMiLCJjbGVhciIsInNob3VsZF9zd2l0Y2hfc29ja2V0X2Nvbm5lY3Rpb24iLCJjbG9zZUFuZE9wZW5OZXdDb25uZWN0aW9uIiwiZm9yZ2V0QWxsIiwiZ2V0VG9rZW4iLCJzZXNzaW9uU3RvcmFnZSIsInNldExvZ2luRmxhZyIsIm1pbl9yZXNldF9saW1pdCIsIm1heF9yZXNldF9saW1pdCIsInJlc2V0VmlydHVhbEJhbGFuY2UiLCJyZXNldF92aXJ0dWFsX2JhbGFuY2UiLCJvYmpfYmFsYW5jZSIsInJlc2V0VmlydHVhbEJhbGFuY2VOb3RpZmljYXRpb24iLCJpc01UNVRyYW5zZmVySW5Qcm9ncmVzcyIsImFjY291bnRfaWQiLCJpc19hY3RpdmVfYWNjb3VudF9pZCIsInRvdGFsIiwidG90YWxfcmVhbCIsInRvdGFsX210NSIsInRvdGFsX2R4dHJhZGUiLCJoYXNfbXQ1IiwiaGFzX2R4dHJhZGUiLCJvYmpfdG90YWxfYmFsYW5jZSIsImFtb3VudF9yZWFsIiwiYW1vdW50IiwiYW1vdW50X210NSIsImFtb3VudF9keHRyYWRlIiwic2V0dGluZ3MiLCJpc19hY2NvdW50X3NldHRpbmdfbG9hZGVkIiwiaXNfaW5pdGlhbGl6ZWQiLCJpbml0aWFsaXplZF9icm9hZGNhc3QiLCJjbGVhbnVwUmVhbGl0eUNoZWNrIiwiY2xlYW5VcCIsInJlc2V0Iiwic2V0TG9nb3V0IiwiaXNfbG9nZ2VkX291dCIsImhhc19sb2dnZWRfb3V0Iiwib2JqX3BhcmFtcyIsIm1hcF9uYW1lcyIsImNsaWVudF9vYmplY3QiLCJhY3RpdmVfbG9naW5pZCIsInNlbGVjdGVkX2FjY3QiLCJpIiwiYWNjdDEiLCJhY2NvdW50X2tleXMiLCJpc19hY2NvdW50X3BhcmFtIiwiYWNjb3VudF9rZXkiLCJzZWFyY2hfcGFyYW1fd2l0aG91dF9hY2NvdW50IiwiaGlzdG9yeSIsInJlcGxhY2VTdGF0ZSIsImhhc2giLCJpc19jbGllbnRfbG9nZ2luZ19pbiIsInRva2VuMSIsImdldEl0ZW0iLCJjYW5TdG9yZUNsaWVudEFjY291bnRzIiwic3RvcmVDbGllbnRBY2NvdW50cyIsImNvZGUiLCJpc19yZWFkeV90b19wcm9jZXNzIiwiYWNjdHMiLCJpc19jcm9zc19jaGVja2VkIiwiYWNjdCIsInZlcmlmaWNhdGlvbl9jb2RlIiwicGFyYW1fbGlzdCIsInNpZ251cF9wYXJhbXMiLCJ1cmxfcGFyYW1zIiwiY2IiLCJzZXRTZXR0aW5ncyIsInNldFJlc2lkZW5jZSIsInBhc3N3b3JkIiwiZW1haWxfY29uc2VudCIsInNpZ251cCIsIm5ld0FjY291bnRWaXJ0dWFsIiwiZ2V0U2lnbnVwUGFyYW1zIiwibmV3X2FjY291bnRfdmlydHVhbCIsInN3aXRjaFRvTmV3bHlDcmVhdGVkQWNjb3VudCIsInRvZ2dsZVdlbGNvbWVNb2RhbCIsImlzX3Zpc2libGUiLCJzaG91bGRfcGVyc2lzdCIsIm5ld191c2VyX2xvZ2luIiwiY3VycjEiLCJyZXNpZGVuY2VMaXN0Iiwic2V0UmVzaWRlbmNlTGlzdCIsInJlc2lkZW5jZV9saXN0X3Jlc3BvbnNlIiwic3RhdGVzTGlzdCIsInN0YXRlc19saXN0IiwibXQ1X2xvZ2luX2xpc3RfZXJyb3IiLCJ0cmFkaW5nX3NlcnZlcnMiLCJzZXRUaW1lb3V0IiwiZGlzcGxheV9sb2dpbiIsImRldGFpbHMiLCJsb2dpbiIsInNlcnZlciIsInNldE1UNURpc2FibGVkU2lnbnVwVHlwZXMiLCJkeHRyYWRlX3RyYWRpbmdfc2VydmVycyIsInRyYWRpbmdfc2VydmVyIiwic2V0Q0ZERGlzYWJsZWRTaWdudXBUeXBlcyIsImVjaG9fcmVxIiwidHJhZGluZ19wbGF0Zm9ybV9hY2NvdW50cyIsInJlYWRvbmx5X2ZpZWxkcyIsImltbXV0YWJsZV9maWVsZHMiLCJmaWVsZCIsInNtYXJ0VHJhZGVyIiwiYmluYXJ5Qm90IiwiaWZyYW1lIiwiZ2V0RWxlbWVudEJ5SWQiLCJvcmlnaW4iLCJjb250ZW50V2luZG93IiwicG9zdE1lc3NhZ2UiLCJyaXNrX2NsYXNzaWZpY2F0aW9uIiwiY2xlYXJUaW1lb3V0IiwiZHVyYXRpb24iLCJjbGVhclJlYWxpdHlDaGVja1RpbWVvdXQiLCJzZXRWaXNpYmlsaXR5UmVhbGl0eUNoZWNrIiwiZ2V0RmluYW5jaWFsQXNzZXNzbWVudCIsImdldF9maW5hbmNpYWxfYXNzZXNzbWVudCIsImZpbmFuY2lhbF9hc3Nlc3NtZW50IiwiaW9tIiwic3ZnIiwibWFsdGEiLCJtYWx0YWludmVzdCIsInJlYWwiLCJkZW1vIiwicmVzZXRfcGFzc3dvcmQiLCJwYXltZW50X3dpdGhkcmF3IiwicGF5bWVudF9hZ2VudF93aXRoZHJhdyIsInRyYWRpbmdfcGxhdGZvcm1fbXQ1X3Bhc3N3b3JkX3Jlc2V0IiwidHJhZGluZ19wbGF0Zm9ybV9keHRyYWRlX3Bhc3N3b3JkX3Jlc2V0IiwibGFuZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Stores/client-store.js\n");

/***/ }),

/***/ "./Stores/common-store.js":
/*!********************************!*\
  !*** ./Stores/common-store.js ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ CommonStore)\n/* harmony export */ });\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mobx */ \"../../../node_modules/mobx/lib/mobx.module.js\");\n/* harmony import */ var _deriv_shared__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @deriv/shared */ \"../../shared/src/index.js\");\n/* harmony import */ var _deriv_translations__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @deriv/translations */ \"../../translations/src/index.js\");\n/* harmony import */ var _common_base_socket_base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! _common/base/socket_base */ \"./_common/base/socket_base.js\");\n/* harmony import */ var _common_base_socket_base__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_common_base_socket_base__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _common_base_server_time__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! _common/base/server_time */ \"./_common/base/server_time.js\");\n/* harmony import */ var _common_base_server_time__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_common_base_server_time__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var Utils_Language_index__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! Utils/Language/index */ \"./Utils/Language/index.js\");\n/* harmony import */ var _base_store__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./base-store */ \"./Stores/base-store.js\");\n/* harmony import */ var _Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Helpers/client-notifications */ \"./Stores/Helpers/client-notifications.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _dec6, _dec7, _dec8, _dec9, _dec10, _dec11, _dec12, _dec13, _dec14, _dec15, _dec16, _dec17, _class, _descriptor, _descriptor2, _descriptor3, _descriptor4, _descriptor5, _descriptor6, _descriptor7, _descriptor8, _descriptor9, _descriptor10, _descriptor11, _descriptor12, _descriptor13, _descriptor14, _descriptor15, _descriptor16, _descriptor17;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _initializerDefineProperty(target, property, descriptor, context) { if (!descriptor) return; Object.defineProperty(target, property, { enumerable: descriptor.enumerable, configurable: descriptor.configurable, writable: descriptor.writable, value: descriptor.initializer ? descriptor.initializer.call(context) : void 0 }); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\nfunction _initializerWarningHelper(descriptor, context) { throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and runs after the decorators transform.'); }\n\n\n\n\n\n\n\n\n\nvar CommonStore = (_dec = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec2 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec3 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec4 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec5 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec6 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec7 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec8 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec9 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec10 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec11 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec12 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec13 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec14 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec15 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec16 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, _dec17 = mobx__WEBPACK_IMPORTED_MODULE_0__.action.bound, (_class = /*#__PURE__*/function (_BaseStore) {\n  _inherits(CommonStore, _BaseStore);\n\n  var _super = _createSuper(CommonStore);\n\n  function CommonStore(root_store) {\n    var _this;\n\n    _classCallCheck(this, CommonStore);\n\n    _this = _super.call(this, {\n      root_store: root_store\n    });\n\n    _initializerDefineProperty(_this, \"server_time\", _descriptor, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"current_language\", _descriptor2, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"allowed_languages\", _descriptor3, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"has_error\", _descriptor4, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"error\", _descriptor5, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"network_status\", _descriptor6, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_network_online\", _descriptor7, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"is_socket_opened\", _descriptor8, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"was_socket_opened\", _descriptor9, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"services_error\", _descriptor10, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"deposit_url\", _descriptor11, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"withdraw_url\", _descriptor12, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"app_routing_history\", _descriptor13, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"app_router\", _descriptor14, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"app_id\", _descriptor15, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"platform\", _descriptor16, _assertThisInitialized(_this));\n\n    _initializerDefineProperty(_this, \"selected_contract_type\", _descriptor17, _assertThisInitialized(_this));\n\n    (0,mobx__WEBPACK_IMPORTED_MODULE_0__.reaction)(function () {\n      return _this.app_routing_history.map(function (i) {\n        return i.pathname;\n      });\n    }, function () {\n      _this.root_store.ui.filterNotificationMessages();\n    });\n    return _this;\n  }\n\n  _createClass(CommonStore, [{\n    key: \"setSelectedContractType\",\n    value: function setSelectedContractType(contract_type) {\n      this.selected_contract_type = contract_type;\n    }\n  }, {\n    key: \"init\",\n    value: function init() {\n      this.setPlatform();\n    }\n  }, {\n    key: \"checkAppId\",\n    value: function checkAppId() {\n      if (this.app_id && this.app_id !== (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.getAppId)()) {\n        _common_base_socket_base__WEBPACK_IMPORTED_MODULE_3___default().closeAndOpenNewConnection();\n      }\n\n      this.app_id = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.getAppId)();\n    }\n  }, {\n    key: \"setPlatform\",\n    value: function setPlatform() {\n      var search = window.location.search;\n\n      if (search) {\n        var url_params = new URLSearchParams(search);\n        this.platform = url_params.get('platform') || '';\n      }\n    }\n  }, {\n    key: \"setInitialRouteHistoryItem\",\n    value: function setInitialRouteHistoryItem(location) {\n      if (window.location.href.indexOf('?ext_platform_url=') !== -1) {\n        var ext_url = decodeURI(new URL(window.location.href).searchParams.get('ext_platform_url'));\n\n        if ((ext_url === null || ext_url === void 0 ? void 0 : ext_url.indexOf((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.getUrlSmartTrader)())) === 0) {\n          this.addRouteHistoryItem({\n            pathname: ext_url,\n            action: 'PUSH',\n            is_external: true\n          });\n        } else if ((ext_url === null || ext_url === void 0 ? void 0 : ext_url.indexOf(_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.cashier_p2p)) === 0) {\n          this.addRouteHistoryItem({\n            pathname: ext_url,\n            action: 'PUSH'\n          });\n        } else if ((ext_url === null || ext_url === void 0 ? void 0 : ext_url.indexOf((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.getUrlBinaryBot)())) === 0) {\n          this.addRouteHistoryItem({\n            pathname: ext_url,\n            action: 'PUSH',\n            is_external: true\n          });\n        } else {\n          this.addRouteHistoryItem(_objectSpread(_objectSpread({}, location), {}, {\n            action: 'PUSH'\n          }));\n        }\n\n        window.history.replaceState({}, document.title, window.location.pathname);\n      } else {\n        this.addRouteHistoryItem(_objectSpread(_objectSpread({}, location), {}, {\n          action: 'PUSH'\n        }));\n      }\n    }\n  }, {\n    key: \"setServerTime\",\n    value: function setServerTime(server_time) {\n      this.server_time = server_time;\n    }\n  }, {\n    key: \"setIsSocketOpened\",\n    value: function setIsSocketOpened(is_socket_opened) {\n      // note that it's not for account switch that we're doing this,\n      // but rather to reset account related stores like portfolio and contract-trade\n      var should_broadcast_account_change = this.was_socket_opened && is_socket_opened;\n      this.is_socket_opened = is_socket_opened;\n      this.was_socket_opened = this.was_socket_opened || is_socket_opened;\n\n      if (should_broadcast_account_change) {\n        this.root_store.client.broadcastAccountChangeAfterAuthorize();\n      }\n    }\n  }, {\n    key: \"setNetworkStatus\",\n    value: function setNetworkStatus(status, is_online) {\n      if (this.network_status[\"class\"]) {\n        this.network_status[\"class\"] = status[\"class\"];\n        this.network_status.tooltip = status.tooltip;\n      } else {\n        this.network_status = status;\n      }\n\n      this.is_network_online = is_online;\n      var ui_store = this.root_store.ui;\n\n      if (!is_online) {\n        ui_store.addNotificationMessage((0,_Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_7__.clientNotifications)().you_are_offline);\n      } else {\n        ui_store.removeNotificationMessage((0,_Helpers_client_notifications__WEBPACK_IMPORTED_MODULE_7__.clientNotifications)().you_are_offline);\n      }\n    }\n  }, {\n    key: \"setError\",\n    value: function setError(has_error, error) {\n      this.has_error = has_error;\n      this.error = _objectSpread({\n        type: error ? error.type : 'info'\n      }, error && {\n        header: error.header,\n        message: error.message,\n        redirect_label: error.redirect_label,\n        redirectOnClick: error.redirectOnClick,\n        should_show_refresh: error.should_show_refresh,\n        redirect_to: error.redirect_to,\n        should_clear_error_on_click: error.should_clear_error_on_click,\n        setError: this.setError\n      });\n    }\n  }, {\n    key: \"showError\",\n    value: function showError(_ref) {\n      var message = _ref.message,\n          header = _ref.header,\n          redirect_label = _ref.redirect_label,\n          redirectOnClick = _ref.redirectOnClick,\n          should_show_refresh = _ref.should_show_refresh,\n          redirect_to = _ref.redirect_to,\n          should_clear_error_on_click = _ref.should_clear_error_on_click;\n      this.setError(true, {\n        header: header,\n        message: message,\n        redirect_label: redirect_label,\n        redirectOnClick: redirectOnClick,\n        should_show_refresh: should_show_refresh,\n        redirect_to: redirect_to,\n        should_clear_error_on_click: should_clear_error_on_click,\n        type: 'error'\n      });\n    }\n  }, {\n    key: \"setDepositURL\",\n    value: function setDepositURL(deposit_url) {\n      this.deposit_url = deposit_url;\n    }\n  }, {\n    key: \"setWithdrawURL\",\n    value: function setWithdrawURL(withdraw_url) {\n      this.withdraw_url = withdraw_url;\n    }\n  }, {\n    key: \"setServicesError\",\n    value: function setServicesError(error) {\n      this.services_error = error;\n\n      if ((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.isMobile)()) {\n        this.root_store.ui.addToast({\n          content: error.message,\n          type: 'error'\n        });\n      } else {\n        this.root_store.ui.toggleServicesErrorModal(true);\n      }\n    }\n  }, {\n    key: \"setAppRouterHistory\",\n    value: function setAppRouterHistory(history) {\n      this.app_router.history = history;\n    }\n  }, {\n    key: \"routeTo\",\n    value: function routeTo(pathname) {\n      if (this.app_router.history) this.app_router.history.push(pathname);\n    }\n  }, {\n    key: \"addRouteHistoryItem\",\n    value: function addRouteHistoryItem(router_action) {\n      var check_existing = this.app_routing_history.findIndex(function (i) {\n        return i.pathname === router_action.pathname && i.action === 'PUSH';\n      });\n\n      if (check_existing > -1) {\n        this.app_routing_history.splice(check_existing, 1);\n      }\n\n      this.app_routing_history.unshift(router_action);\n    }\n  }, {\n    key: \"routeBackInApp\",\n    value: function routeBackInApp(history) {\n      var additional_platform_path = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var route_to_item_idx = -1;\n      var route_to_item = this.app_routing_history.find(function (history_item, idx) {\n        if (history_item.action === 'PUSH') {\n          if (history_item.is_external) {\n            return true;\n          }\n\n          var parent_path = history_item.pathname.split('/')[1];\n          var platform_parent_paths = [_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.mt5, _deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.bot, _deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.trade, _deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.dxtrade].map(function (i) {\n            return i.split('/')[1];\n          }); // map full path to just base path (`/mt5/abc` -> `mt5`)\n\n          if (platform_parent_paths.includes(parent_path) || additional_platform_path.includes(history_item.pathname)) {\n            route_to_item_idx = idx;\n            return true;\n          }\n        }\n\n        return false;\n      });\n\n      if (route_to_item) {\n        if (route_to_item.is_external) {\n          window.location.href = route_to_item.pathname;\n          return;\n        } else if (route_to_item_idx > -1) {\n          this.app_routing_history.splice(0, route_to_item_idx + 1); // remove once p2p is ready\n\n          var ui_store = this.root_store.ui;\n          if (route_to_item.pathname === _deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.cashier_p2p && ui_store.is_mobile) history.push(\"\".concat(route_to_item.pathname, \"/verification\"));else history.push(route_to_item.pathname);\n          return;\n        }\n      }\n\n      history.push(_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.routes.trade);\n    }\n  }]);\n\n  return CommonStore;\n}(_base_store__WEBPACK_IMPORTED_MODULE_6__.default), (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"server_time\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return _common_base_server_time__WEBPACK_IMPORTED_MODULE_4___default().get() || (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_1__.toMoment)();\n  }\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"current_language\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return Utils_Language_index__WEBPACK_IMPORTED_MODULE_5__.currentLanguage;\n  }\n}), _descriptor3 = _applyDecoratedDescriptor(_class.prototype, \"allowed_languages\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return Object.keys((0,_deriv_translations__WEBPACK_IMPORTED_MODULE_2__.getAllowedLanguages)());\n  }\n}), _descriptor4 = _applyDecoratedDescriptor(_class.prototype, \"has_error\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor5 = _applyDecoratedDescriptor(_class.prototype, \"error\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      type: 'info',\n      message: ''\n    };\n  }\n}), _descriptor6 = _applyDecoratedDescriptor(_class.prototype, \"network_status\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor7 = _applyDecoratedDescriptor(_class.prototype, \"is_network_online\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor8 = _applyDecoratedDescriptor(_class.prototype, \"is_socket_opened\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor9 = _applyDecoratedDescriptor(_class.prototype, \"was_socket_opened\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return false;\n  }\n}), _descriptor10 = _applyDecoratedDescriptor(_class.prototype, \"services_error\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {};\n  }\n}), _descriptor11 = _applyDecoratedDescriptor(_class.prototype, \"deposit_url\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return '';\n  }\n}), _descriptor12 = _applyDecoratedDescriptor(_class.prototype, \"withdraw_url\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return '';\n  }\n}), _descriptor13 = _applyDecoratedDescriptor(_class.prototype, \"app_routing_history\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return [];\n  }\n}), _descriptor14 = _applyDecoratedDescriptor(_class.prototype, \"app_router\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return {\n      history: null\n    };\n  }\n}), _descriptor15 = _applyDecoratedDescriptor(_class.prototype, \"app_id\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return undefined;\n  }\n}), _descriptor16 = _applyDecoratedDescriptor(_class.prototype, \"platform\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return '';\n  }\n}), _descriptor17 = _applyDecoratedDescriptor(_class.prototype, \"selected_contract_type\", [mobx__WEBPACK_IMPORTED_MODULE_0__.observable], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: function initializer() {\n    return '';\n  }\n}), _applyDecoratedDescriptor(_class.prototype, \"setSelectedContractType\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"setSelectedContractType\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"init\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"init\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"checkAppId\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"checkAppId\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setPlatform\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"setPlatform\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setInitialRouteHistoryItem\", [_dec5], Object.getOwnPropertyDescriptor(_class.prototype, \"setInitialRouteHistoryItem\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setServerTime\", [_dec6], Object.getOwnPropertyDescriptor(_class.prototype, \"setServerTime\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setIsSocketOpened\", [_dec7], Object.getOwnPropertyDescriptor(_class.prototype, \"setIsSocketOpened\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setNetworkStatus\", [_dec8], Object.getOwnPropertyDescriptor(_class.prototype, \"setNetworkStatus\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setError\", [_dec9], Object.getOwnPropertyDescriptor(_class.prototype, \"setError\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"showError\", [_dec10], Object.getOwnPropertyDescriptor(_class.prototype, \"showError\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setDepositURL\", [_dec11], Object.getOwnPropertyDescriptor(_class.prototype, \"setDepositURL\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setWithdrawURL\", [_dec12], Object.getOwnPropertyDescriptor(_class.prototype, \"setWithdrawURL\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setServicesError\", [_dec13], Object.getOwnPropertyDescriptor(_class.prototype, \"setServicesError\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setAppRouterHistory\", [_dec14], Object.getOwnPropertyDescriptor(_class.prototype, \"setAppRouterHistory\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"routeTo\", [_dec15], Object.getOwnPropertyDescriptor(_class.prototype, \"routeTo\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"addRouteHistoryItem\", [_dec16], Object.getOwnPropertyDescriptor(_class.prototype, \"addRouteHistoryItem\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"routeBackInApp\", [_dec17], Object.getOwnPropertyDescriptor(_class.prototype, \"routeBackInApp\"), _class.prototype)), _class));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9TdG9yZXMvY29tbW9uLXN0b3JlLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUNBO0FBQUE7O0FBQUE7O0FBQ0E7QUFBQTtBQUFBOztBQURBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUFBOztBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBUEE7QUFTQTs7OztBQTRCQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVdBOzs7QUFFQTtBQVNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUkE7QUFVQTs7O0FBRUE7QUFFQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFGQTtBQUlBO0FBQ0E7QUFDQTtBQUNBOzs7QUFFQTtBQUVBO0FBQ0E7OztBQUVBO0FBRUE7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQUE7O0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBQ0E7OztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7O0FBR0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7Ozs7QUF6UEE7Ozs7O0FBWUE7O0FBQ0E7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7O0FBRUE7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBRkE7O0FBS0E7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7O0FBRUE7Ozs7O0FBQUE7O0FBRUE7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7O0FBRUE7Ozs7O0FBQUE7O0FBQ0E7Ozs7O0FBQUE7QUFBQTtBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBOztBQUNBOzs7OztBQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vU3RvcmVzL2NvbW1vbi1zdG9yZS5qcz9mOGJlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGFjdGlvbiwgb2JzZXJ2YWJsZSwgcmVhY3Rpb24gfSBmcm9tICdtb2J4JztcbmltcG9ydCB7IHJvdXRlcywgdG9Nb21lbnQsIGdldFVybFNtYXJ0VHJhZGVyLCBpc01vYmlsZSwgZ2V0QXBwSWQsIGdldFVybEJpbmFyeUJvdCB9IGZyb20gJ0BkZXJpdi9zaGFyZWQnO1xuaW1wb3J0IHsgZ2V0QWxsb3dlZExhbmd1YWdlcyB9IGZyb20gJ0BkZXJpdi90cmFuc2xhdGlvbnMnO1xuaW1wb3J0IEJpbmFyeVNvY2tldCBmcm9tICdfY29tbW9uL2Jhc2Uvc29ja2V0X2Jhc2UnO1xuaW1wb3J0IFNlcnZlclRpbWUgZnJvbSAnX2NvbW1vbi9iYXNlL3NlcnZlcl90aW1lJztcbmltcG9ydCB7IGN1cnJlbnRMYW5ndWFnZSB9IGZyb20gJ1V0aWxzL0xhbmd1YWdlL2luZGV4JztcbmltcG9ydCBCYXNlU3RvcmUgZnJvbSAnLi9iYXNlLXN0b3JlJztcbmltcG9ydCB7IGNsaWVudE5vdGlmaWNhdGlvbnMgfSBmcm9tICcuL0hlbHBlcnMvY2xpZW50LW5vdGlmaWNhdGlvbnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21tb25TdG9yZSBleHRlbmRzIEJhc2VTdG9yZSB7XG4gICAgY29uc3RydWN0b3Iocm9vdF9zdG9yZSkge1xuICAgICAgICBzdXBlcih7IHJvb3Rfc3RvcmUgfSk7XG5cbiAgICAgICAgcmVhY3Rpb24oXG4gICAgICAgICAgICAoKSA9PiB0aGlzLmFwcF9yb3V0aW5nX2hpc3RvcnkubWFwKGkgPT4gaS5wYXRobmFtZSksXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLmZpbHRlck5vdGlmaWNhdGlvbk1lc3NhZ2VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgQG9ic2VydmFibGUgc2VydmVyX3RpbWUgPSBTZXJ2ZXJUaW1lLmdldCgpIHx8IHRvTW9tZW50KCk7IC8vIGZhbGxiYWNrOiBnZXQgY3VycmVudCB0aW1lIGZyb20gbW9tZW50LmpzXG4gICAgQG9ic2VydmFibGUgY3VycmVudF9sYW5ndWFnZSA9IGN1cnJlbnRMYW5ndWFnZTtcbiAgICBAb2JzZXJ2YWJsZSBhbGxvd2VkX2xhbmd1YWdlcyA9IE9iamVjdC5rZXlzKGdldEFsbG93ZWRMYW5ndWFnZXMoKSk7XG4gICAgQG9ic2VydmFibGUgaGFzX2Vycm9yID0gZmFsc2U7XG5cbiAgICBAb2JzZXJ2YWJsZSBlcnJvciA9IHtcbiAgICAgICAgdHlwZTogJ2luZm8nLFxuICAgICAgICBtZXNzYWdlOiAnJyxcbiAgICB9O1xuXG4gICAgQG9ic2VydmFibGUgbmV0d29ya19zdGF0dXMgPSB7fTtcbiAgICBAb2JzZXJ2YWJsZSBpc19uZXR3b3JrX29ubGluZSA9IGZhbHNlO1xuICAgIEBvYnNlcnZhYmxlIGlzX3NvY2tldF9vcGVuZWQgPSBmYWxzZTtcbiAgICBAb2JzZXJ2YWJsZSB3YXNfc29ja2V0X29wZW5lZCA9IGZhbHNlO1xuXG4gICAgQG9ic2VydmFibGUgc2VydmljZXNfZXJyb3IgPSB7fTtcblxuICAgIEBvYnNlcnZhYmxlIGRlcG9zaXRfdXJsID0gJyc7XG4gICAgQG9ic2VydmFibGUgd2l0aGRyYXdfdXJsID0gJyc7XG5cbiAgICBAb2JzZXJ2YWJsZSBhcHBfcm91dGluZ19oaXN0b3J5ID0gW107XG4gICAgQG9ic2VydmFibGUgYXBwX3JvdXRlciA9IHsgaGlzdG9yeTogbnVsbCB9O1xuICAgIEBvYnNlcnZhYmxlIGFwcF9pZCA9IHVuZGVmaW5lZDtcbiAgICBAb2JzZXJ2YWJsZSBwbGF0Zm9ybSA9ICcnO1xuICAgIEBvYnNlcnZhYmxlIHNlbGVjdGVkX2NvbnRyYWN0X3R5cGUgPSAnJztcblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRTZWxlY3RlZENvbnRyYWN0VHlwZShjb250cmFjdF90eXBlKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRfY29udHJhY3RfdHlwZSA9IGNvbnRyYWN0X3R5cGU7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGluaXQoKSB7XG4gICAgICAgIHRoaXMuc2V0UGxhdGZvcm0oKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgY2hlY2tBcHBJZCgpIHtcbiAgICAgICAgaWYgKHRoaXMuYXBwX2lkICYmIHRoaXMuYXBwX2lkICE9PSBnZXRBcHBJZCgpKSB7XG4gICAgICAgICAgICBCaW5hcnlTb2NrZXQuY2xvc2VBbmRPcGVuTmV3Q29ubmVjdGlvbigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXBwX2lkID0gZ2V0QXBwSWQoKTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0UGxhdGZvcm0oKSB7XG4gICAgICAgIGNvbnN0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2g7XG4gICAgICAgIGlmIChzZWFyY2gpIHtcbiAgICAgICAgICAgIGNvbnN0IHVybF9wYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHNlYXJjaCk7XG4gICAgICAgICAgICB0aGlzLnBsYXRmb3JtID0gdXJsX3BhcmFtcy5nZXQoJ3BsYXRmb3JtJykgfHwgJyc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0SW5pdGlhbFJvdXRlSGlzdG9yeUl0ZW0obG9jYXRpb24pIHtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJz9leHRfcGxhdGZvcm1fdXJsPScpICE9PSAtMSkge1xuICAgICAgICAgICAgY29uc3QgZXh0X3VybCA9IGRlY29kZVVSSShuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKS5zZWFyY2hQYXJhbXMuZ2V0KCdleHRfcGxhdGZvcm1fdXJsJykpO1xuXG4gICAgICAgICAgICBpZiAoZXh0X3VybD8uaW5kZXhPZihnZXRVcmxTbWFydFRyYWRlcigpKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkUm91dGVIaXN0b3J5SXRlbSh7IHBhdGhuYW1lOiBleHRfdXJsLCBhY3Rpb246ICdQVVNIJywgaXNfZXh0ZXJuYWw6IHRydWUgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV4dF91cmw/LmluZGV4T2Yocm91dGVzLmNhc2hpZXJfcDJwKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkUm91dGVIaXN0b3J5SXRlbSh7IHBhdGhuYW1lOiBleHRfdXJsLCBhY3Rpb246ICdQVVNIJyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXh0X3VybD8uaW5kZXhPZihnZXRVcmxCaW5hcnlCb3QoKSkgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJvdXRlSGlzdG9yeUl0ZW0oeyBwYXRobmFtZTogZXh0X3VybCwgYWN0aW9uOiAnUFVTSCcsIGlzX2V4dGVybmFsOiB0cnVlIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFJvdXRlSGlzdG9yeUl0ZW0oeyAuLi5sb2NhdGlvbiwgYWN0aW9uOiAnUFVTSCcgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZSh7fSwgZG9jdW1lbnQudGl0bGUsIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFkZFJvdXRlSGlzdG9yeUl0ZW0oeyAuLi5sb2NhdGlvbiwgYWN0aW9uOiAnUFVTSCcgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0U2VydmVyVGltZShzZXJ2ZXJfdGltZSkge1xuICAgICAgICB0aGlzLnNlcnZlcl90aW1lID0gc2VydmVyX3RpbWU7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldElzU29ja2V0T3BlbmVkKGlzX3NvY2tldF9vcGVuZWQpIHtcbiAgICAgICAgLy8gbm90ZSB0aGF0IGl0J3Mgbm90IGZvciBhY2NvdW50IHN3aXRjaCB0aGF0IHdlJ3JlIGRvaW5nIHRoaXMsXG4gICAgICAgIC8vIGJ1dCByYXRoZXIgdG8gcmVzZXQgYWNjb3VudCByZWxhdGVkIHN0b3JlcyBsaWtlIHBvcnRmb2xpbyBhbmQgY29udHJhY3QtdHJhZGVcbiAgICAgICAgY29uc3Qgc2hvdWxkX2Jyb2FkY2FzdF9hY2NvdW50X2NoYW5nZSA9IHRoaXMud2FzX3NvY2tldF9vcGVuZWQgJiYgaXNfc29ja2V0X29wZW5lZDtcblxuICAgICAgICB0aGlzLmlzX3NvY2tldF9vcGVuZWQgPSBpc19zb2NrZXRfb3BlbmVkO1xuICAgICAgICB0aGlzLndhc19zb2NrZXRfb3BlbmVkID0gdGhpcy53YXNfc29ja2V0X29wZW5lZCB8fCBpc19zb2NrZXRfb3BlbmVkO1xuXG4gICAgICAgIGlmIChzaG91bGRfYnJvYWRjYXN0X2FjY291bnRfY2hhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50LmJyb2FkY2FzdEFjY291bnRDaGFuZ2VBZnRlckF1dGhvcml6ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldE5ldHdvcmtTdGF0dXMoc3RhdHVzLCBpc19vbmxpbmUpIHtcbiAgICAgICAgaWYgKHRoaXMubmV0d29ya19zdGF0dXMuY2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya19zdGF0dXMuY2xhc3MgPSBzdGF0dXMuY2xhc3M7XG4gICAgICAgICAgICB0aGlzLm5ldHdvcmtfc3RhdHVzLnRvb2x0aXAgPSBzdGF0dXMudG9vbHRpcDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmV0d29ya19zdGF0dXMgPSBzdGF0dXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc19uZXR3b3JrX29ubGluZSA9IGlzX29ubGluZTtcblxuICAgICAgICBjb25zdCB1aV9zdG9yZSA9IHRoaXMucm9vdF9zdG9yZS51aTtcbiAgICAgICAgaWYgKCFpc19vbmxpbmUpIHtcbiAgICAgICAgICAgIHVpX3N0b3JlLmFkZE5vdGlmaWNhdGlvbk1lc3NhZ2UoY2xpZW50Tm90aWZpY2F0aW9ucygpLnlvdV9hcmVfb2ZmbGluZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1aV9zdG9yZS5yZW1vdmVOb3RpZmljYXRpb25NZXNzYWdlKGNsaWVudE5vdGlmaWNhdGlvbnMoKS55b3VfYXJlX29mZmxpbmUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldEVycm9yKGhhc19lcnJvciwgZXJyb3IpIHtcbiAgICAgICAgdGhpcy5oYXNfZXJyb3IgPSBoYXNfZXJyb3I7XG4gICAgICAgIHRoaXMuZXJyb3IgPSB7XG4gICAgICAgICAgICB0eXBlOiBlcnJvciA/IGVycm9yLnR5cGUgOiAnaW5mbycsXG4gICAgICAgICAgICAuLi4oZXJyb3IgJiYge1xuICAgICAgICAgICAgICAgIGhlYWRlcjogZXJyb3IuaGVhZGVyLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RfbGFiZWw6IGVycm9yLnJlZGlyZWN0X2xhYmVsLFxuICAgICAgICAgICAgICAgIHJlZGlyZWN0T25DbGljazogZXJyb3IucmVkaXJlY3RPbkNsaWNrLFxuICAgICAgICAgICAgICAgIHNob3VsZF9zaG93X3JlZnJlc2g6IGVycm9yLnNob3VsZF9zaG93X3JlZnJlc2gsXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RfdG86IGVycm9yLnJlZGlyZWN0X3RvLFxuICAgICAgICAgICAgICAgIHNob3VsZF9jbGVhcl9lcnJvcl9vbl9jbGljazogZXJyb3Iuc2hvdWxkX2NsZWFyX2Vycm9yX29uX2NsaWNrLFxuICAgICAgICAgICAgICAgIHNldEVycm9yOiB0aGlzLnNldEVycm9yLFxuICAgICAgICAgICAgfSksXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNob3dFcnJvcih7XG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIGhlYWRlcixcbiAgICAgICAgcmVkaXJlY3RfbGFiZWwsXG4gICAgICAgIHJlZGlyZWN0T25DbGljayxcbiAgICAgICAgc2hvdWxkX3Nob3dfcmVmcmVzaCxcbiAgICAgICAgcmVkaXJlY3RfdG8sXG4gICAgICAgIHNob3VsZF9jbGVhcl9lcnJvcl9vbl9jbGljayxcbiAgICB9KSB7XG4gICAgICAgIHRoaXMuc2V0RXJyb3IodHJ1ZSwge1xuICAgICAgICAgICAgaGVhZGVyLFxuICAgICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICAgIHJlZGlyZWN0X2xhYmVsLFxuICAgICAgICAgICAgcmVkaXJlY3RPbkNsaWNrLFxuICAgICAgICAgICAgc2hvdWxkX3Nob3dfcmVmcmVzaCxcbiAgICAgICAgICAgIHJlZGlyZWN0X3RvLFxuICAgICAgICAgICAgc2hvdWxkX2NsZWFyX2Vycm9yX29uX2NsaWNrLFxuICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldERlcG9zaXRVUkwoZGVwb3NpdF91cmwpIHtcbiAgICAgICAgdGhpcy5kZXBvc2l0X3VybCA9IGRlcG9zaXRfdXJsO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBzZXRXaXRoZHJhd1VSTCh3aXRoZHJhd191cmwpIHtcbiAgICAgICAgdGhpcy53aXRoZHJhd191cmwgPSB3aXRoZHJhd191cmw7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldFNlcnZpY2VzRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5zZXJ2aWNlc19lcnJvciA9IGVycm9yO1xuICAgICAgICBpZiAoaXNNb2JpbGUoKSkge1xuICAgICAgICAgICAgdGhpcy5yb290X3N0b3JlLnVpLmFkZFRvYXN0KHtcbiAgICAgICAgICAgICAgICBjb250ZW50OiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucm9vdF9zdG9yZS51aS50b2dnbGVTZXJ2aWNlc0Vycm9yTW9kYWwodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgc2V0QXBwUm91dGVySGlzdG9yeShoaXN0b3J5KSB7XG4gICAgICAgIHRoaXMuYXBwX3JvdXRlci5oaXN0b3J5ID0gaGlzdG9yeTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgcm91dGVUbyhwYXRobmFtZSkge1xuICAgICAgICBpZiAodGhpcy5hcHBfcm91dGVyLmhpc3RvcnkpIHRoaXMuYXBwX3JvdXRlci5oaXN0b3J5LnB1c2gocGF0aG5hbWUpO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhZGRSb3V0ZUhpc3RvcnlJdGVtKHJvdXRlcl9hY3Rpb24pIHtcbiAgICAgICAgY29uc3QgY2hlY2tfZXhpc3RpbmcgPSB0aGlzLmFwcF9yb3V0aW5nX2hpc3RvcnkuZmluZEluZGV4KFxuICAgICAgICAgICAgaSA9PiBpLnBhdGhuYW1lID09PSByb3V0ZXJfYWN0aW9uLnBhdGhuYW1lICYmIGkuYWN0aW9uID09PSAnUFVTSCdcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKGNoZWNrX2V4aXN0aW5nID4gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwX3JvdXRpbmdfaGlzdG9yeS5zcGxpY2UoY2hlY2tfZXhpc3RpbmcsIDEpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYXBwX3JvdXRpbmdfaGlzdG9yeS51bnNoaWZ0KHJvdXRlcl9hY3Rpb24pO1xuICAgIH1cblxuICAgIEBhY3Rpb24uYm91bmRcbiAgICByb3V0ZUJhY2tJbkFwcChoaXN0b3J5LCBhZGRpdGlvbmFsX3BsYXRmb3JtX3BhdGggPSBbXSkge1xuICAgICAgICBsZXQgcm91dGVfdG9faXRlbV9pZHggPSAtMTtcbiAgICAgICAgY29uc3Qgcm91dGVfdG9faXRlbSA9IHRoaXMuYXBwX3JvdXRpbmdfaGlzdG9yeS5maW5kKChoaXN0b3J5X2l0ZW0sIGlkeCkgPT4ge1xuICAgICAgICAgICAgaWYgKGhpc3RvcnlfaXRlbS5hY3Rpb24gPT09ICdQVVNIJykge1xuICAgICAgICAgICAgICAgIGlmIChoaXN0b3J5X2l0ZW0uaXNfZXh0ZXJuYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50X3BhdGggPSBoaXN0b3J5X2l0ZW0ucGF0aG5hbWUuc3BsaXQoJy8nKVsxXTtcbiAgICAgICAgICAgICAgICBjb25zdCBwbGF0Zm9ybV9wYXJlbnRfcGF0aHMgPSBbcm91dGVzLm10NSwgcm91dGVzLmJvdCwgcm91dGVzLnRyYWRlLCByb3V0ZXMuZHh0cmFkZV0ubWFwKFxuICAgICAgICAgICAgICAgICAgICBpID0+IGkuc3BsaXQoJy8nKVsxXVxuICAgICAgICAgICAgICAgICk7IC8vIG1hcCBmdWxsIHBhdGggdG8ganVzdCBiYXNlIHBhdGggKGAvbXQ1L2FiY2AgLT4gYG10NWApXG5cbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIHBsYXRmb3JtX3BhcmVudF9wYXRocy5pbmNsdWRlcyhwYXJlbnRfcGF0aCkgfHxcbiAgICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbF9wbGF0Zm9ybV9wYXRoLmluY2x1ZGVzKGhpc3RvcnlfaXRlbS5wYXRobmFtZSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgcm91dGVfdG9faXRlbV9pZHggPSBpZHg7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAocm91dGVfdG9faXRlbSkge1xuICAgICAgICAgICAgaWYgKHJvdXRlX3RvX2l0ZW0uaXNfZXh0ZXJuYWwpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHJvdXRlX3RvX2l0ZW0ucGF0aG5hbWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyb3V0ZV90b19pdGVtX2lkeCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBfcm91dGluZ19oaXN0b3J5LnNwbGljZSgwLCByb3V0ZV90b19pdGVtX2lkeCArIDEpO1xuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBvbmNlIHAycCBpcyByZWFkeVxuICAgICAgICAgICAgICAgIGNvbnN0IHVpX3N0b3JlID0gdGhpcy5yb290X3N0b3JlLnVpO1xuICAgICAgICAgICAgICAgIGlmIChyb3V0ZV90b19pdGVtLnBhdGhuYW1lID09PSByb3V0ZXMuY2FzaGllcl9wMnAgJiYgdWlfc3RvcmUuaXNfbW9iaWxlKVxuICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LnB1c2goYCR7cm91dGVfdG9faXRlbS5wYXRobmFtZX0vdmVyaWZpY2F0aW9uYCk7XG4gICAgICAgICAgICAgICAgZWxzZSBoaXN0b3J5LnB1c2gocm91dGVfdG9faXRlbS5wYXRobmFtZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaGlzdG9yeS5wdXNoKHJvdXRlcy50cmFkZSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbImFjdGlvbiIsIm9ic2VydmFibGUiLCJyZWFjdGlvbiIsInJvdXRlcyIsInRvTW9tZW50IiwiZ2V0VXJsU21hcnRUcmFkZXIiLCJpc01vYmlsZSIsImdldEFwcElkIiwiZ2V0VXJsQmluYXJ5Qm90IiwiZ2V0QWxsb3dlZExhbmd1YWdlcyIsIkJpbmFyeVNvY2tldCIsIlNlcnZlclRpbWUiLCJjdXJyZW50TGFuZ3VhZ2UiLCJCYXNlU3RvcmUiLCJjbGllbnROb3RpZmljYXRpb25zIiwiQ29tbW9uU3RvcmUiLCJib3VuZCIsInJvb3Rfc3RvcmUiLCJhcHBfcm91dGluZ19oaXN0b3J5IiwibWFwIiwiaSIsInBhdGhuYW1lIiwidWkiLCJmaWx0ZXJOb3RpZmljYXRpb25NZXNzYWdlcyIsImNvbnRyYWN0X3R5cGUiLCJzZWxlY3RlZF9jb250cmFjdF90eXBlIiwic2V0UGxhdGZvcm0iLCJhcHBfaWQiLCJjbG9zZUFuZE9wZW5OZXdDb25uZWN0aW9uIiwic2VhcmNoIiwid2luZG93IiwibG9jYXRpb24iLCJ1cmxfcGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwicGxhdGZvcm0iLCJnZXQiLCJocmVmIiwiaW5kZXhPZiIsImV4dF91cmwiLCJkZWNvZGVVUkkiLCJVUkwiLCJzZWFyY2hQYXJhbXMiLCJhZGRSb3V0ZUhpc3RvcnlJdGVtIiwiaXNfZXh0ZXJuYWwiLCJjYXNoaWVyX3AycCIsImhpc3RvcnkiLCJyZXBsYWNlU3RhdGUiLCJkb2N1bWVudCIsInRpdGxlIiwic2VydmVyX3RpbWUiLCJpc19zb2NrZXRfb3BlbmVkIiwic2hvdWxkX2Jyb2FkY2FzdF9hY2NvdW50X2NoYW5nZSIsIndhc19zb2NrZXRfb3BlbmVkIiwiY2xpZW50IiwiYnJvYWRjYXN0QWNjb3VudENoYW5nZUFmdGVyQXV0aG9yaXplIiwic3RhdHVzIiwiaXNfb25saW5lIiwibmV0d29ya19zdGF0dXMiLCJ0b29sdGlwIiwiaXNfbmV0d29ya19vbmxpbmUiLCJ1aV9zdG9yZSIsImFkZE5vdGlmaWNhdGlvbk1lc3NhZ2UiLCJ5b3VfYXJlX29mZmxpbmUiLCJyZW1vdmVOb3RpZmljYXRpb25NZXNzYWdlIiwiaGFzX2Vycm9yIiwiZXJyb3IiLCJ0eXBlIiwiaGVhZGVyIiwibWVzc2FnZSIsInJlZGlyZWN0X2xhYmVsIiwicmVkaXJlY3RPbkNsaWNrIiwic2hvdWxkX3Nob3dfcmVmcmVzaCIsInJlZGlyZWN0X3RvIiwic2hvdWxkX2NsZWFyX2Vycm9yX29uX2NsaWNrIiwic2V0RXJyb3IiLCJkZXBvc2l0X3VybCIsIndpdGhkcmF3X3VybCIsInNlcnZpY2VzX2Vycm9yIiwiYWRkVG9hc3QiLCJjb250ZW50IiwidG9nZ2xlU2VydmljZXNFcnJvck1vZGFsIiwiYXBwX3JvdXRlciIsInB1c2giLCJyb3V0ZXJfYWN0aW9uIiwiY2hlY2tfZXhpc3RpbmciLCJmaW5kSW5kZXgiLCJzcGxpY2UiLCJ1bnNoaWZ0IiwiYWRkaXRpb25hbF9wbGF0Zm9ybV9wYXRoIiwicm91dGVfdG9faXRlbV9pZHgiLCJyb3V0ZV90b19pdGVtIiwiZmluZCIsImhpc3RvcnlfaXRlbSIsImlkeCIsInBhcmVudF9wYXRoIiwic3BsaXQiLCJwbGF0Zm9ybV9wYXJlbnRfcGF0aHMiLCJtdDUiLCJib3QiLCJ0cmFkZSIsImR4dHJhZGUiLCJpbmNsdWRlcyIsImlzX21vYmlsZSIsIk9iamVjdCIsImtleXMiLCJ1bmRlZmluZWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Stores/common-store.js\n");

/***/ }),

/***/ "./Stores/connect.js":
/*!***************************!*\
  !*** ./Stores/connect.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"MobxContent\": () => (/* binding */ MobxContent),\n/* harmony export */   \"MobxContentProvider\": () => (/* binding */ MobxContentProvider),\n/* harmony export */   \"connect\": () => (/* binding */ connect)\n/* harmony export */ });\n/* harmony import */ var mobx_react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mobx-react */ \"../../../node_modules/mobx-react-lite/es/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"../../../node_modules/react/index.js\");\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\nvar isClassComponent = function isClassComponent(Component) {\n  return !!(typeof Component === 'function' && Component.prototype && Component.prototype.isReactComponent);\n};\n\nvar MobxContent = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createContext(null);\n\nfunction injectStorePropsToComponent(propsToSelectFn, BaseComponent) {\n  var Component = function Component(own_props) {\n    var store = react__WEBPACK_IMPORTED_MODULE_0__.useContext(MobxContent);\n    var ObservedComponent = BaseComponent;\n\n    if (isClassComponent(BaseComponent)) {\n      var FunctionalWrapperComponent = function FunctionalWrapperComponent(props) {\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(BaseComponent, props);\n      };\n\n      ObservedComponent = FunctionalWrapperComponent;\n    }\n\n    return (0,mobx_react__WEBPACK_IMPORTED_MODULE_1__.useObserver)(function () {\n      return ObservedComponent(_objectSpread(_objectSpread({}, own_props), propsToSelectFn(store, own_props)));\n    });\n  };\n\n  Component.displayName = BaseComponent.name;\n  return Component;\n}\n\nvar MobxContentProvider = function MobxContentProvider(_ref) {\n  var store = _ref.store,\n      children = _ref.children;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(MobxContent.Provider, {\n    value: _objectSpread(_objectSpread({}, store), {}, {\n      mobxStores: store\n    })\n  }, children);\n};\nvar connect = function connect(propsToSelectFn) {\n  return function (Component) {\n    return injectStorePropsToComponent(propsToSelectFn, Component);\n  };\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9TdG9yZXMvY29ubmVjdC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBOztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFBQTtBQUFBOztBQUNBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9TdG9yZXMvY29ubmVjdC5qcz80NzZlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZU9ic2VydmVyIH0gZnJvbSAnbW9ieC1yZWFjdCc7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5jb25zdCBpc0NsYXNzQ29tcG9uZW50ID0gQ29tcG9uZW50ID0+XG4gICAgISEodHlwZW9mIENvbXBvbmVudCA9PT0gJ2Z1bmN0aW9uJyAmJiBDb21wb25lbnQucHJvdG90eXBlICYmIENvbXBvbmVudC5wcm90b3R5cGUuaXNSZWFjdENvbXBvbmVudCk7XG5cbmV4cG9ydCBjb25zdCBNb2J4Q29udGVudCA9IFJlYWN0LmNyZWF0ZUNvbnRleHQobnVsbCk7XG5cbmZ1bmN0aW9uIGluamVjdFN0b3JlUHJvcHNUb0NvbXBvbmVudChwcm9wc1RvU2VsZWN0Rm4sIEJhc2VDb21wb25lbnQpIHtcbiAgICBjb25zdCBDb21wb25lbnQgPSBvd25fcHJvcHMgPT4ge1xuICAgICAgICBjb25zdCBzdG9yZSA9IFJlYWN0LnVzZUNvbnRleHQoTW9ieENvbnRlbnQpO1xuXG4gICAgICAgIGxldCBPYnNlcnZlZENvbXBvbmVudCA9IEJhc2VDb21wb25lbnQ7XG5cbiAgICAgICAgaWYgKGlzQ2xhc3NDb21wb25lbnQoQmFzZUNvbXBvbmVudCkpIHtcbiAgICAgICAgICAgIGNvbnN0IEZ1bmN0aW9uYWxXcmFwcGVyQ29tcG9uZW50ID0gcHJvcHMgPT4gPEJhc2VDb21wb25lbnQgey4uLnByb3BzfSAvPjtcbiAgICAgICAgICAgIE9ic2VydmVkQ29tcG9uZW50ID0gRnVuY3Rpb25hbFdyYXBwZXJDb21wb25lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdXNlT2JzZXJ2ZXIoKCkgPT4gT2JzZXJ2ZWRDb21wb25lbnQoeyAuLi5vd25fcHJvcHMsIC4uLnByb3BzVG9TZWxlY3RGbihzdG9yZSwgb3duX3Byb3BzKSB9KSk7XG4gICAgfTtcblxuICAgIENvbXBvbmVudC5kaXNwbGF5TmFtZSA9IEJhc2VDb21wb25lbnQubmFtZTtcbiAgICByZXR1cm4gQ29tcG9uZW50O1xufVxuXG5leHBvcnQgY29uc3QgTW9ieENvbnRlbnRQcm92aWRlciA9ICh7IHN0b3JlLCBjaGlsZHJlbiB9KSA9PiB7XG4gICAgcmV0dXJuIDxNb2J4Q29udGVudC5Qcm92aWRlciB2YWx1ZT17eyAuLi5zdG9yZSwgbW9ieFN0b3Jlczogc3RvcmUgfX0+e2NoaWxkcmVufTwvTW9ieENvbnRlbnQuUHJvdmlkZXI+O1xufTtcblxuZXhwb3J0IGNvbnN0IGNvbm5lY3QgPSBwcm9wc1RvU2VsZWN0Rm4gPT4gQ29tcG9uZW50ID0+IGluamVjdFN0b3JlUHJvcHNUb0NvbXBvbmVudChwcm9wc1RvU2VsZWN0Rm4sIENvbXBvbmVudCk7XG4iXSwibmFtZXMiOlsidXNlT2JzZXJ2ZXIiLCJSZWFjdCIsImlzQ2xhc3NDb21wb25lbnQiLCJDb21wb25lbnQiLCJwcm90b3R5cGUiLCJpc1JlYWN0Q29tcG9uZW50IiwiTW9ieENvbnRlbnQiLCJjcmVhdGVDb250ZXh0IiwiaW5qZWN0U3RvcmVQcm9wc1RvQ29tcG9uZW50IiwicHJvcHNUb1NlbGVjdEZuIiwiQmFzZUNvbXBvbmVudCIsIm93bl9wcm9wcyIsInN0b3JlIiwidXNlQ29udGV4dCIsIk9ic2VydmVkQ29tcG9uZW50IiwiRnVuY3Rpb25hbFdyYXBwZXJDb21wb25lbnQiLCJwcm9wcyIsImRpc3BsYXlOYW1lIiwibmFtZSIsIk1vYnhDb250ZW50UHJvdmlkZXIiLCJjaGlsZHJlbiIsIm1vYnhTdG9yZXMiLCJjb25uZWN0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./Stores/connect.js\n");

/***/ }),

/***/ "./Stores/gtm-store.js":
/*!*****************************!*\
  !*** ./Stores/gtm-store.js ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ GTMStore)\n/* harmony export */ });\n/* harmony import */ var js_cookie__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! js-cookie */ \"../../../node_modules/js-cookie/src/js.cookie.js\");\n/* harmony import */ var js_cookie__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(js_cookie__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! mobx */ \"../../../node_modules/mobx/lib/mobx.module.js\");\n/* harmony import */ var _deriv_shared__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @deriv/shared */ \"../../shared/src/index.js\");\n/* harmony import */ var _deriv_translations__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @deriv/translations */ \"../../translations/src/index.js\");\n/* harmony import */ var _common_base_socket_base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! _common/base/socket_base */ \"./_common/base/socket_base.js\");\n/* harmony import */ var _common_base_socket_base__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_common_base_socket_base__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _base_store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./base-store */ \"./Stores/base-store.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nvar _dec, _dec2, _dec3, _dec4, _dec5, _class;\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) { var desc = {}; Object.keys(descriptor).forEach(function (key) { desc[key] = descriptor[key]; }); desc.enumerable = !!desc.enumerable; desc.configurable = !!desc.configurable; if ('value' in desc || desc.initializer) { desc.writable = true; } desc = decorators.slice().reverse().reduce(function (desc, decorator) { return decorator(target, property, desc) || desc; }, desc); if (context && desc.initializer !== void 0) { desc.value = desc.initializer ? desc.initializer.call(context) : void 0; desc.initializer = undefined; } if (desc.initializer === void 0) { Object.defineProperty(target, property, desc); desc = null; } return desc; }\n\n\n\n\n\n\n\nvar GTMStore = (_dec = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec2 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec3 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec4 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, _dec5 = mobx__WEBPACK_IMPORTED_MODULE_1__.action.bound, (_class = /*#__PURE__*/function (_BaseStore) {\n  _inherits(GTMStore, _BaseStore);\n\n  var _super = _createSuper(GTMStore);\n\n  function GTMStore(root_store) {\n    var _this;\n\n    _classCallCheck(this, GTMStore);\n\n    _this = _super.call(this, {\n      root_store: root_store\n    });\n    _this.is_gtm_applicable = window.location.hostname === 'deriv-app.binary.sx' || /^(16303|16929|19111|19112)$/.test((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_2__.getAppId)());\n\n    _this.onSwitchAccount(_this.accountSwitcherListener);\n\n    return _this;\n  }\n\n  _createClass(GTMStore, [{\n    key: \"visitorId\",\n    get: function get() {\n      return this.root_store.client.loginid;\n    }\n    /**\n     * Contains common data that will be passed to GTM on each datalayer push\n     *\n     * @returns {object}\n     */\n\n  }, {\n    key: \"common_variables\",\n    get: function get() {\n      var platform = function platform() {\n        var url = new URL(window.location.href);\n        var domain = url.hostname;\n        var path = url.pathname; // TODO: [app-link-refactor] - Remove backwards compatibility for `deriv.app`\n\n        if (/^(deriv-app\\.binary.sx|app.deriv.com|staging-app.deriv.com|deriv.app|staging.deriv.app|localhost.binary.sx)$/.test(domain)) {\n          if (path === 'bot') {\n            return 'DBot';\n          } else if (path === _deriv_shared__WEBPACK_IMPORTED_MODULE_2__.CFD_PLATFORMS.MT5) {\n            return 'MT5';\n          }\n\n          return 'DTrader';\n        }\n\n        return 'undefined';\n      };\n\n      return _objectSpread(_objectSpread({\n        language: (0,_deriv_translations__WEBPACK_IMPORTED_MODULE_3__.getLanguage)()\n      }, this.root_store.client.is_logged_in && {\n        visitorId: this.visitorId,\n        currency: this.root_store.client.currency,\n        userId: this.root_store.client.user_id,\n        email: this.root_store.client.email\n      }), {}, {\n        loggedIn: this.root_store.client.is_logged_in,\n        theme: this.root_store.ui.is_dark_mode_on ? 'dark' : 'light',\n        platform: platform()\n      });\n    }\n  }, {\n    key: \"accountSwitcherListener\",\n    value: function accountSwitcherListener() {\n      var _this2 = this;\n\n      return new Promise(function (resolve) {\n        return resolve(_this2.pushDataLayer({\n          event: 'account switch'\n        }));\n      });\n    }\n    /**\n     * Pushes provided data as GTM DataLayer\n     *\n     * @param {object} data\n     */\n\n  }, {\n    key: \"pushDataLayer\",\n    value: function () {\n      var _pushDataLayer = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(data) {\n        var _this3 = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.is_gtm_applicable) {\n                  _common_base_socket_base__WEBPACK_IMPORTED_MODULE_4___default().wait('authorize').then(function () {\n                    var gtm_object = _objectSpread(_objectSpread({}, _this3.common_variables), data);\n\n                    if (!gtm_object.event) return;\n                    dataLayer.push(gtm_object);\n                  });\n                }\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function pushDataLayer(_x) {\n        return _pushDataLayer.apply(this, arguments);\n      }\n\n      return pushDataLayer;\n    }()\n    /**\n     * Pushes deposit & withdrawal data from transaction-stream to GTM\n     *\n     * @param {object} response\n     * @param {object} extra_data\n     */\n\n  }, {\n    key: \"pushTransactionData\",\n    value: function pushTransactionData(response) {\n      var extra_data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      if (!this.is_gtm_applicable || this.root_store.client.is_virtual) return;\n      if (!response.transaction || !response.transaction.action) return;\n      if (!['deposit', 'withdrawal'].includes(response.transaction.action)) return;\n      var moment_now = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_2__.toMoment)();\n      var storage_key = 'GTM_transactions'; // Remove values from prev days so localStorage doesn't grow to infinity\n\n      var gtm_transactions = JSON.parse(localStorage.getItem(storage_key)) || {};\n\n      if (Object.prototype.hasOwnProperty.call(gtm_transactions, 'timestamp')) {\n        if (moment_now.isAfter((0,_deriv_shared__WEBPACK_IMPORTED_MODULE_2__.epochToMoment)(gtm_transactions.timestamp), 'day')) {\n          localStorage.removeItem(storage_key);\n          gtm_transactions = {\n            timestamp: moment_now.unix()\n          };\n        }\n      }\n\n      var transactions_arr = gtm_transactions.transactions || [];\n\n      if (!transactions_arr.includes(response.transaction.transaction_id)) {\n        var data = {\n          event: 'transaction',\n          bom_account_type: this.root_store.client.account_type,\n          bom_today: moment_now.unix(),\n          transaction: {\n            id: response.transaction.transaction_id,\n            type: response.transaction.action,\n            time: response.transaction.transaction_time,\n            amount: response.transaction.amount\n          }\n        };\n        Object.assign(data, extra_data);\n        this.pushDataLayer(data);\n        transactions_arr.push(response.transaction.transaction_id);\n        gtm_transactions.transactions = transactions_arr;\n        gtm_transactions.timestamp = gtm_transactions.timestamp || moment_now.unix();\n        localStorage.setItem(storage_key, JSON.stringify(gtm_transactions));\n      }\n    }\n  }, {\n    key: \"eventHandler\",\n    value: function eventHandler(get_settings) {\n      if (!this.is_gtm_applicable) return;\n      var login_event = localStorage.getItem('GTM_login');\n      var is_new_account = localStorage.getItem('GTM_new_account') === '1';\n      localStorage.removeItem('GTM_login');\n      localStorage.removeItem('GTM_new_account');\n      var affiliate_token = js_cookie__WEBPACK_IMPORTED_MODULE_0__.getJSON('affiliate_tracking');\n\n      if (affiliate_token) {\n        this.pushDataLayer({\n          affiliate_token: affiliate_token\n        });\n      } // Get current time (moment, set by server), else fallback to client time\n\n\n      var moment_now = (0,_deriv_shared__WEBPACK_IMPORTED_MODULE_2__.toMoment)();\n      var data = {\n        visitorId: this.visitorId,\n        account_type: this.root_store.client.account_type,\n        currency: this.root_store.client.currency,\n        country: get_settings.country,\n        country_abbrev: get_settings.country_code,\n        email: get_settings.email,\n        url: window.location.href,\n        today: moment_now.unix()\n      };\n\n      if (is_new_account) {\n        data.event = 'new_account';\n        data.bom_date_joined = data.bom_today;\n      }\n\n      if (login_event) {\n        data.event = login_event;\n      }\n\n      this.pushDataLayer(data);\n    }\n  }, {\n    key: \"setLoginFlag\",\n    value: function setLoginFlag(event_name) {\n      if (this.is_gtm_applicable && event_name) {\n        localStorage.setItem('GTM_login', event_name);\n      }\n    }\n  }]);\n\n  return GTMStore;\n}(_base_store__WEBPACK_IMPORTED_MODULE_5__.default), (_applyDecoratedDescriptor(_class.prototype, \"visitorId\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"visitorId\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"common_variables\", [mobx__WEBPACK_IMPORTED_MODULE_1__.computed], Object.getOwnPropertyDescriptor(_class.prototype, \"common_variables\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"accountSwitcherListener\", [_dec], Object.getOwnPropertyDescriptor(_class.prototype, \"accountSwitcherListener\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"pushDataLayer\", [_dec2], Object.getOwnPropertyDescriptor(_class.prototype, \"pushDataLayer\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"pushTransactionData\", [_dec3], Object.getOwnPropertyDescriptor(_class.prototype, \"pushTransactionData\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"eventHandler\", [_dec4], Object.getOwnPropertyDescriptor(_class.prototype, \"eventHandler\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"setLoginFlag\", [_dec5], Object.getOwnPropertyDescriptor(_class.prototype, \"setLoginFlag\"), _class.prototype)), _class));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9TdG9yZXMvZ3RtLXN0b3JlLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7OztBQUlBO0FBQUE7O0FBQUE7O0FBQ0E7QUFBQTtBQUFBO0FBREE7O0FBR0E7O0FBSEE7QUFJQTs7OztBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQVZBO0FBWUE7OztBQUVBO0FBQ0E7O0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFDQTtBQUFBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUNBOztBQVRBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7Ozs7OztBQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUdBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQUpBO0FBV0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTs7QUFXQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7OztBQXpLQSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL1N0b3Jlcy9ndG0tc3RvcmUuanM/OTExYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBDb29raWVzIGZyb20gJ2pzLWNvb2tpZSc7XG5pbXBvcnQgeyBhY3Rpb24sIGNvbXB1dGVkIH0gZnJvbSAnbW9ieCc7XG5pbXBvcnQgeyBnZXRBcHBJZCwgdG9Nb21lbnQsIGVwb2NoVG9Nb21lbnQsIENGRF9QTEFURk9STVMgfSBmcm9tICdAZGVyaXYvc2hhcmVkJztcbmltcG9ydCB7IGdldExhbmd1YWdlIH0gZnJvbSAnQGRlcml2L3RyYW5zbGF0aW9ucyc7XG5pbXBvcnQgQmluYXJ5U29ja2V0IGZyb20gJ19jb21tb24vYmFzZS9zb2NrZXRfYmFzZSc7XG5pbXBvcnQgQmFzZVN0b3JlIGZyb20gJy4vYmFzZS1zdG9yZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdUTVN0b3JlIGV4dGVuZHMgQmFzZVN0b3JlIHtcbiAgICBpc19ndG1fYXBwbGljYWJsZSA9XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZSA9PT0gJ2Rlcml2LWFwcC5iaW5hcnkuc3gnIHx8IC9eKDE2MzAzfDE2OTI5fDE5MTExfDE5MTEyKSQvLnRlc3QoZ2V0QXBwSWQoKSk7XG5cbiAgICBjb25zdHJ1Y3Rvcihyb290X3N0b3JlKSB7XG4gICAgICAgIHN1cGVyKHsgcm9vdF9zdG9yZSB9KTtcblxuICAgICAgICB0aGlzLm9uU3dpdGNoQWNjb3VudCh0aGlzLmFjY291bnRTd2l0Y2hlckxpc3RlbmVyKTtcbiAgICB9XG5cbiAgICBAY29tcHV0ZWRcbiAgICBnZXQgdmlzaXRvcklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290X3N0b3JlLmNsaWVudC5sb2dpbmlkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnRhaW5zIGNvbW1vbiBkYXRhIHRoYXQgd2lsbCBiZSBwYXNzZWQgdG8gR1RNIG9uIGVhY2ggZGF0YWxheWVyIHB1c2hcbiAgICAgKlxuICAgICAqIEByZXR1cm5zIHtvYmplY3R9XG4gICAgICovXG4gICAgQGNvbXB1dGVkXG4gICAgZ2V0IGNvbW1vbl92YXJpYWJsZXMoKSB7XG4gICAgICAgIGNvbnN0IHBsYXRmb3JtID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gICAgICAgICAgICBjb25zdCBkb21haW4gPSB1cmwuaG9zdG5hbWU7XG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdXJsLnBhdGhuYW1lO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiBbYXBwLWxpbmstcmVmYWN0b3JdIC0gUmVtb3ZlIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IGZvciBgZGVyaXYuYXBwYFxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIC9eKGRlcml2LWFwcFxcLmJpbmFyeS5zeHxhcHAuZGVyaXYuY29tfHN0YWdpbmctYXBwLmRlcml2LmNvbXxkZXJpdi5hcHB8c3RhZ2luZy5kZXJpdi5hcHB8bG9jYWxob3N0LmJpbmFyeS5zeCkkLy50ZXN0KFxuICAgICAgICAgICAgICAgICAgICBkb21haW5cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBpZiAocGF0aCA9PT0gJ2JvdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdEQm90JztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGggPT09IENGRF9QTEFURk9STVMuTVQ1KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnTVQ1JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICdEVHJhZGVyJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAndW5kZWZpbmVkJztcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxhbmd1YWdlOiBnZXRMYW5ndWFnZSgpLFxuICAgICAgICAgICAgLi4uKHRoaXMucm9vdF9zdG9yZS5jbGllbnQuaXNfbG9nZ2VkX2luICYmIHtcbiAgICAgICAgICAgICAgICB2aXNpdG9ySWQ6IHRoaXMudmlzaXRvcklkLFxuICAgICAgICAgICAgICAgIGN1cnJlbmN5OiB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50LmN1cnJlbmN5LFxuICAgICAgICAgICAgICAgIHVzZXJJZDogdGhpcy5yb290X3N0b3JlLmNsaWVudC51c2VyX2lkLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50LmVtYWlsLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBsb2dnZWRJbjogdGhpcy5yb290X3N0b3JlLmNsaWVudC5pc19sb2dnZWRfaW4sXG4gICAgICAgICAgICB0aGVtZTogdGhpcy5yb290X3N0b3JlLnVpLmlzX2RhcmtfbW9kZV9vbiA/ICdkYXJrJyA6ICdsaWdodCcsXG4gICAgICAgICAgICBwbGF0Zm9ybTogcGxhdGZvcm0oKSxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBAYWN0aW9uLmJvdW5kXG4gICAgYWNjb3VudFN3aXRjaGVyTGlzdGVuZXIoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHJlc29sdmUodGhpcy5wdXNoRGF0YUxheWVyKHsgZXZlbnQ6ICdhY2NvdW50IHN3aXRjaCcgfSkpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQdXNoZXMgcHJvdmlkZWQgZGF0YSBhcyBHVE0gRGF0YUxheWVyXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIEBhY3Rpb24uYm91bmRcbiAgICBhc3luYyBwdXNoRGF0YUxheWVyKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNfZ3RtX2FwcGxpY2FibGUpIHtcbiAgICAgICAgICAgIEJpbmFyeVNvY2tldC53YWl0KCdhdXRob3JpemUnKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBndG1fb2JqZWN0ID0geyAuLi50aGlzLmNvbW1vbl92YXJpYWJsZXMsIC4uLmRhdGEgfTtcbiAgICAgICAgICAgICAgICBpZiAoIWd0bV9vYmplY3QuZXZlbnQpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIGRhdGFMYXllci5wdXNoKGd0bV9vYmplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQdXNoZXMgZGVwb3NpdCAmIHdpdGhkcmF3YWwgZGF0YSBmcm9tIHRyYW5zYWN0aW9uLXN0cmVhbSB0byBHVE1cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSByZXNwb25zZVxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBleHRyYV9kYXRhXG4gICAgICovXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHB1c2hUcmFuc2FjdGlvbkRhdGEocmVzcG9uc2UsIGV4dHJhX2RhdGEgPSB7fSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNfZ3RtX2FwcGxpY2FibGUgfHwgdGhpcy5yb290X3N0b3JlLmNsaWVudC5pc192aXJ0dWFsKSByZXR1cm47XG4gICAgICAgIGlmICghcmVzcG9uc2UudHJhbnNhY3Rpb24gfHwgIXJlc3BvbnNlLnRyYW5zYWN0aW9uLmFjdGlvbikgcmV0dXJuO1xuICAgICAgICBpZiAoIVsnZGVwb3NpdCcsICd3aXRoZHJhd2FsJ10uaW5jbHVkZXMocmVzcG9uc2UudHJhbnNhY3Rpb24uYWN0aW9uKSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IG1vbWVudF9ub3cgPSB0b01vbWVudCgpO1xuICAgICAgICBjb25zdCBzdG9yYWdlX2tleSA9ICdHVE1fdHJhbnNhY3Rpb25zJztcblxuICAgICAgICAvLyBSZW1vdmUgdmFsdWVzIGZyb20gcHJldiBkYXlzIHNvIGxvY2FsU3RvcmFnZSBkb2Vzbid0IGdyb3cgdG8gaW5maW5pdHlcbiAgICAgICAgbGV0IGd0bV90cmFuc2FjdGlvbnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2Vfa2V5KSkgfHwge307XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZ3RtX3RyYW5zYWN0aW9ucywgJ3RpbWVzdGFtcCcpKSB7XG4gICAgICAgICAgICBpZiAobW9tZW50X25vdy5pc0FmdGVyKGVwb2NoVG9Nb21lbnQoZ3RtX3RyYW5zYWN0aW9ucy50aW1lc3RhbXApLCAnZGF5JykpIHtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShzdG9yYWdlX2tleSk7XG4gICAgICAgICAgICAgICAgZ3RtX3RyYW5zYWN0aW9ucyA9IHsgdGltZXN0YW1wOiBtb21lbnRfbm93LnVuaXgoKSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uc19hcnIgPSBndG1fdHJhbnNhY3Rpb25zLnRyYW5zYWN0aW9ucyB8fCBbXTtcbiAgICAgICAgaWYgKCF0cmFuc2FjdGlvbnNfYXJyLmluY2x1ZGVzKHJlc3BvbnNlLnRyYW5zYWN0aW9uLnRyYW5zYWN0aW9uX2lkKSkge1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBldmVudDogJ3RyYW5zYWN0aW9uJyxcbiAgICAgICAgICAgICAgICBib21fYWNjb3VudF90eXBlOiB0aGlzLnJvb3Rfc3RvcmUuY2xpZW50LmFjY291bnRfdHlwZSxcbiAgICAgICAgICAgICAgICBib21fdG9kYXk6IG1vbWVudF9ub3cudW5peCgpLFxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiByZXNwb25zZS50cmFuc2FjdGlvbi50cmFuc2FjdGlvbl9pZCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogcmVzcG9uc2UudHJhbnNhY3Rpb24uYWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICB0aW1lOiByZXNwb25zZS50cmFuc2FjdGlvbi50cmFuc2FjdGlvbl90aW1lLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHJlc3BvbnNlLnRyYW5zYWN0aW9uLmFtb3VudCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGF0YSwgZXh0cmFfZGF0YSk7XG4gICAgICAgICAgICB0aGlzLnB1c2hEYXRhTGF5ZXIoZGF0YSk7XG5cbiAgICAgICAgICAgIHRyYW5zYWN0aW9uc19hcnIucHVzaChyZXNwb25zZS50cmFuc2FjdGlvbi50cmFuc2FjdGlvbl9pZCk7XG4gICAgICAgICAgICBndG1fdHJhbnNhY3Rpb25zLnRyYW5zYWN0aW9ucyA9IHRyYW5zYWN0aW9uc19hcnI7XG4gICAgICAgICAgICBndG1fdHJhbnNhY3Rpb25zLnRpbWVzdGFtcCA9IGd0bV90cmFuc2FjdGlvbnMudGltZXN0YW1wIHx8IG1vbWVudF9ub3cudW5peCgpO1xuXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlX2tleSwgSlNPTi5zdHJpbmdpZnkoZ3RtX3RyYW5zYWN0aW9ucykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIGV2ZW50SGFuZGxlcihnZXRfc2V0dGluZ3MpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzX2d0bV9hcHBsaWNhYmxlKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgbG9naW5fZXZlbnQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnR1RNX2xvZ2luJyk7XG4gICAgICAgIGNvbnN0IGlzX25ld19hY2NvdW50ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0dUTV9uZXdfYWNjb3VudCcpID09PSAnMSc7XG5cbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ0dUTV9sb2dpbicpO1xuICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnR1RNX25ld19hY2NvdW50Jyk7XG5cbiAgICAgICAgY29uc3QgYWZmaWxpYXRlX3Rva2VuID0gQ29va2llcy5nZXRKU09OKCdhZmZpbGlhdGVfdHJhY2tpbmcnKTtcbiAgICAgICAgaWYgKGFmZmlsaWF0ZV90b2tlbikge1xuICAgICAgICAgICAgdGhpcy5wdXNoRGF0YUxheWVyKHsgYWZmaWxpYXRlX3Rva2VuIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IGN1cnJlbnQgdGltZSAobW9tZW50LCBzZXQgYnkgc2VydmVyKSwgZWxzZSBmYWxsYmFjayB0byBjbGllbnQgdGltZVxuICAgICAgICBjb25zdCBtb21lbnRfbm93ID0gdG9Nb21lbnQoKTtcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgICAgIHZpc2l0b3JJZDogdGhpcy52aXNpdG9ySWQsXG4gICAgICAgICAgICBhY2NvdW50X3R5cGU6IHRoaXMucm9vdF9zdG9yZS5jbGllbnQuYWNjb3VudF90eXBlLFxuICAgICAgICAgICAgY3VycmVuY3k6IHRoaXMucm9vdF9zdG9yZS5jbGllbnQuY3VycmVuY3ksXG4gICAgICAgICAgICBjb3VudHJ5OiBnZXRfc2V0dGluZ3MuY291bnRyeSxcbiAgICAgICAgICAgIGNvdW50cnlfYWJicmV2OiBnZXRfc2V0dGluZ3MuY291bnRyeV9jb2RlLFxuICAgICAgICAgICAgZW1haWw6IGdldF9zZXR0aW5ncy5lbWFpbCxcbiAgICAgICAgICAgIHVybDogd2luZG93LmxvY2F0aW9uLmhyZWYsXG4gICAgICAgICAgICB0b2RheTogbW9tZW50X25vdy51bml4KCksXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGlzX25ld19hY2NvdW50KSB7XG4gICAgICAgICAgICBkYXRhLmV2ZW50ID0gJ25ld19hY2NvdW50JztcbiAgICAgICAgICAgIGRhdGEuYm9tX2RhdGVfam9pbmVkID0gZGF0YS5ib21fdG9kYXk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobG9naW5fZXZlbnQpIHtcbiAgICAgICAgICAgIGRhdGEuZXZlbnQgPSBsb2dpbl9ldmVudDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnB1c2hEYXRhTGF5ZXIoZGF0YSk7XG4gICAgfVxuXG4gICAgQGFjdGlvbi5ib3VuZFxuICAgIHNldExvZ2luRmxhZyhldmVudF9uYW1lKSB7XG4gICAgICAgIGlmICh0aGlzLmlzX2d0bV9hcHBsaWNhYmxlICYmIGV2ZW50X25hbWUpIHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdHVE1fbG9naW4nLCBldmVudF9uYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6WyJDb29raWVzIiwiYWN0aW9uIiwiY29tcHV0ZWQiLCJnZXRBcHBJZCIsInRvTW9tZW50IiwiZXBvY2hUb01vbWVudCIsIkNGRF9QTEFURk9STVMiLCJnZXRMYW5ndWFnZSIsIkJpbmFyeVNvY2tldCIsIkJhc2VTdG9yZSIsIkdUTVN0b3JlIiwiYm91bmQiLCJyb290X3N0b3JlIiwiaXNfZ3RtX2FwcGxpY2FibGUiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhvc3RuYW1lIiwidGVzdCIsIm9uU3dpdGNoQWNjb3VudCIsImFjY291bnRTd2l0Y2hlckxpc3RlbmVyIiwiY2xpZW50IiwibG9naW5pZCIsInBsYXRmb3JtIiwidXJsIiwiVVJMIiwiaHJlZiIsImRvbWFpbiIsInBhdGgiLCJwYXRobmFtZSIsIk1UNSIsImxhbmd1YWdlIiwiaXNfbG9nZ2VkX2luIiwidmlzaXRvcklkIiwiY3VycmVuY3kiLCJ1c2VySWQiLCJ1c2VyX2lkIiwiZW1haWwiLCJsb2dnZWRJbiIsInRoZW1lIiwidWkiLCJpc19kYXJrX21vZGVfb24iLCJQcm9taXNlIiwicmVzb2x2ZSIsInB1c2hEYXRhTGF5ZXIiLCJldmVudCIsImRhdGEiLCJ3YWl0IiwidGhlbiIsImd0bV9vYmplY3QiLCJjb21tb25fdmFyaWFibGVzIiwiZGF0YUxheWVyIiwicHVzaCIsInJlc3BvbnNlIiwiZXh0cmFfZGF0YSIsImlzX3ZpcnR1YWwiLCJ0cmFuc2FjdGlvbiIsImluY2x1ZGVzIiwibW9tZW50X25vdyIsInN0b3JhZ2Vfa2V5IiwiZ3RtX3RyYW5zYWN0aW9ucyIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJPYmplY3QiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpc0FmdGVyIiwidGltZXN0YW1wIiwicmVtb3ZlSXRlbSIsInVuaXgiLCJ0cmFuc2FjdGlvbnNfYXJyIiwidHJhbnNhY3Rpb25zIiwidHJhbnNhY3Rpb25faWQiLCJib21fYWNjb3VudF90eXBlIiwiYWNjb3VudF90eXBlIiwiYm9tX3RvZGF5IiwiaWQiLCJ0eXBlIiwidGltZSIsInRyYW5zYWN0aW9uX3RpbWUiLCJhbW91bnQiLCJhc3NpZ24iLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwiZ2V0X3NldHRpbmdzIiwibG9naW5fZXZlbnQiLCJpc19uZXdfYWNjb3VudCIsImFmZmlsaWF0ZV90b2tlbiIsImdldEpTT04iLCJjb3VudHJ5IiwiY291bnRyeV9hYmJyZXYiLCJjb3VudHJ5X2NvZGUiLCJ0b2RheSIsImJvbV9kYXRlX2pvaW5lZCIsImV2ZW50X25hbWUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Stores/gtm-store.js\n");

/***/ }),

/***/ "./Stores/index.js":
/*!*************************!*\
  !*** ./Stores/index.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ RootStore)\n/* harmony export */ });\n/* harmony import */ var _client_store__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./client-store */ \"./Stores/client-store.js\");\n/* harmony import */ var _common_store__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./common-store */ \"./Stores/common-store.js\");\n/* harmony import */ var _gtm_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./gtm-store */ \"./Stores/gtm-store.js\");\n/* harmony import */ var _rudderstack_store__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./rudderstack-store */ \"./Stores/rudderstack-store.js\");\n/* harmony import */ var _pushwoosh_store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./pushwoosh-store */ \"./Stores/pushwoosh-store.js\");\n/* harmony import */ var _Modules__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Modules */ \"./Stores/Modules/index.js\");\n/* harmony import */ var _menu_store__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./menu-store */ \"./Stores/menu-store.js\");\n/* harmony import */ var _ui_store__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ui-store */ \"./Stores/ui-store.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\n\n\n\n\n\n\nvar RootStore = function RootStore() {\n  _classCallCheck(this, RootStore);\n\n  this.client = new _client_store__WEBPACK_IMPORTED_MODULE_0__.default(this);\n  this.common = new _common_store__WEBPACK_IMPORTED_MODULE_1__.default(this);\n  this.modules = new _Modules__WEBPACK_IMPORTED_MODULE_5__.default(this);\n  this.ui = new _ui_store__WEBPACK_IMPORTED_MODULE_7__.default(this);\n  this.gtm = new _gtm_store__WEBPACK_IMPORTED_MODULE_2__.default(this);\n  this.rudderstack = new _rudderstack_store__WEBPACK_IMPORTED_MODULE_3__.default(this);\n  this.menu = new _menu_store__WEBPACK_IMPORTED_MODULE_6__.default(this);\n  this.pushwoosh = new _pushwoosh_store__WEBPACK_IMPORTED_MODULE_4__.default(this);\n};\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9TdG9yZXMvaW5kZXguanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vU3RvcmVzL2luZGV4LmpzP2M5OTUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENsaWVudFN0b3JlIGZyb20gJy4vY2xpZW50LXN0b3JlJztcbmltcG9ydCBDb21tb25TdG9yZSBmcm9tICcuL2NvbW1vbi1zdG9yZSc7XG5pbXBvcnQgR1RNU3RvcmUgZnJvbSAnLi9ndG0tc3RvcmUnO1xuaW1wb3J0IFJ1ZGRlclN0YWNrU3RvcmUgZnJvbSAnLi9ydWRkZXJzdGFjay1zdG9yZSc7XG5pbXBvcnQgUHVzaFdvb3NoU3RvcmUgZnJvbSAnLi9wdXNod29vc2gtc3RvcmUnO1xuaW1wb3J0IE1vZHVsZXNTdG9yZSBmcm9tICcuL01vZHVsZXMnO1xuaW1wb3J0IE1lbnVTdG9yZSBmcm9tICcuL21lbnUtc3RvcmUnO1xuaW1wb3J0IFVJU3RvcmUgZnJvbSAnLi91aS1zdG9yZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJvb3RTdG9yZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuY2xpZW50ID0gbmV3IENsaWVudFN0b3JlKHRoaXMpO1xuICAgICAgICB0aGlzLmNvbW1vbiA9IG5ldyBDb21tb25TdG9yZSh0aGlzKTtcbiAgICAgICAgdGhpcy5tb2R1bGVzID0gbmV3IE1vZHVsZXNTdG9yZSh0aGlzKTtcbiAgICAgICAgdGhpcy51aSA9IG5ldyBVSVN0b3JlKHRoaXMpO1xuICAgICAgICB0aGlzLmd0bSA9IG5ldyBHVE1TdG9yZSh0aGlzKTtcbiAgICAgICAgdGhpcy5ydWRkZXJzdGFjayA9IG5ldyBSdWRkZXJTdGFja1N0b3JlKHRoaXMpO1xuICAgICAgICB0aGlzLm1lbnUgPSBuZXcgTWVudVN0b3JlKHRoaXMpO1xuICAgICAgICB0aGlzLnB1c2h3b29zaCA9IG5ldyBQdXNoV29vc2hTdG9yZSh0aGlzKTtcbiAgICB9XG59XG4iXSwibmFtZXMiOlsiQ2xpZW50U3RvcmUiLCJDb21tb25TdG9yZSIsIkdUTVN0b3JlIiwiUnVkZGVyU3RhY2tTdG9yZSIsIlB1c2hXb29zaFN0b3JlIiwiTW9kdWxlc1N0b3JlIiwiTWVudVN0b3JlIiwiVUlTdG9yZSIsIlJvb3RTdG9yZSIsImNsaWVudCIsImNvbW1vbiIsIm1vZHVsZXMiLCJ1aSIsImd0bSIsInJ1ZGRlcnN0YWNrIiwibWVudSIsInB1c2h3b29zaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Stores/index.js\n");

/***/ })

}]);